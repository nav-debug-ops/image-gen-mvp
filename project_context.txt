
--- FILE: index.html ---
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Amazon Listing Image Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>

--- END OF FILE ---

--- FILE: SETUP.md ---
# Setup Guide

Complete step-by-step guide to run the ImageGen MVP locally.

## Prerequisites

1. **Python 3.10+** - [Download](https://www.python.org/downloads/)
2. **Node.js 18+** - [Download](https://nodejs.org/)
3. **Replicate Account** - [Sign up](https://replicate.com/) (free tier available)

---

## Step 1: Get Your Replicate API Token

1. Go to [replicate.com](https://replicate.com)
2. Sign up or log in
3. Go to Account Settings → API Tokens
4. Copy your API token

---

## Step 2: Set Up Backend

Open a terminal and run:

```bash
# Navigate to backend folder
cd image-gen-mvp/backend

# Create virtual environment
python -m venv venv

# Activate it (Windows)
venv\Scripts\activate

# Activate it (Mac/Linux)
# source venv/bin/activate

# Install dependencies
pip install -r requirements.txt

# Create .env file
copy .env.example .env
# (Mac/Linux: cp .env.example .env)

# Edit .env and add your Replicate API token
# REPLICATE_API_TOKEN=your_token_here

# Run the backend
uvicorn app.main:app --reload
```

Backend will be running at: `http://localhost:8000`

Test it: Open `http://localhost:8000` in your browser - you should see:
```json
{"message": "ImageGen MVP API", "status": "running"}
```

---

## Step 3: Set Up Frontend

Open a **new terminal** and run:

```bash
# Navigate to frontend folder
cd image-gen-mvp/frontend

# Install dependencies
npm install

# Create .env.local
copy .env.example .env.local
# (Mac/Linux: cp .env.example .env.local)

# Run the frontend
npm run dev
```

Frontend will be running at: `http://localhost:3000`

---

## Step 4: Use the App

1. Open `http://localhost:3000` in your browser
2. Type a prompt like "A cute cat in a garden"
3. Select a style (optional)
4. Click "Generate"
5. Wait for your image!

---

## Troubleshooting

### "Failed to generate image"
- Check that your Replicate API token is correct in `backend/.env`
- Ensure you have credits in your Replicate account
- Check the backend terminal for error messages

### "Network Error" or CORS issues
- Make sure the backend is running on port 8000
- Check that `FRONTEND_URL=http://localhost:3000` in backend `.env`

### Images not loading
- Check that the `generated` folder exists in the backend directory
- Verify the backend is serving static files correctly

---

## Next Steps

After confirming the MVP works:

1. **Add authentication** - Protect your API
2. **Deploy** - Use Vercel (frontend) + Railway/Render (backend)
3. **Add more features** - See the roadmap in README.md

---

## Useful Commands

| Command | Location | Purpose |
|---------|----------|---------|
| `uvicorn app.main:app --reload` | backend/ | Run backend |
| `npm run dev` | frontend/ | Run frontend |
| `npm run build` | frontend/ | Build for production |
| `pip freeze > requirements.txt` | backend/ | Update dependencies |

--- END OF FILE ---

--- FILE: vite.config.js ---
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000,
    open: true,
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true
      },
      '/images': {
        target: 'http://localhost:8000',
        changeOrigin: true
      }
    }
  }
})

--- END OF FILE ---

--- FILE: README.md ---
# Amazon Listing Image Generator

A professional image generation tool for Amazon sellers. Generate product photos optimized for Amazon listings with automatic session tracking, calendar integration, and data export.

## Features

### Image Generation
- **Amazon-Optimized Prompts** - Automatically builds professional prompts for Amazon listing images
- **5 Image Types** - Main Image, Lifestyle, Infographic, Detail Shot, Comparison
- **8 Product Categories** - Electronics, Home & Kitchen, Beauty, Sports, Toys, Clothing, Food, Pets
- **Multiple AI Providers** - Replicate (Flux), OpenAI (DALL-E 3), Stability AI

### Session Tracking
- **Time Tracking** - Track how long you spend generating images
- **Project Organization** - Group sessions by product/project name
- **Session Statistics** - View total time, images generated, session history
- **Auto-Start** - Sessions automatically start when you generate

### Calendar Integration (Clockwise Compatible)
- **Google Calendar Sync** - Create focus time blocks when you start sessions
- **Automatic Updates** - Calendar events update with actual duration when you end
- **Clockwise Compatible** - Works with Clockwise for smart scheduling

### Data & Export
- **IndexedDB Storage** - All data persisted locally in the browser
- **CSV Export** - Export sessions and images to spreadsheet
- **PDF Reports** - Generate printable reports with statistics
- **History & Favorites** - Browse and manage all generated images

## Quick Start

1. **Install dependencies**
   ```bash
   npm install
   ```

2. **Configure API (optional)**
   ```bash
   cp .env.example .env
   # Edit .env with your API credentials
   ```

3. **Start development server**
   ```bash
   npm run dev
   ```

4. Open http://localhost:3000

## Demo Mode

By default, the app runs in demo mode using placeholder images. This is perfect for testing the UI without an API key.

## Configuration

### Image Generation API

Edit your `.env` file:

```env
# Replicate (Recommended - Flux model)
VITE_API_PROVIDER=replicate
VITE_API_KEY=your_replicate_token

# OpenAI (DALL-E 3)
VITE_API_PROVIDER=openai
VITE_API_KEY=your_openai_api_key

# Stability AI (SDXL)
VITE_API_PROVIDER=stability
VITE_API_KEY=your_stability_api_key
```

If you want to use Nano Banana tokens for server-side calls or to forward per-request tokens from the frontend, set the backend env var `NANO_BANANA_TOKEN` or send the header `x-nano-banana-token` with requests to the backend generate endpoint. The backend will use a per-request header token when present, otherwise it falls back to the configured `NANO_BANANA_TOKEN`.

### Google Calendar Integration

1. Go to [Google Cloud Console](https://console.cloud.google.com)
2. Create a project and enable Google Calendar API
3. Create OAuth 2.0 credentials (Web application)
4. Add `http://localhost:3000` to authorized JavaScript origins
5. Add to your `.env`:

```env
VITE_GOOGLE_CLIENT_ID=your_client_id.apps.googleusercontent.com
VITE_GOOGLE_API_KEY=your_api_key
```

## Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| Ctrl + Enter | Generate image |
| Ctrl + S | Save to gallery |

## Project Structure

```
image-gen-mvp/
├── src/
│   ├── App.jsx                 # Main app with state management
│   ├── App.css                 # Styles (dark theme)
│   ├── main.jsx                # Entry point
│   ├── components/
│   │   ├── PromptInput.jsx     # Image type, category, prompt
│   │   ├── ImageDisplay.jsx    # Image viewer + progress
│   │   ├── History.jsx         # Generation history
│   │   ├── Gallery.jsx         # Saved favorites
│   │   ├── SessionPanel.jsx    # Time tracking controls
│   │   └── SettingsPanel.jsx   # API config + exports
│   ├── api/
│   │   └── imageGen.js         # Multi-provider image API
│   ├── services/
│   │   ├── database.js         # IndexedDB storage
│   │   ├── sessionTracker.js   # Session/time tracking
│   │   └── calendar.js         # Google Calendar integration
│   └── utils/
│       └── export.js           # CSV/PDF export utilities
├── .env.example                # Environment template
├── package.json
└── vite.config.js
```

## Tech Stack

- React 18
- Vite
- IndexedDB (persistent storage)
- Lucide React (icons)
- Google Calendar API

## API Pricing (Approximate)

| Provider | Cost per Image |
|----------|---------------|
| Replicate (Flux) | ~$0.003 |
| Stability AI | ~$0.002 |
| OpenAI DALL-E 3 | $0.04 (standard) |

## License

MIT

--- END OF FILE ---

--- FILE: .gitignore ---
# Dependencies
node_modules/

# Build output
dist/

# Environment variables
.env
.env.local
.env.*.local

# Editor directories
.idea/
.vscode/
*.swp
*.swo

# OS files
.DS_Store
Thumbs.db

# Logs
*.log
npm-debug.log*

# Cache
.cache/

# Python
__pycache__/
*.pyc
*.db
backend/generated/

--- END OF FILE ---

--- FILE: package-lock.json ---
{
  "name": "image-gen-mvp",
  "version": "1.0.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "image-gen-mvp",
      "version": "1.0.0",
      "dependencies": {
        "lucide-react": "^0.294.0",
        "react": "^18.2.0",
        "react-dom": "^18.2.0",
        "react-router-dom": "^7.13.0",
        "recharts": "^3.7.0"
      },
      "devDependencies": {
        "@vitejs/plugin-react": "^4.2.0",
        "vite": "^5.0.0"
      }
    },
    "node_modules/@babel/code-frame": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.29.0.tgz",
      "integrity": "sha512-9NhCeYjq9+3uxgdtp20LSiJXJvN0FeCtNGpJxuMFZ1Kv3cWUNb6DOhJwUvcVCzKGR66cw4njwM6hrJLqgOwbcw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-validator-identifier": "^7.28.5",
        "js-tokens": "^4.0.0",
        "picocolors": "^1.1.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/compat-data": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.29.0.tgz",
      "integrity": "sha512-T1NCJqT/j9+cn8fvkt7jtwbLBfLC/1y1c7NtCeXFRgzGTsafi68MRv8yzkYSapBnFA6L3U2VSc02ciDzoAJhJg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/core": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.29.0.tgz",
      "integrity": "sha512-CGOfOJqWjg2qW/Mb6zNsDm+u5vFQ8DxXfbM09z69p5Z6+mE1ikP2jUXw+j42Pf1XTYED2Rni5f95npYeuwMDQA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.29.0",
        "@babel/generator": "^7.29.0",
        "@babel/helper-compilation-targets": "^7.28.6",
        "@babel/helper-module-transforms": "^7.28.6",
        "@babel/helpers": "^7.28.6",
        "@babel/parser": "^7.29.0",
        "@babel/template": "^7.28.6",
        "@babel/traverse": "^7.29.0",
        "@babel/types": "^7.29.0",
        "@jridgewell/remapping": "^2.3.5",
        "convert-source-map": "^2.0.0",
        "debug": "^4.1.0",
        "gensync": "^1.0.0-beta.2",
        "json5": "^2.2.3",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/babel"
      }
    },
    "node_modules/@babel/generator": {
      "version": "7.29.1",
      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.29.1.tgz",
      "integrity": "sha512-qsaF+9Qcm2Qv8SRIMMscAvG4O3lJ0F1GuMo5HR/Bp02LopNgnZBC/EkbevHFeGs4ls/oPz9v+Bsmzbkbe+0dUw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.29.0",
        "@babel/types": "^7.29.0",
        "@jridgewell/gen-mapping": "^0.3.12",
        "@jridgewell/trace-mapping": "^0.3.28",
        "jsesc": "^3.0.2"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.28.6.tgz",
      "integrity": "sha512-JYtls3hqi15fcx5GaSNL7SCTJ2MNmjrkHXg4FSpOA/grxK8KwyZ5bubHsCq8FXCkua6xhuaaBit+3b7+VZRfcA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/compat-data": "^7.28.6",
        "@babel/helper-validator-option": "^7.27.1",
        "browserslist": "^4.24.0",
        "lru-cache": "^5.1.1",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-globals": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-imports": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.28.6.tgz",
      "integrity": "sha512-l5XkZK7r7wa9LucGw9LwZyyCUscb4x37JWTPz7swwFE/0FMQAGpiWUZn8u9DzkSBWEcK25jmvubfpw2dnAMdbw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/traverse": "^7.28.6",
        "@babel/types": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-transforms": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.6.tgz",
      "integrity": "sha512-67oXFAYr2cDLDVGLXTEABjdBJZ6drElUSI7WKp70NrpyISso3plG9SAGEF6y7zbha/wOzUByWWTJvEDVNIUGcA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-module-imports": "^7.28.6",
        "@babel/helper-validator-identifier": "^7.28.5",
        "@babel/traverse": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/@babel/helper-plugin-utils": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.28.6.tgz",
      "integrity": "sha512-S9gzZ/bz83GRysI7gAD4wPT/AI3uCnY+9xn+Mx/KPs2JwHJIz1W8PZkg2cqyt3RNOBM8ejcXhV6y8Og7ly/Dug==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-string-parser": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-identifier": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-option": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helpers": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.6.tgz",
      "integrity": "sha512-xOBvwq86HHdB7WUDTfKfT/Vuxh7gElQ+Sfti2Cy6yIWNW05P8iUslOVcZ4/sKbE+/jQaukQAdz/gf3724kYdqw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/template": "^7.28.6",
        "@babel/types": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/parser": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.29.0.tgz",
      "integrity": "sha512-IyDgFV5GeDUVX4YdF/3CPULtVGSXXMLh1xVIgdCgxApktqnQV0r7/8Nqthg+8YLGaAtdyIlo2qIdZrbCv4+7ww==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.29.0"
      },
      "bin": {
        "parser": "bin/babel-parser.js"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-self": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-self/-/plugin-transform-react-jsx-self-7.27.1.tgz",
      "integrity": "sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-source": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-source/-/plugin-transform-react-jsx-source-7.27.1.tgz",
      "integrity": "sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/template": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.28.6.tgz",
      "integrity": "sha512-YA6Ma2KsCdGb+WC6UpBVFJGXL58MDA6oyONbjyF/+5sBgxY/dwkhLogbMT2GXXyU84/IhRw/2D1Os1B/giz+BQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.28.6",
        "@babel/parser": "^7.28.6",
        "@babel/types": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/traverse": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.29.0.tgz",
      "integrity": "sha512-4HPiQr0X7+waHfyXPZpWPfWL/J7dcN1mx9gL6WdQVMbPnF3+ZhSMs8tCxN7oHddJE9fhNE7+lxdnlyemKfJRuA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.29.0",
        "@babel/generator": "^7.29.0",
        "@babel/helper-globals": "^7.28.0",
        "@babel/parser": "^7.29.0",
        "@babel/template": "^7.28.6",
        "@babel/types": "^7.29.0",
        "debug": "^4.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/types": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.29.0.tgz",
      "integrity": "sha512-LwdZHpScM4Qz8Xw2iKSzS+cfglZzJGvofQICy7W7v4caru4EaAmyUuO6BGrbyQ2mYV11W0U8j5mBhd14dd3B0A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-string-parser": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.28.5"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@esbuild/aix-ppc64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz",
      "integrity": "sha512-1SDgH6ZSPTlggy1yI6+Dbkiz8xzpHJEVAlF/AM1tHPLsf5STom9rwtjE4hKAF20FfXXNTFqEYXyJNWh1GiZedQ==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "aix"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-arm": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.21.5.tgz",
      "integrity": "sha512-vCPvzSjpPHEi1siZdlvAlsPxXl7WbOVUBBAowWug4rJHb68Ox8KualB+1ocNvT5fjv6wpkX6o/iEpbDrf68zcg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.21.5.tgz",
      "integrity": "sha512-c0uX9VAUBQ7dTDCjq+wdyGLowMdtR/GoC2U5IYk/7D1H1JYC0qseD7+11iMP2mRLN9RcCMRcjC4YMclCzGwS/A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.21.5.tgz",
      "integrity": "sha512-D7aPRUUNHRBwHxzxRvp856rjUHRFW1SdQATKXH2hqA0kAZb1hKmi02OpYRacl0TxIGz/ZmXWlbZgjwWYaCakTA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.21.5.tgz",
      "integrity": "sha512-DwqXqZyuk5AiWWf3UfLiRDJ5EDd49zg6O9wclZ7kUMv2WRFr4HKjXp/5t8JZ11QbQfUS6/cRCKGwYhtNAY88kQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.21.5.tgz",
      "integrity": "sha512-se/JjF8NlmKVG4kNIuyWMV/22ZaerB+qaSi5MdrXtd6R08kvs2qCN4C09miupktDitvh8jRFflwGFBQcxZRjbw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.21.5.tgz",
      "integrity": "sha512-5JcRxxRDUJLX8JXp/wcBCy3pENnCgBR9bN6JsY4OmhfUtIHe3ZW0mawA7+RDAcMLrMIZaf03NlQiX9DGyB8h4g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.21.5.tgz",
      "integrity": "sha512-J95kNBj1zkbMXtHVH29bBriQygMXqoVQOQYA+ISs0/2l3T9/kj42ow2mpqerRBxDJnmkUDCaQT/dfNXWX/ZZCQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.21.5.tgz",
      "integrity": "sha512-bPb5AHZtbeNGjCKVZ9UGqGwo8EUu4cLq68E95A53KlxAPRmUyYv2D6F0uUI65XisGOL1hBP5mTronbgo+0bFcA==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.21.5.tgz",
      "integrity": "sha512-ibKvmyYzKsBeX8d8I7MH/TMfWDXBF3db4qM6sy+7re0YXya+K1cem3on9XgdT2EQGMu4hQyZhan7TeQ8XkGp4Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ia32": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.21.5.tgz",
      "integrity": "sha512-YvjXDqLRqPDl2dvRODYmmhz4rPeVKYvppfGYKSNGdyZkA01046pLWyRKKI3ax8fbJoK5QbxblURkwK/MWY18Tg==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-loong64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.21.5.tgz",
      "integrity": "sha512-uHf1BmMG8qEvzdrzAqg2SIG/02+4/DHB6a9Kbya0XDvwDEKCoC8ZRWI5JJvNdUjtciBGFQ5PuBlpEOXQj+JQSg==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-mips64el": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.21.5.tgz",
      "integrity": "sha512-IajOmO+KJK23bj52dFSNCMsz1QP1DqM6cwLUv3W1QwyxkyIWecfafnI555fvSGqEKwjMXVLokcV5ygHW5b3Jbg==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ppc64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.21.5.tgz",
      "integrity": "sha512-1hHV/Z4OEfMwpLO8rp7CvlhBDnjsC3CttJXIhBi+5Aj5r+MBvy4egg7wCbe//hSsT+RvDAG7s81tAvpL2XAE4w==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-riscv64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.21.5.tgz",
      "integrity": "sha512-2HdXDMd9GMgTGrPWnJzP2ALSokE/0O5HhTUvWIbD3YdjME8JwvSCnNGBnTThKGEB91OZhzrJ4qIIxk/SBmyDDA==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-s390x": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.21.5.tgz",
      "integrity": "sha512-zus5sxzqBJD3eXxwvjN1yQkRepANgxE9lgOW2qLnmr8ikMTphkjgXu1HR01K4FJg8h1kEEDAqDcZQtbrRnB41A==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.21.5.tgz",
      "integrity": "sha512-1rYdTpyv03iycF1+BhzrzQJCdOuAOtaqHTWJZCWvijKD2N5Xu0TtVC8/+1faWqcP9iBCWOmjmhoH94dH82BxPQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/netbsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.21.5.tgz",
      "integrity": "sha512-Woi2MXzXjMULccIwMnLciyZH4nCIMpWQAs049KEeMvOcNADVxo0UBIQPfSmxB3CWKedngg7sWZdLvLczpe0tLg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/openbsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.21.5.tgz",
      "integrity": "sha512-HLNNw99xsvx12lFBUwoT8EVCsSvRNDVxNpjZ7bPn947b8gJPzeHWyNVhFsaerc0n3TsbOINvRP2byTZ5LKezow==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/sunos-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.21.5.tgz",
      "integrity": "sha512-6+gjmFpfy0BHU5Tpptkuh8+uw3mnrvgs+dSPQXQOv3ekbordwnzTVEb4qnIvQcYXq6gzkyTnoZ9dZG+D4garKg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.21.5.tgz",
      "integrity": "sha512-Z0gOTd75VvXqyq7nsl93zwahcTROgqvuAcYDUr+vOv8uHhNSKROyU961kgtCD1e95IqPKSQKH7tBTslnS3tA8A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-ia32": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.21.5.tgz",
      "integrity": "sha512-SWXFF1CL2RVNMaVs+BBClwtfZSvDgtL//G/smwAc5oVK/UPu2Gu9tIaRgFmYFFKrmg3SyAjSrElf0TiJ1v8fYA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.21.5.tgz",
      "integrity": "sha512-tQd/1efJuzPC6rCFwEvLtci/xNFcTZknmXs98FYDfGE4wP9ClFV98nyKrzJKVPMhdDnjzLhdUyMX4PsQAPjwIw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.13",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/remapping": {
      "version": "2.3.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.31",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@reduxjs/toolkit": {
      "version": "2.11.2",
      "resolved": "https://registry.npmjs.org/@reduxjs/toolkit/-/toolkit-2.11.2.tgz",
      "integrity": "sha512-Kd6kAHTA6/nUpp8mySPqj3en3dm0tdMIgbttnQ1xFMVpufoj+ADi8pXLBsd4xzTRHQa7t/Jv8W5UnCuW4kuWMQ==",
      "license": "MIT",
      "dependencies": {
        "@standard-schema/spec": "^1.0.0",
        "@standard-schema/utils": "^0.3.0",
        "immer": "^11.0.0",
        "redux": "^5.0.1",
        "redux-thunk": "^3.1.0",
        "reselect": "^5.1.0"
      },
      "peerDependencies": {
        "react": "^16.9.0 || ^17.0.0 || ^18 || ^19",
        "react-redux": "^7.2.1 || ^8.1.3 || ^9.0.0"
      },
      "peerDependenciesMeta": {
        "react": {
          "optional": true
        },
        "react-redux": {
          "optional": true
        }
      }
    },
    "node_modules/@reduxjs/toolkit/node_modules/immer": {
      "version": "11.1.4",
      "resolved": "https://registry.npmjs.org/immer/-/immer-11.1.4.tgz",
      "integrity": "sha512-XREFCPo6ksxVzP4E0ekD5aMdf8WMwmdNaz6vuvxgI40UaEiu6q3p8X52aU6GdyvLY3XXX/8R7JOTXStz/nBbRw==",
      "license": "MIT",
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/immer"
      }
    },
    "node_modules/@rolldown/pluginutils": {
      "version": "1.0.0-beta.27",
      "resolved": "https://registry.npmjs.org/@rolldown/pluginutils/-/pluginutils-1.0.0-beta.27.tgz",
      "integrity": "sha512-+d0F4MKMCbeVUJwG96uQ4SgAznZNSq93I3V+9NHA4OpvqG8mRCpGdKmK8l/dl02h2CCDHwW2FqilnTyDcAnqjA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@rollup/rollup-android-arm-eabi": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.57.1.tgz",
      "integrity": "sha512-A6ehUVSiSaaliTxai040ZpZ2zTevHYbvu/lDoeAteHI8QnaosIzm4qwtezfRg1jOYaUmnzLX1AOD6Z+UJjtifg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@rollup/rollup-android-arm64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm64/-/rollup-android-arm64-4.57.1.tgz",
      "integrity": "sha512-dQaAddCY9YgkFHZcFNS/606Exo8vcLHwArFZ7vxXq4rigo2bb494/xKMMwRRQW6ug7Js6yXmBZhSBRuBvCCQ3w==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@rollup/rollup-darwin-arm64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-arm64/-/rollup-darwin-arm64-4.57.1.tgz",
      "integrity": "sha512-crNPrwJOrRxagUYeMn/DZwqN88SDmwaJ8Cvi/TN1HnWBU7GwknckyosC2gd0IqYRsHDEnXf328o9/HC6OkPgOg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@rollup/rollup-darwin-x64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-x64/-/rollup-darwin-x64-4.57.1.tgz",
      "integrity": "sha512-Ji8g8ChVbKrhFtig5QBV7iMaJrGtpHelkB3lsaKzadFBe58gmjfGXAOfI5FV0lYMH8wiqsxKQ1C9B0YTRXVy4w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@rollup/rollup-freebsd-arm64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-arm64/-/rollup-freebsd-arm64-4.57.1.tgz",
      "integrity": "sha512-R+/WwhsjmwodAcz65guCGFRkMb4gKWTcIeLy60JJQbXrJ97BOXHxnkPFrP+YwFlaS0m+uWJTstrUA9o+UchFug==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@rollup/rollup-freebsd-x64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-x64/-/rollup-freebsd-x64-4.57.1.tgz",
      "integrity": "sha512-IEQTCHeiTOnAUC3IDQdzRAGj3jOAYNr9kBguI7MQAAZK3caezRrg0GxAb6Hchg4lxdZEI5Oq3iov/w/hnFWY9Q==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm-gnueabihf": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-gnueabihf/-/rollup-linux-arm-gnueabihf-4.57.1.tgz",
      "integrity": "sha512-F8sWbhZ7tyuEfsmOxwc2giKDQzN3+kuBLPwwZGyVkLlKGdV1nvnNwYD0fKQ8+XS6hp9nY7B+ZeK01EBUE7aHaw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm-musleabihf": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-musleabihf/-/rollup-linux-arm-musleabihf-4.57.1.tgz",
      "integrity": "sha512-rGfNUfn0GIeXtBP1wL5MnzSj98+PZe/AXaGBCRmT0ts80lU5CATYGxXukeTX39XBKsxzFpEeK+Mrp9faXOlmrw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-gnu/-/rollup-linux-arm64-gnu-4.57.1.tgz",
      "integrity": "sha512-MMtej3YHWeg/0klK2Qodf3yrNzz6CGjo2UntLvk2RSPlhzgLvYEB3frRvbEF2wRKh1Z2fDIg9KRPe1fawv7C+g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm64-musl": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-musl/-/rollup-linux-arm64-musl-4.57.1.tgz",
      "integrity": "sha512-1a/qhaaOXhqXGpMFMET9VqwZakkljWHLmZOX48R0I/YLbhdxr1m4gtG1Hq7++VhVUmf+L3sTAf9op4JlhQ5u1Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-loong64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-gnu/-/rollup-linux-loong64-gnu-4.57.1.tgz",
      "integrity": "sha512-QWO6RQTZ/cqYtJMtxhkRkidoNGXc7ERPbZN7dVW5SdURuLeVU7lwKMpo18XdcmpWYd0qsP1bwKPf7DNSUinhvA==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-loong64-musl": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-musl/-/rollup-linux-loong64-musl-4.57.1.tgz",
      "integrity": "sha512-xpObYIf+8gprgWaPP32xiN5RVTi/s5FCR+XMXSKmhfoJjrpRAjCuuqQXyxUa/eJTdAE6eJ+KDKaoEqjZQxh3Gw==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-ppc64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-gnu/-/rollup-linux-ppc64-gnu-4.57.1.tgz",
      "integrity": "sha512-4BrCgrpZo4hvzMDKRqEaW1zeecScDCR+2nZ86ATLhAoJ5FQ+lbHVD3ttKe74/c7tNT9c6F2viwB3ufwp01Oh2w==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-ppc64-musl": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-musl/-/rollup-linux-ppc64-musl-4.57.1.tgz",
      "integrity": "sha512-NOlUuzesGauESAyEYFSe3QTUguL+lvrN1HtwEEsU2rOwdUDeTMJdO5dUYl/2hKf9jWydJrO9OL/XSSf65R5+Xw==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-riscv64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-gnu/-/rollup-linux-riscv64-gnu-4.57.1.tgz",
      "integrity": "sha512-ptA88htVp0AwUUqhVghwDIKlvJMD/fmL/wrQj99PRHFRAG6Z5nbWoWG4o81Nt9FT+IuqUQi+L31ZKAFeJ5Is+A==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-riscv64-musl": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-musl/-/rollup-linux-riscv64-musl-4.57.1.tgz",
      "integrity": "sha512-S51t7aMMTNdmAMPpBg7OOsTdn4tySRQvklmL3RpDRyknk87+Sp3xaumlatU+ppQ+5raY7sSTcC2beGgvhENfuw==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-s390x-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-s390x-gnu/-/rollup-linux-s390x-gnu-4.57.1.tgz",
      "integrity": "sha512-Bl00OFnVFkL82FHbEqy3k5CUCKH6OEJL54KCyx2oqsmZnFTR8IoNqBF+mjQVcRCT5sB6yOvK8A37LNm/kPJiZg==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-x64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.57.1.tgz",
      "integrity": "sha512-ABca4ceT4N+Tv/GtotnWAeXZUZuM/9AQyCyKYyKnpk4yoA7QIAuBt6Hkgpw8kActYlew2mvckXkvx0FfoInnLg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-x64-musl": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-musl/-/rollup-linux-x64-musl-4.57.1.tgz",
      "integrity": "sha512-HFps0JeGtuOR2convgRRkHCekD7j+gdAuXM+/i6kGzQtFhlCtQkpwtNzkNj6QhCDp7DRJ7+qC/1Vg2jt5iSOFw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-openbsd-x64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-openbsd-x64/-/rollup-openbsd-x64-4.57.1.tgz",
      "integrity": "sha512-H+hXEv9gdVQuDTgnqD+SQffoWoc0Of59AStSzTEj/feWTBAnSfSD3+Dql1ZruJQxmykT/JVY0dE8Ka7z0DH1hw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ]
    },
    "node_modules/@rollup/rollup-openharmony-arm64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-openharmony-arm64/-/rollup-openharmony-arm64-4.57.1.tgz",
      "integrity": "sha512-4wYoDpNg6o/oPximyc/NG+mYUejZrCU2q+2w6YZqrAs2UcNUChIZXjtafAiiZSUc7On8v5NyNj34Kzj/Ltk6dQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openharmony"
      ]
    },
    "node_modules/@rollup/rollup-win32-arm64-msvc": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-arm64-msvc/-/rollup-win32-arm64-msvc-4.57.1.tgz",
      "integrity": "sha512-O54mtsV/6LW3P8qdTcamQmuC990HDfR71lo44oZMZlXU4tzLrbvTii87Ni9opq60ds0YzuAlEr/GNwuNluZyMQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-ia32-msvc": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-ia32-msvc/-/rollup-win32-ia32-msvc-4.57.1.tgz",
      "integrity": "sha512-P3dLS+IerxCT/7D2q2FYcRdWRl22dNbrbBEtxdWhXrfIMPP9lQhb5h4Du04mdl5Woq05jVCDPCMF7Ub0NAjIew==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-x64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-gnu/-/rollup-win32-x64-gnu-4.57.1.tgz",
      "integrity": "sha512-VMBH2eOOaKGtIJYleXsi2B8CPVADrh+TyNxJ4mWPnKfLB/DBUmzW+5m1xUrcwWoMfSLagIRpjUFeW5CO5hyciQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-x64-msvc": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-msvc/-/rollup-win32-x64-msvc-4.57.1.tgz",
      "integrity": "sha512-mxRFDdHIWRxg3UfIIAwCm6NzvxG0jDX/wBN6KsQFTvKFqqg9vTrWUE68qEjHt19A5wwx5X5aUi2zuZT7YR0jrA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@standard-schema/spec": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@standard-schema/spec/-/spec-1.1.0.tgz",
      "integrity": "sha512-l2aFy5jALhniG5HgqrD6jXLi/rUWrKvqN/qJx6yoJsgKhblVd+iqqU4RCXavm/jPityDo5TCvKMnpjKnOriy0w==",
      "license": "MIT"
    },
    "node_modules/@standard-schema/utils": {
      "version": "0.3.0",
      "resolved": "https://registry.npmjs.org/@standard-schema/utils/-/utils-0.3.0.tgz",
      "integrity": "sha512-e7Mew686owMaPJVNNLs55PUvgz371nKgwsc4vxE49zsODpJEnxgxRo2y/OKrqueavXgZNMDVj3DdHFlaSAeU8g==",
      "license": "MIT"
    },
    "node_modules/@types/babel__core": {
      "version": "7.20.5",
      "resolved": "https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz",
      "integrity": "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.20.7",
        "@babel/types": "^7.20.7",
        "@types/babel__generator": "*",
        "@types/babel__template": "*",
        "@types/babel__traverse": "*"
      }
    },
    "node_modules/@types/babel__generator": {
      "version": "7.27.0",
      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.27.0.tgz",
      "integrity": "sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__template": {
      "version": "7.4.4",
      "resolved": "https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz",
      "integrity": "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.1.0",
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__traverse": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.28.0.tgz",
      "integrity": "sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.28.2"
      }
    },
    "node_modules/@types/d3-array": {
      "version": "3.2.2",
      "resolved": "https://registry.npmjs.org/@types/d3-array/-/d3-array-3.2.2.tgz",
      "integrity": "sha512-hOLWVbm7uRza0BYXpIIW5pxfrKe0W+D5lrFiAEYR+pb6w3N2SwSMaJbXdUfSEv+dT4MfHBLtn5js0LAWaO6otw==",
      "license": "MIT"
    },
    "node_modules/@types/d3-color": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/@types/d3-color/-/d3-color-3.1.3.tgz",
      "integrity": "sha512-iO90scth9WAbmgv7ogoq57O9YpKmFBbmoEoCHDB2xMBY0+/KVrqAaCDyCE16dUspeOvIxFFRI+0sEtqDqy2b4A==",
      "license": "MIT"
    },
    "node_modules/@types/d3-ease": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@types/d3-ease/-/d3-ease-3.0.2.tgz",
      "integrity": "sha512-NcV1JjO5oDzoK26oMzbILE6HW7uVXOHLQvHshBUW4UMdZGfiY6v5BeQwh9a9tCzv+CeefZQHJt5SRgK154RtiA==",
      "license": "MIT"
    },
    "node_modules/@types/d3-interpolate": {
      "version": "3.0.4",
      "resolved": "https://registry.npmjs.org/@types/d3-interpolate/-/d3-interpolate-3.0.4.tgz",
      "integrity": "sha512-mgLPETlrpVV1YRJIglr4Ez47g7Yxjl1lj7YKsiMCb27VJH9W8NVM6Bb9d8kkpG/uAQS5AmbA48q2IAolKKo1MA==",
      "license": "MIT",
      "dependencies": {
        "@types/d3-color": "*"
      }
    },
    "node_modules/@types/d3-path": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/@types/d3-path/-/d3-path-3.1.1.tgz",
      "integrity": "sha512-VMZBYyQvbGmWyWVea0EHs/BwLgxc+MKi1zLDCONksozI4YJMcTt8ZEuIR4Sb1MMTE8MMW49v0IwI5+b7RmfWlg==",
      "license": "MIT"
    },
    "node_modules/@types/d3-scale": {
      "version": "4.0.9",
      "resolved": "https://registry.npmjs.org/@types/d3-scale/-/d3-scale-4.0.9.tgz",
      "integrity": "sha512-dLmtwB8zkAeO/juAMfnV+sItKjlsw2lKdZVVy6LRr0cBmegxSABiLEpGVmSJJ8O08i4+sGR6qQtb6WtuwJdvVw==",
      "license": "MIT",
      "dependencies": {
        "@types/d3-time": "*"
      }
    },
    "node_modules/@types/d3-shape": {
      "version": "3.1.8",
      "resolved": "https://registry.npmjs.org/@types/d3-shape/-/d3-shape-3.1.8.tgz",
      "integrity": "sha512-lae0iWfcDeR7qt7rA88BNiqdvPS5pFVPpo5OfjElwNaT2yyekbM0C9vK+yqBqEmHr6lDkRnYNoTBYlAgJa7a4w==",
      "license": "MIT",
      "dependencies": {
        "@types/d3-path": "*"
      }
    },
    "node_modules/@types/d3-time": {
      "version": "3.0.4",
      "resolved": "https://registry.npmjs.org/@types/d3-time/-/d3-time-3.0.4.tgz",
      "integrity": "sha512-yuzZug1nkAAaBlBBikKZTgzCeA+k1uy4ZFwWANOfKw5z5LRhV0gNA7gNkKm7HoK+HRN0wX3EkxGk0fpbWhmB7g==",
      "license": "MIT"
    },
    "node_modules/@types/d3-timer": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@types/d3-timer/-/d3-timer-3.0.2.tgz",
      "integrity": "sha512-Ps3T8E8dZDam6fUyNiMkekK3XUsaUEik+idO9/YjPtfj2qruF8tFBXS7XhtE4iIXBLxhmLjP3SXpLhVf21I9Lw==",
      "license": "MIT"
    },
    "node_modules/@types/estree": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
      "integrity": "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/use-sync-external-store": {
      "version": "0.0.6",
      "resolved": "https://registry.npmjs.org/@types/use-sync-external-store/-/use-sync-external-store-0.0.6.tgz",
      "integrity": "sha512-zFDAD+tlpf2r4asuHEj0XH6pY6i0g5NeAHPn+15wk3BV6JA69eERFXC1gyGThDkVa1zCyKr5jox1+2LbV/AMLg==",
      "license": "MIT"
    },
    "node_modules/@vitejs/plugin-react": {
      "version": "4.7.0",
      "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.7.0.tgz",
      "integrity": "sha512-gUu9hwfWvvEDBBmgtAowQCojwZmJ5mcLn3aufeCsitijs3+f2NsrPtlAWIR6OPiqljl96GVCUbLe0HyqIpVaoA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/core": "^7.28.0",
        "@babel/plugin-transform-react-jsx-self": "^7.27.1",
        "@babel/plugin-transform-react-jsx-source": "^7.27.1",
        "@rolldown/pluginutils": "1.0.0-beta.27",
        "@types/babel__core": "^7.20.5",
        "react-refresh": "^0.17.0"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "peerDependencies": {
        "vite": "^4.2.0 || ^5.0.0 || ^6.0.0 || ^7.0.0"
      }
    },
    "node_modules/baseline-browser-mapping": {
      "version": "2.10.0",
      "resolved": "https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.10.0.tgz",
      "integrity": "sha512-lIyg0szRfYbiy67j9KN8IyeD7q7hcmqnJ1ddWmNt19ItGpNN64mnllmxUNFIOdOm6by97jlL6wfpTTJrmnjWAA==",
      "dev": true,
      "license": "Apache-2.0",
      "bin": {
        "baseline-browser-mapping": "dist/cli.cjs"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/browserslist": {
      "version": "4.28.1",
      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.28.1.tgz",
      "integrity": "sha512-ZC5Bd0LgJXgwGqUknZY/vkUQ04r8NXnJZ3yYi4vDmSiZmC/pdSN0NbNRPxZpbtO4uAfDUAFffO8IZoM3Gj8IkA==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "baseline-browser-mapping": "^2.9.0",
        "caniuse-lite": "^1.0.30001759",
        "electron-to-chromium": "^1.5.263",
        "node-releases": "^2.0.27",
        "update-browserslist-db": "^1.2.0"
      },
      "bin": {
        "browserslist": "cli.js"
      },
      "engines": {
        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
      }
    },
    "node_modules/caniuse-lite": {
      "version": "1.0.30001770",
      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001770.tgz",
      "integrity": "sha512-x/2CLQ1jHENRbHg5PSId2sXq1CIO1CISvwWAj027ltMVG2UNgW+w9oH2+HzgEIRFembL8bUlXtfbBHR1fCg2xw==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "CC-BY-4.0"
    },
    "node_modules/clsx": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/clsx/-/clsx-2.1.1.tgz",
      "integrity": "sha512-eYm0QWBtUrBWZWG0d386OGAw16Z995PiOVo2B7bjWSbHedGl5e0ZWaq65kOGgUSNesEIDkB9ISbTg/JK9dhCZA==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/convert-source-map": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/cookie": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/cookie/-/cookie-1.1.1.tgz",
      "integrity": "sha512-ei8Aos7ja0weRpFzJnEA9UHJ/7XQmqglbRwnf2ATjcB9Wq874VKH9kfjjirM6UhU2/E5fFYadylyhFldcqSidQ==",
      "license": "MIT",
      "engines": {
        "node": ">=18"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/express"
      }
    },
    "node_modules/d3-array": {
      "version": "3.2.4",
      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-3.2.4.tgz",
      "integrity": "sha512-tdQAmyA18i4J7wprpYq8ClcxZy3SC31QMeByyCFyRt7BVHdREQZ5lpzoe5mFEYZUWe+oq8HBvk9JjpibyEV4Jg==",
      "license": "ISC",
      "dependencies": {
        "internmap": "1 - 2"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-color": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-color/-/d3-color-3.1.0.tgz",
      "integrity": "sha512-zg/chbXyeBtMQ1LbD/WSoW2DpC3I0mpmPdW+ynRTj/x2DAWYrIY7qeZIHidozwV24m4iavr15lNwIwLxRmOxhA==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-ease": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-ease/-/d3-ease-3.0.1.tgz",
      "integrity": "sha512-wR/XK3D3XcLIZwpbvQwQ5fK+8Ykds1ip7A2Txe0yxncXSdq1L9skcG7blcedkOX+ZcgxGAmLX1FrRGbADwzi0w==",
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-format": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/d3-format/-/d3-format-3.1.2.tgz",
      "integrity": "sha512-AJDdYOdnyRDV5b6ArilzCPPwc1ejkHcoyFarqlPqT7zRYjhavcT3uSrqcMvsgh2CgoPbK3RCwyHaVyxYcP2Arg==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-interpolate": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-interpolate/-/d3-interpolate-3.0.1.tgz",
      "integrity": "sha512-3bYs1rOD33uo8aqJfKP3JWPAibgw8Zm2+L9vBKEHJ2Rg+viTR7o5Mmv5mZcieN+FRYaAOWX5SJATX6k1PWz72g==",
      "license": "ISC",
      "dependencies": {
        "d3-color": "1 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-path": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-3.1.0.tgz",
      "integrity": "sha512-p3KP5HCf/bvjBSSKuXid6Zqijx7wIfNW+J/maPs+iwR35at5JCbLUT0LzF1cnjbCHWhqzQTIN2Jpe8pRebIEFQ==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-scale": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/d3-scale/-/d3-scale-4.0.2.tgz",
      "integrity": "sha512-GZW464g1SH7ag3Y7hXjf8RoUuAFIqklOAq3MRl4OaWabTFJY9PN/E1YklhXLh+OQ3fM9yS2nOkCoS+WLZ6kvxQ==",
      "license": "ISC",
      "dependencies": {
        "d3-array": "2.10.0 - 3",
        "d3-format": "1 - 3",
        "d3-interpolate": "1.2.0 - 3",
        "d3-time": "2.1.1 - 3",
        "d3-time-format": "2 - 4"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-shape": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-3.2.0.tgz",
      "integrity": "sha512-SaLBuwGm3MOViRq2ABk3eLoxwZELpH6zhl3FbAoJ7Vm1gofKx6El1Ib5z23NUEhF9AsGl7y+dzLe5Cw2AArGTA==",
      "license": "ISC",
      "dependencies": {
        "d3-path": "^3.1.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-time": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-time/-/d3-time-3.1.0.tgz",
      "integrity": "sha512-VqKjzBLejbSMT4IgbmVgDjpkYrNWUYJnbCGo874u7MMKIWsILRX+OpX/gTk8MqjpT1A/c6HY2dCA77ZN0lkQ2Q==",
      "license": "ISC",
      "dependencies": {
        "d3-array": "2 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-time-format": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/d3-time-format/-/d3-time-format-4.1.0.tgz",
      "integrity": "sha512-dJxPBlzC7NugB2PDLwo9Q8JiTR3M3e4/XANkreKSUxF8vvXKqm1Yfq4Q5dl8budlunRVlUUaDUgFt7eA8D6NLg==",
      "license": "ISC",
      "dependencies": {
        "d3-time": "1 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-timer": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-timer/-/d3-timer-3.0.1.tgz",
      "integrity": "sha512-ndfJ/JxxMd3nw31uyKoY2naivF+r29V+Lc0svZxe1JvvIRmi8hUsrMvdOwgS1o6uBHmiz91geQ0ylPP0aj1VUA==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/decimal.js-light": {
      "version": "2.5.1",
      "resolved": "https://registry.npmjs.org/decimal.js-light/-/decimal.js-light-2.5.1.tgz",
      "integrity": "sha512-qIMFpTMZmny+MMIitAB6D7iVPEorVw6YQRWkvarTkT4tBeSLLiHzcwj6q0MmYSFCiVpiqPJTJEYIrpcPzVEIvg==",
      "license": "MIT"
    },
    "node_modules/electron-to-chromium": {
      "version": "1.5.286",
      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.286.tgz",
      "integrity": "sha512-9tfDXhJ4RKFNerfjdCcZfufu49vg620741MNs26a9+bhLThdB+plgMeou98CAaHu/WATj2iHOOHTp1hWtABj2A==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/es-toolkit": {
      "version": "1.44.0",
      "resolved": "https://registry.npmjs.org/es-toolkit/-/es-toolkit-1.44.0.tgz",
      "integrity": "sha512-6penXeZalaV88MM3cGkFZZfOoLGWshWWfdy0tWw/RlVVyhvMaWSBTOvXNeiW3e5FwdS5ePW0LGEu17zT139ktg==",
      "license": "MIT",
      "workspaces": [
        "docs",
        "benchmarks"
      ]
    },
    "node_modules/esbuild": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.21.5.tgz",
      "integrity": "sha512-mg3OPMV4hXywwpoDxu3Qda5xCKQi+vCTZq8S9J/EpkhB2HzKXq4SNFZE3+NK93JYxc8VMSep+lOUSC/RVKaBqw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=12"
      },
      "optionalDependencies": {
        "@esbuild/aix-ppc64": "0.21.5",
        "@esbuild/android-arm": "0.21.5",
        "@esbuild/android-arm64": "0.21.5",
        "@esbuild/android-x64": "0.21.5",
        "@esbuild/darwin-arm64": "0.21.5",
        "@esbuild/darwin-x64": "0.21.5",
        "@esbuild/freebsd-arm64": "0.21.5",
        "@esbuild/freebsd-x64": "0.21.5",
        "@esbuild/linux-arm": "0.21.5",
        "@esbuild/linux-arm64": "0.21.5",
        "@esbuild/linux-ia32": "0.21.5",
        "@esbuild/linux-loong64": "0.21.5",
        "@esbuild/linux-mips64el": "0.21.5",
        "@esbuild/linux-ppc64": "0.21.5",
        "@esbuild/linux-riscv64": "0.21.5",
        "@esbuild/linux-s390x": "0.21.5",
        "@esbuild/linux-x64": "0.21.5",
        "@esbuild/netbsd-x64": "0.21.5",
        "@esbuild/openbsd-x64": "0.21.5",
        "@esbuild/sunos-x64": "0.21.5",
        "@esbuild/win32-arm64": "0.21.5",
        "@esbuild/win32-ia32": "0.21.5",
        "@esbuild/win32-x64": "0.21.5"
      }
    },
    "node_modules/escalade": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/eventemitter3": {
      "version": "5.0.4",
      "resolved": "https://registry.npmjs.org/eventemitter3/-/eventemitter3-5.0.4.tgz",
      "integrity": "sha512-mlsTRyGaPBjPedk6Bvw+aqbsXDtoAyAzm5MO7JgU+yVRyMQ5O8bD4Kcci7BS85f93veegeCPkL8R4GLClnjLFw==",
      "license": "MIT"
    },
    "node_modules/fsevents": {
      "version": "2.3.3",
      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
      }
    },
    "node_modules/gensync": {
      "version": "1.0.0-beta.2",
      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/immer": {
      "version": "10.2.0",
      "resolved": "https://registry.npmjs.org/immer/-/immer-10.2.0.tgz",
      "integrity": "sha512-d/+XTN3zfODyjr89gM3mPq1WNX2B8pYsu7eORitdwyA2sBubnTl3laYlBk4sXY5FUa5qTZGBDPJICVbvqzjlbw==",
      "license": "MIT",
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/immer"
      }
    },
    "node_modules/internmap": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/internmap/-/internmap-2.0.3.tgz",
      "integrity": "sha512-5Hh7Y1wQbvY5ooGgPbDaL5iYLAPzMTUrjMulskHLH6wnv/A+1q5rgEaiuqEjB+oxGXIVZs1FF+R/KPN3ZSQYYg==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/js-tokens": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
      "license": "MIT"
    },
    "node_modules/jsesc": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "jsesc": "bin/jsesc"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/json5": {
      "version": "2.2.3",
      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "json5": "lib/cli.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/loose-envify": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
      "license": "MIT",
      "dependencies": {
        "js-tokens": "^3.0.0 || ^4.0.0"
      },
      "bin": {
        "loose-envify": "cli.js"
      }
    },
    "node_modules/lru-cache": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "yallist": "^3.0.2"
      }
    },
    "node_modules/lucide-react": {
      "version": "0.294.0",
      "resolved": "https://registry.npmjs.org/lucide-react/-/lucide-react-0.294.0.tgz",
      "integrity": "sha512-V7o0/VECSGbLHn3/1O67FUgBwWB+hmzshrgDVRJQhMh8uj5D3HBuIvhuAmQTtlupILSplwIZg5FTc4tTKMA2SA==",
      "license": "ISC",
      "peerDependencies": {
        "react": "^16.5.1 || ^17.0.0 || ^18.0.0"
      }
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/nanoid": {
      "version": "3.3.11",
      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "bin": {
        "nanoid": "bin/nanoid.cjs"
      },
      "engines": {
        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
      }
    },
    "node_modules/node-releases": {
      "version": "2.0.27",
      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.27.tgz",
      "integrity": "sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/picocolors": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/postcss": {
      "version": "8.5.6",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
      "integrity": "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "nanoid": "^3.3.11",
        "picocolors": "^1.1.1",
        "source-map-js": "^1.2.1"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/react": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
      "integrity": "sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-dom": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
      "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0",
        "scheduler": "^0.23.2"
      },
      "peerDependencies": {
        "react": "^18.3.1"
      }
    },
    "node_modules/react-is": {
      "version": "19.2.4",
      "resolved": "https://registry.npmjs.org/react-is/-/react-is-19.2.4.tgz",
      "integrity": "sha512-W+EWGn2v0ApPKgKKCy/7s7WHXkboGcsrXE+2joLyVxkbyVQfO3MUEaUQDHoSmb8TFFrSKYa9mw64WZHNHSDzYA==",
      "license": "MIT",
      "peer": true
    },
    "node_modules/react-redux": {
      "version": "9.2.0",
      "resolved": "https://registry.npmjs.org/react-redux/-/react-redux-9.2.0.tgz",
      "integrity": "sha512-ROY9fvHhwOD9ySfrF0wmvu//bKCQ6AeZZq1nJNtbDC+kk5DuSuNX/n6YWYF/SYy7bSba4D4FSz8DJeKY/S/r+g==",
      "license": "MIT",
      "dependencies": {
        "@types/use-sync-external-store": "^0.0.6",
        "use-sync-external-store": "^1.4.0"
      },
      "peerDependencies": {
        "@types/react": "^18.2.25 || ^19",
        "react": "^18.0 || ^19",
        "redux": "^5.0.0"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "redux": {
          "optional": true
        }
      }
    },
    "node_modules/react-refresh": {
      "version": "0.17.0",
      "resolved": "https://registry.npmjs.org/react-refresh/-/react-refresh-0.17.0.tgz",
      "integrity": "sha512-z6F7K9bV85EfseRCp2bzrpyQ0Gkw1uLoCel9XBVWPg/TjRj94SkJzUTGfOa4bs7iJvBWtQG0Wq7wnI0syw3EBQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-router": {
      "version": "7.13.0",
      "resolved": "https://registry.npmjs.org/react-router/-/react-router-7.13.0.tgz",
      "integrity": "sha512-PZgus8ETambRT17BUm/LL8lX3Of+oiLaPuVTRH3l1eLvSPpKO3AvhAEb5N7ihAFZQrYDqkvvWfFh9p0z9VsjLw==",
      "license": "MIT",
      "dependencies": {
        "cookie": "^1.0.1",
        "set-cookie-parser": "^2.6.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "react": ">=18",
        "react-dom": ">=18"
      },
      "peerDependenciesMeta": {
        "react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/react-router-dom": {
      "version": "7.13.0",
      "resolved": "https://registry.npmjs.org/react-router-dom/-/react-router-dom-7.13.0.tgz",
      "integrity": "sha512-5CO/l5Yahi2SKC6rGZ+HDEjpjkGaG/ncEP7eWFTvFxbHP8yeeI0PxTDjimtpXYlR3b3i9/WIL4VJttPrESIf2g==",
      "license": "MIT",
      "dependencies": {
        "react-router": "7.13.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "react": ">=18",
        "react-dom": ">=18"
      }
    },
    "node_modules/recharts": {
      "version": "3.7.0",
      "resolved": "https://registry.npmjs.org/recharts/-/recharts-3.7.0.tgz",
      "integrity": "sha512-l2VCsy3XXeraxIID9fx23eCb6iCBsxUQDnE8tWm6DFdszVAO7WVY/ChAD9wVit01y6B2PMupYiMmQwhgPHc9Ew==",
      "license": "MIT",
      "workspaces": [
        "www"
      ],
      "dependencies": {
        "@reduxjs/toolkit": "1.x.x || 2.x.x",
        "clsx": "^2.1.1",
        "decimal.js-light": "^2.5.1",
        "es-toolkit": "^1.39.3",
        "eventemitter3": "^5.0.1",
        "immer": "^10.1.1",
        "react-redux": "8.x.x || 9.x.x",
        "reselect": "5.1.1",
        "tiny-invariant": "^1.3.3",
        "use-sync-external-store": "^1.2.2",
        "victory-vendor": "^37.0.2"
      },
      "engines": {
        "node": ">=18"
      },
      "peerDependencies": {
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0",
        "react-dom": "^16.0.0 || ^17.0.0 || ^18.0.0 || ^19.0.0",
        "react-is": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0"
      }
    },
    "node_modules/redux": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/redux/-/redux-5.0.1.tgz",
      "integrity": "sha512-M9/ELqF6fy8FwmkpnF0S3YKOqMyoWJ4+CS5Efg2ct3oY9daQvd/Pc71FpGZsVsbl3Cpb+IIcjBDUnnyBdQbq4w==",
      "license": "MIT"
    },
    "node_modules/redux-thunk": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/redux-thunk/-/redux-thunk-3.1.0.tgz",
      "integrity": "sha512-NW2r5T6ksUKXCabzhL9z+h206HQw/NJkcLm1GPImRQ8IzfXwRGqjVhKJGauHirT0DAuyy6hjdnMZaRoAcy0Klw==",
      "license": "MIT",
      "peerDependencies": {
        "redux": "^5.0.0"
      }
    },
    "node_modules/reselect": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/reselect/-/reselect-5.1.1.tgz",
      "integrity": "sha512-K/BG6eIky/SBpzfHZv/dd+9JBFiS4SWV7FIujVyJRux6e45+73RaUHXLmIR1f7WOMaQ0U1km6qwklRQxpJJY0w==",
      "license": "MIT"
    },
    "node_modules/rollup": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.57.1.tgz",
      "integrity": "sha512-oQL6lgK3e2QZeQ7gcgIkS2YZPg5slw37hYufJ3edKlfQSGGm8ICoxswK15ntSzF/a8+h7ekRy7k7oWc3BQ7y8A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/estree": "1.0.8"
      },
      "bin": {
        "rollup": "dist/bin/rollup"
      },
      "engines": {
        "node": ">=18.0.0",
        "npm": ">=8.0.0"
      },
      "optionalDependencies": {
        "@rollup/rollup-android-arm-eabi": "4.57.1",
        "@rollup/rollup-android-arm64": "4.57.1",
        "@rollup/rollup-darwin-arm64": "4.57.1",
        "@rollup/rollup-darwin-x64": "4.57.1",
        "@rollup/rollup-freebsd-arm64": "4.57.1",
        "@rollup/rollup-freebsd-x64": "4.57.1",
        "@rollup/rollup-linux-arm-gnueabihf": "4.57.1",
        "@rollup/rollup-linux-arm-musleabihf": "4.57.1",
        "@rollup/rollup-linux-arm64-gnu": "4.57.1",
        "@rollup/rollup-linux-arm64-musl": "4.57.1",
        "@rollup/rollup-linux-loong64-gnu": "4.57.1",
        "@rollup/rollup-linux-loong64-musl": "4.57.1",
        "@rollup/rollup-linux-ppc64-gnu": "4.57.1",
        "@rollup/rollup-linux-ppc64-musl": "4.57.1",
        "@rollup/rollup-linux-riscv64-gnu": "4.57.1",
        "@rollup/rollup-linux-riscv64-musl": "4.57.1",
        "@rollup/rollup-linux-s390x-gnu": "4.57.1",
        "@rollup/rollup-linux-x64-gnu": "4.57.1",
        "@rollup/rollup-linux-x64-musl": "4.57.1",
        "@rollup/rollup-openbsd-x64": "4.57.1",
        "@rollup/rollup-openharmony-arm64": "4.57.1",
        "@rollup/rollup-win32-arm64-msvc": "4.57.1",
        "@rollup/rollup-win32-ia32-msvc": "4.57.1",
        "@rollup/rollup-win32-x64-gnu": "4.57.1",
        "@rollup/rollup-win32-x64-msvc": "4.57.1",
        "fsevents": "~2.3.2"
      }
    },
    "node_modules/scheduler": {
      "version": "0.23.2",
      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
      "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0"
      }
    },
    "node_modules/semver": {
      "version": "6.3.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
      "dev": true,
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      }
    },
    "node_modules/set-cookie-parser": {
      "version": "2.7.2",
      "resolved": "https://registry.npmjs.org/set-cookie-parser/-/set-cookie-parser-2.7.2.tgz",
      "integrity": "sha512-oeM1lpU/UvhTxw+g3cIfxXHyJRc/uidd3yK1P242gzHds0udQBYzs3y8j4gCCW+ZJ7ad0yctld8RYO+bdurlvw==",
      "license": "MIT"
    },
    "node_modules/source-map-js": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
      "dev": true,
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/tiny-invariant": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/tiny-invariant/-/tiny-invariant-1.3.3.tgz",
      "integrity": "sha512-+FbBPE1o9QAYvviau/qC5SE3caw21q3xkvWKBtja5vgqOWIHHJ3ioaq1VPfn/Szqctz2bU/oYeKd9/z5BL+PVg==",
      "license": "MIT"
    },
    "node_modules/update-browserslist-db": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz",
      "integrity": "sha512-Js0m9cx+qOgDxo0eMiFGEueWztz+d4+M3rGlmKPT+T4IS/jP4ylw3Nwpu6cpTTP8R1MAC1kF4VbdLt3ARf209w==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "escalade": "^3.2.0",
        "picocolors": "^1.1.1"
      },
      "bin": {
        "update-browserslist-db": "cli.js"
      },
      "peerDependencies": {
        "browserslist": ">= 4.21.0"
      }
    },
    "node_modules/use-sync-external-store": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/use-sync-external-store/-/use-sync-external-store-1.6.0.tgz",
      "integrity": "sha512-Pp6GSwGP/NrPIrxVFAIkOQeyw8lFenOHijQWkUTrDvrF4ALqylP2C/KCkeS9dpUM3KvYRQhna5vt7IL95+ZQ9w==",
      "license": "MIT",
      "peerDependencies": {
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0"
      }
    },
    "node_modules/victory-vendor": {
      "version": "37.3.6",
      "resolved": "https://registry.npmjs.org/victory-vendor/-/victory-vendor-37.3.6.tgz",
      "integrity": "sha512-SbPDPdDBYp+5MJHhBCAyI7wKM3d5ivekigc2Dk2s7pgbZ9wIgIBYGVw4zGHBml/qTFbexrofXW6Gu4noGxrOwQ==",
      "license": "MIT AND ISC",
      "dependencies": {
        "@types/d3-array": "^3.0.3",
        "@types/d3-ease": "^3.0.0",
        "@types/d3-interpolate": "^3.0.1",
        "@types/d3-scale": "^4.0.2",
        "@types/d3-shape": "^3.1.0",
        "@types/d3-time": "^3.0.0",
        "@types/d3-timer": "^3.0.0",
        "d3-array": "^3.1.6",
        "d3-ease": "^3.0.1",
        "d3-interpolate": "^3.0.1",
        "d3-scale": "^4.0.2",
        "d3-shape": "^3.1.0",
        "d3-time": "^3.0.0",
        "d3-timer": "^3.0.1"
      }
    },
    "node_modules/vite": {
      "version": "5.4.21",
      "resolved": "https://registry.npmjs.org/vite/-/vite-5.4.21.tgz",
      "integrity": "sha512-o5a9xKjbtuhY6Bi5S3+HvbRERmouabWbyUcpXXUA1u+GNUKoROi9byOJ8M0nHbHYHkYICiMlqxkg1KkYmm25Sw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "esbuild": "^0.21.3",
        "postcss": "^8.4.43",
        "rollup": "^4.20.0"
      },
      "bin": {
        "vite": "bin/vite.js"
      },
      "engines": {
        "node": "^18.0.0 || >=20.0.0"
      },
      "funding": {
        "url": "https://github.com/vitejs/vite?sponsor=1"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.3"
      },
      "peerDependencies": {
        "@types/node": "^18.0.0 || >=20.0.0",
        "less": "*",
        "lightningcss": "^1.21.0",
        "sass": "*",
        "sass-embedded": "*",
        "stylus": "*",
        "sugarss": "*",
        "terser": "^5.4.0"
      },
      "peerDependenciesMeta": {
        "@types/node": {
          "optional": true
        },
        "less": {
          "optional": true
        },
        "lightningcss": {
          "optional": true
        },
        "sass": {
          "optional": true
        },
        "sass-embedded": {
          "optional": true
        },
        "stylus": {
          "optional": true
        },
        "sugarss": {
          "optional": true
        },
        "terser": {
          "optional": true
        }
      }
    },
    "node_modules/yallist": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
      "dev": true,
      "license": "ISC"
    }
  }
}

--- END OF FILE ---

--- FILE: package.json ---
{
  "name": "image-gen-mvp",
  "version": "1.0.0",
  "private": true,
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "lucide-react": "^0.294.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^7.13.0",
    "recharts": "^3.7.0"
  },
  "devDependencies": {
    "@vitejs/plugin-react": "^4.2.0",
    "vite": "^5.0.0"
  }
}

--- END OF FILE ---

--- FILE: .env ---
# Amazon Listing Image Generator - Frontend Environment
# Copy this file to .env and fill in your values
#
# NOTE: API keys are now managed on the BACKEND only.
# The frontend no longer needs AI provider keys.
# See backend/.env.example for API key configuration.

# ============================================
# GOOGLE CALENDAR INTEGRATION (optional)
# ============================================
# For Clockwise-style focus time blocking during sessions

# Get credentials from: https://console.cloud.google.com/apis/credentials
# 1. Create a project in Google Cloud Console
# 2. Enable Google Calendar API
# 3. Create OAuth 2.0 credentials (Web application)
# 4. Add http://localhost:3000 to authorized JavaScript origins

VITE_GOOGLE_CLIENT_ID=your_google_client_id.apps.googleusercontent.com
VITE_GOOGLE_API_KEY=your_google_api_key

--- END OF FILE ---

--- FILE: project_context.txt ---

--- FILE: index.html ---
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Amazon Listing Image Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>

--- END OF FILE ---

--- FILE: SETUP.md ---
# Setup Guide

Complete step-by-step guide to run the ImageGen MVP locally.

## Prerequisites

1. **Python 3.10+** - [Download](https://www.python.org/downloads/)
2. **Node.js 18+** - [Download](https://nodejs.org/)
3. **Replicate Account** - [Sign up](https://replicate.com/) (free tier available)

---

## Step 1: Get Your Replicate API Token

1. Go to [replicate.com](https://replicate.com)
2. Sign up or log in
3. Go to Account Settings → API Tokens
4. Copy your API token

---

## Step 2: Set Up Backend

Open a terminal and run:

```bash
# Navigate to backend folder
cd image-gen-mvp/backend

# Create virtual environment
python -m venv venv

# Activate it (Windows)
venv\Scripts\activate

# Activate it (Mac/Linux)
# source venv/bin/activate

# Install dependencies
pip install -r requirements.txt

# Create .env file
copy .env.example .env
# (Mac/Linux: cp .env.example .env)

# Edit .env and add your Replicate API token
# REPLICATE_API_TOKEN=your_token_here

# Run the backend
uvicorn app.main:app --reload
```

Backend will be running at: `http://localhost:8000`

Test it: Open `http://localhost:8000` in your browser - you should see:
```json
{"message": "ImageGen MVP API", "status": "running"}
```

---

## Step 3: Set Up Frontend

Open a **new terminal** and run:

```bash
# Navigate to frontend folder
cd image-gen-mvp/frontend

# Install dependencies
npm install

# Create .env.local
copy .env.example .env.local
# (Mac/Linux: cp .env.example .env.local)

# Run the frontend
npm run dev
```

Frontend will be running at: `http://localhost:3000`

---

## Step 4: Use the App

1. Open `http://localhost:3000` in your browser
2. Type a prompt like "A cute cat in a garden"
3. Select a style (optional)
4. Click "Generate"
5. Wait for your image!

---

## Troubleshooting

### "Failed to generate image"
- Check that your Replicate API token is correct in `backend/.env`
- Ensure you have credits in your Replicate account
- Check the backend terminal for error messages

### "Network Error" or CORS issues
- Make sure the backend is running on port 8000
- Check that `FRONTEND_URL=http://localhost:3000` in backend `.env`

### Images not loading
- Check that the `generated` folder exists in the backend directory
- Verify the backend is serving static files correctly

---

## Next Steps

After confirming the MVP works:

1. **Add authentication** - Protect your API
2. **Deploy** - Use Vercel (frontend) + Railway/Render (backend)
3. **Add more features** - See the roadmap in README.md

---

## Useful Commands

| Command | Location | Purpose |
|---------|----------|---------|
| `uvicorn app.main:app --reload` | backend/ | Run backend |
| `npm run dev` | frontend/ | Run frontend |
| `npm run build` | frontend/ | Build for production |
| `pip freeze > requirements.txt` | backend/ | Update dependencies |

--- END OF FILE ---

--- FILE: vite.config.js ---
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000,
    open: true,
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true
      },
      '/images': {
        target: 'http://localhost:8000',
        changeOrigin: true
      }
    }
  }
})

--- END OF FILE ---

--- FILE: README.md ---
# Amazon Listing Image Generator

A professional image generation tool for Amazon sellers. Generate product photos optimized for Amazon listings with automatic session tracking, calendar integration, and data export.

## Features

### Image Generation
- **Amazon-Optimized Prompts** - Automatically builds professional prompts for Amazon listing images
- **5 Image Types** - Main Image, Lifestyle, Infographic, Detail Shot, Comparison
- **8 Product Categories** - Electronics, Home & Kitchen, Beauty, Sports, Toys, Clothing, Food, Pets
- **Multiple AI Providers** - Replicate (Flux), OpenAI (DALL-E 3), Stability AI

### Session Tracking
- **Time Tracking** - Track how long you spend generating images
- **Project Organization** - Group sessions by product/project name
- **Session Statistics** - View total time, images generated, session history
- **Auto-Start** - Sessions automatically start when you generate

### Calendar Integration (Clockwise Compatible)
- **Google Calendar Sync** - Create focus time blocks when you start sessions
- **Automatic Updates** - Calendar events update with actual duration when you end
- **Clockwise Compatible** - Works with Clockwise for smart scheduling

### Data & Export
- **IndexedDB Storage** - All data persisted locally in the browser
- **CSV Export** - Export sessions and images to spreadsheet
- **PDF Reports** - Generate printable reports with statistics
- **History & Favorites** - Browse and manage all generated images

## Quick Start

1. **Install dependencies**
   ```bash
   npm install
   ```

2. **Configure API (optional)**
   ```bash
   cp .env.example .env
   # Edit .env with your API credentials
   ```

3. **Start development server**
   ```bash
   npm run dev
   ```

4. Open http://localhost:3000

## Demo Mode

By default, the app runs in demo mode using placeholder images. This is perfect for testing the UI without an API key.

## Configuration

### Image Generation API

Edit your `.env` file:

```env
# Replicate (Recommended - Flux model)
VITE_API_PROVIDER=replicate
VITE_API_KEY=your_replicate_token

# OpenAI (DALL-E 3)
VITE_API_PROVIDER=openai
VITE_API_KEY=your_openai_api_key

# Stability AI (SDXL)
VITE_API_PROVIDER=stability
VITE_API_KEY=your_stability_api_key
```

If you want to use Nano Banana tokens for server-side calls or to forward per-request tokens from the frontend, set the backend env var `NANO_BANANA_TOKEN` or send the header `x-nano-banana-token` with requests to the backend generate endpoint. The backend will use a per-request header token when present, otherwise it falls back to the configured `NANO_BANANA_TOKEN`.

### Google Calendar Integration

1. Go to [Google Cloud Console](https://console.cloud.google.com)
2. Create a project and enable Google Calendar API
3. Create OAuth 2.0 credentials (Web application)
4. Add `http://localhost:3000` to authorized JavaScript origins
5. Add to your `.env`:

```env
VITE_GOOGLE_CLIENT_ID=your_client_id.apps.googleusercontent.com
VITE_GOOGLE_API_KEY=your_api_key
```

## Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| Ctrl + Enter | Generate image |
| Ctrl + S | Save to gallery |

## Project Structure

```
image-gen-mvp/
├── src/
│   ├── App.jsx                 # Main app with state management
│   ├── App.css                 # Styles (dark theme)
│   ├── main.jsx                # Entry point
│   ├── components/
│   │   ├── PromptInput.jsx     # Image type, category, prompt
│   │   ├── ImageDisplay.jsx    # Image viewer + progress
│   │   ├── History.jsx         # Generation history
│   │   ├── Gallery.jsx         # Saved favorites
│   │   ├── SessionPanel.jsx    # Time tracking controls
│   │   └── SettingsPanel.jsx   # API config + exports
│   ├── api/
│   │   └── imageGen.js         # Multi-provider image API
│   ├── services/
│   │   ├── database.js         # IndexedDB storage
│   │   ├── sessionTracker.js   # Session/time tracking
│   │   └── calendar.js         # Google Calendar integration
│   └── utils/
│       └── export.js           # CSV/PDF export utilities
├── .env.example                # Environment template
├── package.json
└── vite.config.js
```

## Tech Stack

- React 18
- Vite
- IndexedDB (persistent storage)
- Lucide React (icons)
- Google Calendar API

## API Pricing (Approximate)

| Provider | Cost per Image |
|----------|---------------|
| Replicate (Flux) | ~$0.003 |
| Stability AI | ~$0.002 |
| OpenAI DALL-E 3 | $0.04 (standard) |

## License

MIT

--- END OF FILE ---

--- FILE: .gitignore ---
# Dependencies
node_modules/

# Build output
dist/

# Environment variables
.env
.env.local
.env.*.local

# Editor directories
.idea/
.vscode/
*.swp
*.swo

# OS files
.DS_Store
Thumbs.db

# Logs
*.log
npm-debug.log*

# Cache
.cache/

# Python
__pycache__/
*.pyc
*.db
backend/generated/

--- END OF FILE ---

--- FILE: package-lock.json ---
{
  "name": "image-gen-mvp",
  "version": "1.0.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "image-gen-mvp",
      "version": "1.0.0",
      "dependencies": {
        "lucide-react": "^0.294.0",
        "react": "^18.2.0",
        "react-dom": "^18.2.0",
        "react-router-dom": "^7.13.0",
        "recharts": "^3.7.0"
      },
      "devDependencies": {
        "@vitejs/plugin-react": "^4.2.0",
        "vite": "^5.0.0"
      }
    },
    "node_modules/@babel/code-frame": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.29.0.tgz",
      "integrity": "sha512-9NhCeYjq9+3uxgdtp20LSiJXJvN0FeCtNGpJxuMFZ1Kv3cWUNb6DOhJwUvcVCzKGR66cw4njwM6hrJLqgOwbcw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-validator-identifier": "^7.28.5",
        "js-tokens": "^4.0.0",
        "picocolors": "^1.1.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/compat-data": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.29.0.tgz",
      "integrity": "sha512-T1NCJqT/j9+cn8fvkt7jtwbLBfLC/1y1c7NtCeXFRgzGTsafi68MRv8yzkYSapBnFA6L3U2VSc02ciDzoAJhJg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/core": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.29.0.tgz",
      "integrity": "sha512-CGOfOJqWjg2qW/Mb6zNsDm+u5vFQ8DxXfbM09z69p5Z6+mE1ikP2jUXw+j42Pf1XTYED2Rni5f95npYeuwMDQA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.29.0",
        "@babel/generator": "^7.29.0",
        "@babel/helper-compilation-targets": "^7.28.6",
        "@babel/helper-module-transforms": "^7.28.6",
        "@babel/helpers": "^7.28.6",
        "@babel/parser": "^7.29.0",
        "@babel/template": "^7.28.6",
        "@babel/traverse": "^7.29.0",
        "@babel/types": "^7.29.0",
        "@jridgewell/remapping": "^2.3.5",
        "convert-source-map": "^2.0.0",
        "debug": "^4.1.0",
        "gensync": "^1.0.0-beta.2",
        "json5": "^2.2.3",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/babel"
      }
    },
    "node_modules/@babel/generator": {
      "version": "7.29.1",
      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.29.1.tgz",
      "integrity": "sha512-qsaF+9Qcm2Qv8SRIMMscAvG4O3lJ0F1GuMo5HR/Bp02LopNgnZBC/EkbevHFeGs4ls/oPz9v+Bsmzbkbe+0dUw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.29.0",
        "@babel/types": "^7.29.0",
        "@jridgewell/gen-mapping": "^0.3.12",
        "@jridgewell/trace-mapping": "^0.3.28",
        "jsesc": "^3.0.2"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.28.6.tgz",
      "integrity": "sha512-JYtls3hqi15fcx5GaSNL7SCTJ2MNmjrkHXg4FSpOA/grxK8KwyZ5bubHsCq8FXCkua6xhuaaBit+3b7+VZRfcA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/compat-data": "^7.28.6",
        "@babel/helper-validator-option": "^7.27.1",
        "browserslist": "^4.24.0",
        "lru-cache": "^5.1.1",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-globals": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-imports": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.28.6.tgz",
      "integrity": "sha512-l5XkZK7r7wa9LucGw9LwZyyCUscb4x37JWTPz7swwFE/0FMQAGpiWUZn8u9DzkSBWEcK25jmvubfpw2dnAMdbw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/traverse": "^7.28.6",
        "@babel/types": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-transforms": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.6.tgz",
      "integrity": "sha512-67oXFAYr2cDLDVGLXTEABjdBJZ6drElUSI7WKp70NrpyISso3plG9SAGEF6y7zbha/wOzUByWWTJvEDVNIUGcA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-module-imports": "^7.28.6",
        "@babel/helper-validator-identifier": "^7.28.5",
        "@babel/traverse": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/@babel/helper-plugin-utils": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.28.6.tgz",
      "integrity": "sha512-S9gzZ/bz83GRysI7gAD4wPT/AI3uCnY+9xn+Mx/KPs2JwHJIz1W8PZkg2cqyt3RNOBM8ejcXhV6y8Og7ly/Dug==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-string-parser": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-identifier": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-option": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helpers": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.6.tgz",
      "integrity": "sha512-xOBvwq86HHdB7WUDTfKfT/Vuxh7gElQ+Sfti2Cy6yIWNW05P8iUslOVcZ4/sKbE+/jQaukQAdz/gf3724kYdqw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/template": "^7.28.6",
        "@babel/types": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/parser": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.29.0.tgz",
      "integrity": "sha512-IyDgFV5GeDUVX4YdF/3CPULtVGSXXMLh1xVIgdCgxApktqnQV0r7/8Nqthg+8YLGaAtdyIlo2qIdZrbCv4+7ww==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.29.0"
      },
      "bin": {
        "parser": "bin/babel-parser.js"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-self": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-self/-/plugin-transform-react-jsx-self-7.27.1.tgz",
      "integrity": "sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-source": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-source/-/plugin-transform-react-jsx-source-7.27.1.tgz",
      "integrity": "sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/template": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.28.6.tgz",
      "integrity": "sha512-YA6Ma2KsCdGb+WC6UpBVFJGXL58MDA6oyONbjyF/+5sBgxY/dwkhLogbMT2GXXyU84/IhRw/2D1Os1B/giz+BQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.28.6",
        "@babel/parser": "^7.28.6",
        "@babel/types": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/traverse": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.29.0.tgz",
      "integrity": "sha512-4HPiQr0X7+waHfyXPZpWPfWL/J7dcN1mx9gL6WdQVMbPnF3+ZhSMs8tCxN7oHddJE9fhNE7+lxdnlyemKfJRuA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.29.0",
        "@babel/generator": "^7.29.0",
        "@babel/helper-globals": "^7.28.0",
        "@babel/parser": "^7.29.0",
        "@babel/template": "^7.28.6",
        "@babel/types": "^7.29.0",
        "debug": "^4.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/types": {
      "version": "7.29.0",
      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.29.0.tgz",
      "integrity": "sha512-LwdZHpScM4Qz8Xw2iKSzS+cfglZzJGvofQICy7W7v4caru4EaAmyUuO6BGrbyQ2mYV11W0U8j5mBhd14dd3B0A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-string-parser": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.28.5"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@esbuild/aix-ppc64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz",
      "integrity": "sha512-1SDgH6ZSPTlggy1yI6+Dbkiz8xzpHJEVAlF/AM1tHPLsf5STom9rwtjE4hKAF20FfXXNTFqEYXyJNWh1GiZedQ==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "aix"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-arm": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.21.5.tgz",
      "integrity": "sha512-vCPvzSjpPHEi1siZdlvAlsPxXl7WbOVUBBAowWug4rJHb68Ox8KualB+1ocNvT5fjv6wpkX6o/iEpbDrf68zcg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.21.5.tgz",
      "integrity": "sha512-c0uX9VAUBQ7dTDCjq+wdyGLowMdtR/GoC2U5IYk/7D1H1JYC0qseD7+11iMP2mRLN9RcCMRcjC4YMclCzGwS/A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.21.5.tgz",
      "integrity": "sha512-D7aPRUUNHRBwHxzxRvp856rjUHRFW1SdQATKXH2hqA0kAZb1hKmi02OpYRacl0TxIGz/ZmXWlbZgjwWYaCakTA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.21.5.tgz",
      "integrity": "sha512-DwqXqZyuk5AiWWf3UfLiRDJ5EDd49zg6O9wclZ7kUMv2WRFr4HKjXp/5t8JZ11QbQfUS6/cRCKGwYhtNAY88kQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.21.5.tgz",
      "integrity": "sha512-se/JjF8NlmKVG4kNIuyWMV/22ZaerB+qaSi5MdrXtd6R08kvs2qCN4C09miupktDitvh8jRFflwGFBQcxZRjbw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.21.5.tgz",
      "integrity": "sha512-5JcRxxRDUJLX8JXp/wcBCy3pENnCgBR9bN6JsY4OmhfUtIHe3ZW0mawA7+RDAcMLrMIZaf03NlQiX9DGyB8h4g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.21.5.tgz",
      "integrity": "sha512-J95kNBj1zkbMXtHVH29bBriQygMXqoVQOQYA+ISs0/2l3T9/kj42ow2mpqerRBxDJnmkUDCaQT/dfNXWX/ZZCQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.21.5.tgz",
      "integrity": "sha512-bPb5AHZtbeNGjCKVZ9UGqGwo8EUu4cLq68E95A53KlxAPRmUyYv2D6F0uUI65XisGOL1hBP5mTronbgo+0bFcA==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.21.5.tgz",
      "integrity": "sha512-ibKvmyYzKsBeX8d8I7MH/TMfWDXBF3db4qM6sy+7re0YXya+K1cem3on9XgdT2EQGMu4hQyZhan7TeQ8XkGp4Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ia32": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.21.5.tgz",
      "integrity": "sha512-YvjXDqLRqPDl2dvRODYmmhz4rPeVKYvppfGYKSNGdyZkA01046pLWyRKKI3ax8fbJoK5QbxblURkwK/MWY18Tg==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-loong64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.21.5.tgz",
      "integrity": "sha512-uHf1BmMG8qEvzdrzAqg2SIG/02+4/DHB6a9Kbya0XDvwDEKCoC8ZRWI5JJvNdUjtciBGFQ5PuBlpEOXQj+JQSg==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-mips64el": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.21.5.tgz",
      "integrity": "sha512-IajOmO+KJK23bj52dFSNCMsz1QP1DqM6cwLUv3W1QwyxkyIWecfafnI555fvSGqEKwjMXVLokcV5ygHW5b3Jbg==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ppc64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.21.5.tgz",
      "integrity": "sha512-1hHV/Z4OEfMwpLO8rp7CvlhBDnjsC3CttJXIhBi+5Aj5r+MBvy4egg7wCbe//hSsT+RvDAG7s81tAvpL2XAE4w==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-riscv64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.21.5.tgz",
      "integrity": "sha512-2HdXDMd9GMgTGrPWnJzP2ALSokE/0O5HhTUvWIbD3YdjME8JwvSCnNGBnTThKGEB91OZhzrJ4qIIxk/SBmyDDA==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-s390x": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.21.5.tgz",
      "integrity": "sha512-zus5sxzqBJD3eXxwvjN1yQkRepANgxE9lgOW2qLnmr8ikMTphkjgXu1HR01K4FJg8h1kEEDAqDcZQtbrRnB41A==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.21.5.tgz",
      "integrity": "sha512-1rYdTpyv03iycF1+BhzrzQJCdOuAOtaqHTWJZCWvijKD2N5Xu0TtVC8/+1faWqcP9iBCWOmjmhoH94dH82BxPQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/netbsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.21.5.tgz",
      "integrity": "sha512-Woi2MXzXjMULccIwMnLciyZH4nCIMpWQAs049KEeMvOcNADVxo0UBIQPfSmxB3CWKedngg7sWZdLvLczpe0tLg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/openbsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.21.5.tgz",
      "integrity": "sha512-HLNNw99xsvx12lFBUwoT8EVCsSvRNDVxNpjZ7bPn947b8gJPzeHWyNVhFsaerc0n3TsbOINvRP2byTZ5LKezow==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/sunos-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.21.5.tgz",
      "integrity": "sha512-6+gjmFpfy0BHU5Tpptkuh8+uw3mnrvgs+dSPQXQOv3ekbordwnzTVEb4qnIvQcYXq6gzkyTnoZ9dZG+D4garKg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.21.5.tgz",
      "integrity": "sha512-Z0gOTd75VvXqyq7nsl93zwahcTROgqvuAcYDUr+vOv8uHhNSKROyU961kgtCD1e95IqPKSQKH7tBTslnS3tA8A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-ia32": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.21.5.tgz",
      "integrity": "sha512-SWXFF1CL2RVNMaVs+BBClwtfZSvDgtL//G/smwAc5oVK/UPu2Gu9tIaRgFmYFFKrmg3SyAjSrElf0TiJ1v8fYA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.21.5.tgz",
      "integrity": "sha512-tQd/1efJuzPC6rCFwEvLtci/xNFcTZknmXs98FYDfGE4wP9ClFV98nyKrzJKVPMhdDnjzLhdUyMX4PsQAPjwIw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.13",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/remapping": {
      "version": "2.3.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.31",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@reduxjs/toolkit": {
      "version": "2.11.2",
      "resolved": "https://registry.npmjs.org/@reduxjs/toolkit/-/toolkit-2.11.2.tgz",
      "integrity": "sha512-Kd6kAHTA6/nUpp8mySPqj3en3dm0tdMIgbttnQ1xFMVpufoj+ADi8pXLBsd4xzTRHQa7t/Jv8W5UnCuW4kuWMQ==",
      "license": "MIT",
      "dependencies": {
        "@standard-schema/spec": "^1.0.0",
        "@standard-schema/utils": "^0.3.0",
        "immer": "^11.0.0",
        "redux": "^5.0.1",
        "redux-thunk": "^3.1.0",
        "reselect": "^5.1.0"
      },
      "peerDependencies": {
        "react": "^16.9.0 || ^17.0.0 || ^18 || ^19",
        "react-redux": "^7.2.1 || ^8.1.3 || ^9.0.0"
      },
      "peerDependenciesMeta": {
        "react": {
          "optional": true
        },
        "react-redux": {
          "optional": true
        }
      }
    },
    "node_modules/@reduxjs/toolkit/node_modules/immer": {
      "version": "11.1.4",
      "resolved": "https://registry.npmjs.org/immer/-/immer-11.1.4.tgz",
      "integrity": "sha512-XREFCPo6ksxVzP4E0ekD5aMdf8WMwmdNaz6vuvxgI40UaEiu6q3p8X52aU6GdyvLY3XXX/8R7JOTXStz/nBbRw==",
      "license": "MIT",
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/immer"
      }
    },
    "node_modules/@rolldown/pluginutils": {
      "version": "1.0.0-beta.27",
      "resolved": "https://registry.npmjs.org/@rolldown/pluginutils/-/pluginutils-1.0.0-beta.27.tgz",
      "integrity": "sha512-+d0F4MKMCbeVUJwG96uQ4SgAznZNSq93I3V+9NHA4OpvqG8mRCpGdKmK8l/dl02h2CCDHwW2FqilnTyDcAnqjA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@rollup/rollup-android-arm-eabi": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.57.1.tgz",
      "integrity": "sha512-A6ehUVSiSaaliTxai040ZpZ2zTevHYbvu/lDoeAteHI8QnaosIzm4qwtezfRg1jOYaUmnzLX1AOD6Z+UJjtifg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@rollup/rollup-android-arm64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm64/-/rollup-android-arm64-4.57.1.tgz",
      "integrity": "sha512-dQaAddCY9YgkFHZcFNS/606Exo8vcLHwArFZ7vxXq4rigo2bb494/xKMMwRRQW6ug7Js6yXmBZhSBRuBvCCQ3w==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@rollup/rollup-darwin-arm64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-arm64/-/rollup-darwin-arm64-4.57.1.tgz",
      "integrity": "sha512-crNPrwJOrRxagUYeMn/DZwqN88SDmwaJ8Cvi/TN1HnWBU7GwknckyosC2gd0IqYRsHDEnXf328o9/HC6OkPgOg==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@rollup/rollup-darwin-x64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-x64/-/rollup-darwin-x64-4.57.1.tgz",
      "integrity": "sha512-Ji8g8ChVbKrhFtig5QBV7iMaJrGtpHelkB3lsaKzadFBe58gmjfGXAOfI5FV0lYMH8wiqsxKQ1C9B0YTRXVy4w==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@rollup/rollup-freebsd-arm64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-arm64/-/rollup-freebsd-arm64-4.57.1.tgz",
      "integrity": "sha512-R+/WwhsjmwodAcz65guCGFRkMb4gKWTcIeLy60JJQbXrJ97BOXHxnkPFrP+YwFlaS0m+uWJTstrUA9o+UchFug==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@rollup/rollup-freebsd-x64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-x64/-/rollup-freebsd-x64-4.57.1.tgz",
      "integrity": "sha512-IEQTCHeiTOnAUC3IDQdzRAGj3jOAYNr9kBguI7MQAAZK3caezRrg0GxAb6Hchg4lxdZEI5Oq3iov/w/hnFWY9Q==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm-gnueabihf": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-gnueabihf/-/rollup-linux-arm-gnueabihf-4.57.1.tgz",
      "integrity": "sha512-F8sWbhZ7tyuEfsmOxwc2giKDQzN3+kuBLPwwZGyVkLlKGdV1nvnNwYD0fKQ8+XS6hp9nY7B+ZeK01EBUE7aHaw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm-musleabihf": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-musleabihf/-/rollup-linux-arm-musleabihf-4.57.1.tgz",
      "integrity": "sha512-rGfNUfn0GIeXtBP1wL5MnzSj98+PZe/AXaGBCRmT0ts80lU5CATYGxXukeTX39XBKsxzFpEeK+Mrp9faXOlmrw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-gnu/-/rollup-linux-arm64-gnu-4.57.1.tgz",
      "integrity": "sha512-MMtej3YHWeg/0klK2Qodf3yrNzz6CGjo2UntLvk2RSPlhzgLvYEB3frRvbEF2wRKh1Z2fDIg9KRPe1fawv7C+g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm64-musl": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-musl/-/rollup-linux-arm64-musl-4.57.1.tgz",
      "integrity": "sha512-1a/qhaaOXhqXGpMFMET9VqwZakkljWHLmZOX48R0I/YLbhdxr1m4gtG1Hq7++VhVUmf+L3sTAf9op4JlhQ5u1Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-loong64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-gnu/-/rollup-linux-loong64-gnu-4.57.1.tgz",
      "integrity": "sha512-QWO6RQTZ/cqYtJMtxhkRkidoNGXc7ERPbZN7dVW5SdURuLeVU7lwKMpo18XdcmpWYd0qsP1bwKPf7DNSUinhvA==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-loong64-musl": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-musl/-/rollup-linux-loong64-musl-4.57.1.tgz",
      "integrity": "sha512-xpObYIf+8gprgWaPP32xiN5RVTi/s5FCR+XMXSKmhfoJjrpRAjCuuqQXyxUa/eJTdAE6eJ+KDKaoEqjZQxh3Gw==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-ppc64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-gnu/-/rollup-linux-ppc64-gnu-4.57.1.tgz",
      "integrity": "sha512-4BrCgrpZo4hvzMDKRqEaW1zeecScDCR+2nZ86ATLhAoJ5FQ+lbHVD3ttKe74/c7tNT9c6F2viwB3ufwp01Oh2w==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-ppc64-musl": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-musl/-/rollup-linux-ppc64-musl-4.57.1.tgz",
      "integrity": "sha512-NOlUuzesGauESAyEYFSe3QTUguL+lvrN1HtwEEsU2rOwdUDeTMJdO5dUYl/2hKf9jWydJrO9OL/XSSf65R5+Xw==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-riscv64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-gnu/-/rollup-linux-riscv64-gnu-4.57.1.tgz",
      "integrity": "sha512-ptA88htVp0AwUUqhVghwDIKlvJMD/fmL/wrQj99PRHFRAG6Z5nbWoWG4o81Nt9FT+IuqUQi+L31ZKAFeJ5Is+A==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-riscv64-musl": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-musl/-/rollup-linux-riscv64-musl-4.57.1.tgz",
      "integrity": "sha512-S51t7aMMTNdmAMPpBg7OOsTdn4tySRQvklmL3RpDRyknk87+Sp3xaumlatU+ppQ+5raY7sSTcC2beGgvhENfuw==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-s390x-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-s390x-gnu/-/rollup-linux-s390x-gnu-4.57.1.tgz",
      "integrity": "sha512-Bl00OFnVFkL82FHbEqy3k5CUCKH6OEJL54KCyx2oqsmZnFTR8IoNqBF+mjQVcRCT5sB6yOvK8A37LNm/kPJiZg==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-x64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.57.1.tgz",
      "integrity": "sha512-ABca4ceT4N+Tv/GtotnWAeXZUZuM/9AQyCyKYyKnpk4yoA7QIAuBt6Hkgpw8kActYlew2mvckXkvx0FfoInnLg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-x64-musl": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-musl/-/rollup-linux-x64-musl-4.57.1.tgz",
      "integrity": "sha512-HFps0JeGtuOR2convgRRkHCekD7j+gdAuXM+/i6kGzQtFhlCtQkpwtNzkNj6QhCDp7DRJ7+qC/1Vg2jt5iSOFw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-openbsd-x64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-openbsd-x64/-/rollup-openbsd-x64-4.57.1.tgz",
      "integrity": "sha512-H+hXEv9gdVQuDTgnqD+SQffoWoc0Of59AStSzTEj/feWTBAnSfSD3+Dql1ZruJQxmykT/JVY0dE8Ka7z0DH1hw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ]
    },
    "node_modules/@rollup/rollup-openharmony-arm64": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-openharmony-arm64/-/rollup-openharmony-arm64-4.57.1.tgz",
      "integrity": "sha512-4wYoDpNg6o/oPximyc/NG+mYUejZrCU2q+2w6YZqrAs2UcNUChIZXjtafAiiZSUc7On8v5NyNj34Kzj/Ltk6dQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openharmony"
      ]
    },
    "node_modules/@rollup/rollup-win32-arm64-msvc": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-arm64-msvc/-/rollup-win32-arm64-msvc-4.57.1.tgz",
      "integrity": "sha512-O54mtsV/6LW3P8qdTcamQmuC990HDfR71lo44oZMZlXU4tzLrbvTii87Ni9opq60ds0YzuAlEr/GNwuNluZyMQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-ia32-msvc": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-ia32-msvc/-/rollup-win32-ia32-msvc-4.57.1.tgz",
      "integrity": "sha512-P3dLS+IerxCT/7D2q2FYcRdWRl22dNbrbBEtxdWhXrfIMPP9lQhb5h4Du04mdl5Woq05jVCDPCMF7Ub0NAjIew==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-x64-gnu": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-gnu/-/rollup-win32-x64-gnu-4.57.1.tgz",
      "integrity": "sha512-VMBH2eOOaKGtIJYleXsi2B8CPVADrh+TyNxJ4mWPnKfLB/DBUmzW+5m1xUrcwWoMfSLagIRpjUFeW5CO5hyciQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-x64-msvc": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-msvc/-/rollup-win32-x64-msvc-4.57.1.tgz",
      "integrity": "sha512-mxRFDdHIWRxg3UfIIAwCm6NzvxG0jDX/wBN6KsQFTvKFqqg9vTrWUE68qEjHt19A5wwx5X5aUi2zuZT7YR0jrA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@standard-schema/spec": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/@standard-schema/spec/-/spec-1.1.0.tgz",
      "integrity": "sha512-l2aFy5jALhniG5HgqrD6jXLi/rUWrKvqN/qJx6yoJsgKhblVd+iqqU4RCXavm/jPityDo5TCvKMnpjKnOriy0w==",
      "license": "MIT"
    },
    "node_modules/@standard-schema/utils": {
      "version": "0.3.0",
      "resolved": "https://registry.npmjs.org/@standard-schema/utils/-/utils-0.3.0.tgz",
      "integrity": "sha512-e7Mew686owMaPJVNNLs55PUvgz371nKgwsc4vxE49zsODpJEnxgxRo2y/OKrqueavXgZNMDVj3DdHFlaSAeU8g==",
      "license": "MIT"
    },
    "node_modules/@types/babel__core": {
      "version": "7.20.5",
      "resolved": "https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz",
      "integrity": "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.20.7",
        "@babel/types": "^7.20.7",
        "@types/babel__generator": "*",
        "@types/babel__template": "*",
        "@types/babel__traverse": "*"
      }
    },
    "node_modules/@types/babel__generator": {
      "version": "7.27.0",
      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.27.0.tgz",
      "integrity": "sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__template": {
      "version": "7.4.4",
      "resolved": "https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz",
      "integrity": "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.1.0",
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__traverse": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.28.0.tgz",
      "integrity": "sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.28.2"
      }
    },
    "node_modules/@types/d3-array": {
      "version": "3.2.2",
      "resolved": "https://registry.npmjs.org/@types/d3-array/-/d3-array-3.2.2.tgz",
      "integrity": "sha512-hOLWVbm7uRza0BYXpIIW5pxfrKe0W+D5lrFiAEYR+pb6w3N2SwSMaJbXdUfSEv+dT4MfHBLtn5js0LAWaO6otw==",
      "license": "MIT"
    },
    "node_modules/@types/d3-color": {
      "version": "3.1.3",
      "resolved": "https://registry.npmjs.org/@types/d3-color/-/d3-color-3.1.3.tgz",
      "integrity": "sha512-iO90scth9WAbmgv7ogoq57O9YpKmFBbmoEoCHDB2xMBY0+/KVrqAaCDyCE16dUspeOvIxFFRI+0sEtqDqy2b4A==",
      "license": "MIT"
    },
    "node_modules/@types/d3-ease": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@types/d3-ease/-/d3-ease-3.0.2.tgz",
      "integrity": "sha512-NcV1JjO5oDzoK26oMzbILE6HW7uVXOHLQvHshBUW4UMdZGfiY6v5BeQwh9a9tCzv+CeefZQHJt5SRgK154RtiA==",
      "license": "MIT"
    },
    "node_modules/@types/d3-interpolate": {
      "version": "3.0.4",
      "resolved": "https://registry.npmjs.org/@types/d3-interpolate/-/d3-interpolate-3.0.4.tgz",
      "integrity": "sha512-mgLPETlrpVV1YRJIglr4Ez47g7Yxjl1lj7YKsiMCb27VJH9W8NVM6Bb9d8kkpG/uAQS5AmbA48q2IAolKKo1MA==",
      "license": "MIT",
      "dependencies": {
        "@types/d3-color": "*"
      }
    },
    "node_modules/@types/d3-path": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/@types/d3-path/-/d3-path-3.1.1.tgz",
      "integrity": "sha512-VMZBYyQvbGmWyWVea0EHs/BwLgxc+MKi1zLDCONksozI4YJMcTt8ZEuIR4Sb1MMTE8MMW49v0IwI5+b7RmfWlg==",
      "license": "MIT"
    },
    "node_modules/@types/d3-scale": {
      "version": "4.0.9",
      "resolved": "https://registry.npmjs.org/@types/d3-scale/-/d3-scale-4.0.9.tgz",
      "integrity": "sha512-dLmtwB8zkAeO/juAMfnV+sItKjlsw2lKdZVVy6LRr0cBmegxSABiLEpGVmSJJ8O08i4+sGR6qQtb6WtuwJdvVw==",
      "license": "MIT",
      "dependencies": {
        "@types/d3-time": "*"
      }
    },
    "node_modules/@types/d3-shape": {
      "version": "3.1.8",
      "resolved": "https://registry.npmjs.org/@types/d3-shape/-/d3-shape-3.1.8.tgz",
      "integrity": "sha512-lae0iWfcDeR7qt7rA88BNiqdvPS5pFVPpo5OfjElwNaT2yyekbM0C9vK+yqBqEmHr6lDkRnYNoTBYlAgJa7a4w==",
      "license": "MIT",
      "dependencies": {
        "@types/d3-path": "*"
      }
    },
    "node_modules/@types/d3-time": {
      "version": "3.0.4",
      "resolved": "https://registry.npmjs.org/@types/d3-time/-/d3-time-3.0.4.tgz",
      "integrity": "sha512-yuzZug1nkAAaBlBBikKZTgzCeA+k1uy4ZFwWANOfKw5z5LRhV0gNA7gNkKm7HoK+HRN0wX3EkxGk0fpbWhmB7g==",
      "license": "MIT"
    },
    "node_modules/@types/d3-timer": {
      "version": "3.0.2",
      "resolved": "https://registry.npmjs.org/@types/d3-timer/-/d3-timer-3.0.2.tgz",
      "integrity": "sha512-Ps3T8E8dZDam6fUyNiMkekK3XUsaUEik+idO9/YjPtfj2qruF8tFBXS7XhtE4iIXBLxhmLjP3SXpLhVf21I9Lw==",
      "license": "MIT"
    },
    "node_modules/@types/estree": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
      "integrity": "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@types/use-sync-external-store": {
      "version": "0.0.6",
      "resolved": "https://registry.npmjs.org/@types/use-sync-external-store/-/use-sync-external-store-0.0.6.tgz",
      "integrity": "sha512-zFDAD+tlpf2r4asuHEj0XH6pY6i0g5NeAHPn+15wk3BV6JA69eERFXC1gyGThDkVa1zCyKr5jox1+2LbV/AMLg==",
      "license": "MIT"
    },
    "node_modules/@vitejs/plugin-react": {
      "version": "4.7.0",
      "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.7.0.tgz",
      "integrity": "sha512-gUu9hwfWvvEDBBmgtAowQCojwZmJ5mcLn3aufeCsitijs3+f2NsrPtlAWIR6OPiqljl96GVCUbLe0HyqIpVaoA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/core": "^7.28.0",
        "@babel/plugin-transform-react-jsx-self": "^7.27.1",
        "@babel/plugin-transform-react-jsx-source": "^7.27.1",
        "@rolldown/pluginutils": "1.0.0-beta.27",
        "@types/babel__core": "^7.20.5",
        "react-refresh": "^0.17.0"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "peerDependencies": {
        "vite": "^4.2.0 || ^5.0.0 || ^6.0.0 || ^7.0.0"
      }
    },
    "node_modules/baseline-browser-mapping": {
      "version": "2.10.0",
      "resolved": "https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.10.0.tgz",
      "integrity": "sha512-lIyg0szRfYbiy67j9KN8IyeD7q7hcmqnJ1ddWmNt19ItGpNN64mnllmxUNFIOdOm6by97jlL6wfpTTJrmnjWAA==",
      "dev": true,
      "license": "Apache-2.0",
      "bin": {
        "baseline-browser-mapping": "dist/cli.cjs"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/browserslist": {
      "version": "4.28.1",
      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.28.1.tgz",
      "integrity": "sha512-ZC5Bd0LgJXgwGqUknZY/vkUQ04r8NXnJZ3yYi4vDmSiZmC/pdSN0NbNRPxZpbtO4uAfDUAFffO8IZoM3Gj8IkA==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "baseline-browser-mapping": "^2.9.0",
        "caniuse-lite": "^1.0.30001759",
        "electron-to-chromium": "^1.5.263",
        "node-releases": "^2.0.27",
        "update-browserslist-db": "^1.2.0"
      },
      "bin": {
        "browserslist": "cli.js"
      },
      "engines": {
        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
      }
    },
    "node_modules/caniuse-lite": {
      "version": "1.0.30001770",
      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001770.tgz",
      "integrity": "sha512-x/2CLQ1jHENRbHg5PSId2sXq1CIO1CISvwWAj027ltMVG2UNgW+w9oH2+HzgEIRFembL8bUlXtfbBHR1fCg2xw==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "CC-BY-4.0"
    },
    "node_modules/clsx": {
      "version": "2.1.1",
      "resolved": "https://registry.npmjs.org/clsx/-/clsx-2.1.1.tgz",
      "integrity": "sha512-eYm0QWBtUrBWZWG0d386OGAw16Z995PiOVo2B7bjWSbHedGl5e0ZWaq65kOGgUSNesEIDkB9ISbTg/JK9dhCZA==",
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/convert-source-map": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/cookie": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/cookie/-/cookie-1.1.1.tgz",
      "integrity": "sha512-ei8Aos7ja0weRpFzJnEA9UHJ/7XQmqglbRwnf2ATjcB9Wq874VKH9kfjjirM6UhU2/E5fFYadylyhFldcqSidQ==",
      "license": "MIT",
      "engines": {
        "node": ">=18"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/express"
      }
    },
    "node_modules/d3-array": {
      "version": "3.2.4",
      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-3.2.4.tgz",
      "integrity": "sha512-tdQAmyA18i4J7wprpYq8ClcxZy3SC31QMeByyCFyRt7BVHdREQZ5lpzoe5mFEYZUWe+oq8HBvk9JjpibyEV4Jg==",
      "license": "ISC",
      "dependencies": {
        "internmap": "1 - 2"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-color": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-color/-/d3-color-3.1.0.tgz",
      "integrity": "sha512-zg/chbXyeBtMQ1LbD/WSoW2DpC3I0mpmPdW+ynRTj/x2DAWYrIY7qeZIHidozwV24m4iavr15lNwIwLxRmOxhA==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-ease": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-ease/-/d3-ease-3.0.1.tgz",
      "integrity": "sha512-wR/XK3D3XcLIZwpbvQwQ5fK+8Ykds1ip7A2Txe0yxncXSdq1L9skcG7blcedkOX+ZcgxGAmLX1FrRGbADwzi0w==",
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-format": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/d3-format/-/d3-format-3.1.2.tgz",
      "integrity": "sha512-AJDdYOdnyRDV5b6ArilzCPPwc1ejkHcoyFarqlPqT7zRYjhavcT3uSrqcMvsgh2CgoPbK3RCwyHaVyxYcP2Arg==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-interpolate": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-interpolate/-/d3-interpolate-3.0.1.tgz",
      "integrity": "sha512-3bYs1rOD33uo8aqJfKP3JWPAibgw8Zm2+L9vBKEHJ2Rg+viTR7o5Mmv5mZcieN+FRYaAOWX5SJATX6k1PWz72g==",
      "license": "ISC",
      "dependencies": {
        "d3-color": "1 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-path": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-3.1.0.tgz",
      "integrity": "sha512-p3KP5HCf/bvjBSSKuXid6Zqijx7wIfNW+J/maPs+iwR35at5JCbLUT0LzF1cnjbCHWhqzQTIN2Jpe8pRebIEFQ==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-scale": {
      "version": "4.0.2",
      "resolved": "https://registry.npmjs.org/d3-scale/-/d3-scale-4.0.2.tgz",
      "integrity": "sha512-GZW464g1SH7ag3Y7hXjf8RoUuAFIqklOAq3MRl4OaWabTFJY9PN/E1YklhXLh+OQ3fM9yS2nOkCoS+WLZ6kvxQ==",
      "license": "ISC",
      "dependencies": {
        "d3-array": "2.10.0 - 3",
        "d3-format": "1 - 3",
        "d3-interpolate": "1.2.0 - 3",
        "d3-time": "2.1.1 - 3",
        "d3-time-format": "2 - 4"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-shape": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-3.2.0.tgz",
      "integrity": "sha512-SaLBuwGm3MOViRq2ABk3eLoxwZELpH6zhl3FbAoJ7Vm1gofKx6El1Ib5z23NUEhF9AsGl7y+dzLe5Cw2AArGTA==",
      "license": "ISC",
      "dependencies": {
        "d3-path": "^3.1.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-time": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/d3-time/-/d3-time-3.1.0.tgz",
      "integrity": "sha512-VqKjzBLejbSMT4IgbmVgDjpkYrNWUYJnbCGo874u7MMKIWsILRX+OpX/gTk8MqjpT1A/c6HY2dCA77ZN0lkQ2Q==",
      "license": "ISC",
      "dependencies": {
        "d3-array": "2 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-time-format": {
      "version": "4.1.0",
      "resolved": "https://registry.npmjs.org/d3-time-format/-/d3-time-format-4.1.0.tgz",
      "integrity": "sha512-dJxPBlzC7NugB2PDLwo9Q8JiTR3M3e4/XANkreKSUxF8vvXKqm1Yfq4Q5dl8budlunRVlUUaDUgFt7eA8D6NLg==",
      "license": "ISC",
      "dependencies": {
        "d3-time": "1 - 3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/d3-timer": {
      "version": "3.0.1",
      "resolved": "https://registry.npmjs.org/d3-timer/-/d3-timer-3.0.1.tgz",
      "integrity": "sha512-ndfJ/JxxMd3nw31uyKoY2naivF+r29V+Lc0svZxe1JvvIRmi8hUsrMvdOwgS1o6uBHmiz91geQ0ylPP0aj1VUA==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/decimal.js-light": {
      "version": "2.5.1",
      "resolved": "https://registry.npmjs.org/decimal.js-light/-/decimal.js-light-2.5.1.tgz",
      "integrity": "sha512-qIMFpTMZmny+MMIitAB6D7iVPEorVw6YQRWkvarTkT4tBeSLLiHzcwj6q0MmYSFCiVpiqPJTJEYIrpcPzVEIvg==",
      "license": "MIT"
    },
    "node_modules/electron-to-chromium": {
      "version": "1.5.286",
      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.286.tgz",
      "integrity": "sha512-9tfDXhJ4RKFNerfjdCcZfufu49vg620741MNs26a9+bhLThdB+plgMeou98CAaHu/WATj2iHOOHTp1hWtABj2A==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/es-toolkit": {
      "version": "1.44.0",
      "resolved": "https://registry.npmjs.org/es-toolkit/-/es-toolkit-1.44.0.tgz",
      "integrity": "sha512-6penXeZalaV88MM3cGkFZZfOoLGWshWWfdy0tWw/RlVVyhvMaWSBTOvXNeiW3e5FwdS5ePW0LGEu17zT139ktg==",
      "license": "MIT",
      "workspaces": [
        "docs",
        "benchmarks"
      ]
    },
    "node_modules/esbuild": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.21.5.tgz",
      "integrity": "sha512-mg3OPMV4hXywwpoDxu3Qda5xCKQi+vCTZq8S9J/EpkhB2HzKXq4SNFZE3+NK93JYxc8VMSep+lOUSC/RVKaBqw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=12"
      },
      "optionalDependencies": {
        "@esbuild/aix-ppc64": "0.21.5",
        "@esbuild/android-arm": "0.21.5",
        "@esbuild/android-arm64": "0.21.5",
        "@esbuild/android-x64": "0.21.5",
        "@esbuild/darwin-arm64": "0.21.5",
        "@esbuild/darwin-x64": "0.21.5",
        "@esbuild/freebsd-arm64": "0.21.5",
        "@esbuild/freebsd-x64": "0.21.5",
        "@esbuild/linux-arm": "0.21.5",
        "@esbuild/linux-arm64": "0.21.5",
        "@esbuild/linux-ia32": "0.21.5",
        "@esbuild/linux-loong64": "0.21.5",
        "@esbuild/linux-mips64el": "0.21.5",
        "@esbuild/linux-ppc64": "0.21.5",
        "@esbuild/linux-riscv64": "0.21.5",
        "@esbuild/linux-s390x": "0.21.5",
        "@esbuild/linux-x64": "0.21.5",
        "@esbuild/netbsd-x64": "0.21.5",
        "@esbuild/openbsd-x64": "0.21.5",
        "@esbuild/sunos-x64": "0.21.5",
        "@esbuild/win32-arm64": "0.21.5",
        "@esbuild/win32-ia32": "0.21.5",
        "@esbuild/win32-x64": "0.21.5"
      }
    },
    "node_modules/escalade": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/eventemitter3": {
      "version": "5.0.4",
      "resolved": "https://registry.npmjs.org/eventemitter3/-/eventemitter3-5.0.4.tgz",
      "integrity": "sha512-mlsTRyGaPBjPedk6Bvw+aqbsXDtoAyAzm5MO7JgU+yVRyMQ5O8bD4Kcci7BS85f93veegeCPkL8R4GLClnjLFw==",
      "license": "MIT"
    },
    "node_modules/fsevents": {
      "version": "2.3.3",
      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
      }
    },
    "node_modules/gensync": {
      "version": "1.0.0-beta.2",
      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/immer": {
      "version": "10.2.0",
      "resolved": "https://registry.npmjs.org/immer/-/immer-10.2.0.tgz",
      "integrity": "sha512-d/+XTN3zfODyjr89gM3mPq1WNX2B8pYsu7eORitdwyA2sBubnTl3laYlBk4sXY5FUa5qTZGBDPJICVbvqzjlbw==",
      "license": "MIT",
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/immer"
      }
    },
    "node_modules/internmap": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/internmap/-/internmap-2.0.3.tgz",
      "integrity": "sha512-5Hh7Y1wQbvY5ooGgPbDaL5iYLAPzMTUrjMulskHLH6wnv/A+1q5rgEaiuqEjB+oxGXIVZs1FF+R/KPN3ZSQYYg==",
      "license": "ISC",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/js-tokens": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
      "license": "MIT"
    },
    "node_modules/jsesc": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "jsesc": "bin/jsesc"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/json5": {
      "version": "2.2.3",
      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "json5": "lib/cli.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/loose-envify": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
      "license": "MIT",
      "dependencies": {
        "js-tokens": "^3.0.0 || ^4.0.0"
      },
      "bin": {
        "loose-envify": "cli.js"
      }
    },
    "node_modules/lru-cache": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "yallist": "^3.0.2"
      }
    },
    "node_modules/lucide-react": {
      "version": "0.294.0",
      "resolved": "https://registry.npmjs.org/lucide-react/-/lucide-react-0.294.0.tgz",
      "integrity": "sha512-V7o0/VECSGbLHn3/1O67FUgBwWB+hmzshrgDVRJQhMh8uj5D3HBuIvhuAmQTtlupILSplwIZg5FTc4tTKMA2SA==",
      "license": "ISC",
      "peerDependencies": {
        "react": "^16.5.1 || ^17.0.0 || ^18.0.0"
      }
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/nanoid": {
      "version": "3.3.11",
      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "bin": {
        "nanoid": "bin/nanoid.cjs"
      },
      "engines": {
        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
      }
    },
    "node_modules/node-releases": {
      "version": "2.0.27",
      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.27.tgz",
      "integrity": "sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/picocolors": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/postcss": {
      "version": "8.5.6",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
      "integrity": "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "nanoid": "^3.3.11",
        "picocolors": "^1.1.1",
        "source-map-js": "^1.2.1"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/react": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
      "integrity": "sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-dom": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
      "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0",
        "scheduler": "^0.23.2"
      },
      "peerDependencies": {
        "react": "^18.3.1"
      }
    },
    "node_modules/react-is": {
      "version": "19.2.4",
      "resolved": "https://registry.npmjs.org/react-is/-/react-is-19.2.4.tgz",
      "integrity": "sha512-W+EWGn2v0ApPKgKKCy/7s7WHXkboGcsrXE+2joLyVxkbyVQfO3MUEaUQDHoSmb8TFFrSKYa9mw64WZHNHSDzYA==",
      "license": "MIT",
      "peer": true
    },
    "node_modules/react-redux": {
      "version": "9.2.0",
      "resolved": "https://registry.npmjs.org/react-redux/-/react-redux-9.2.0.tgz",
      "integrity": "sha512-ROY9fvHhwOD9ySfrF0wmvu//bKCQ6AeZZq1nJNtbDC+kk5DuSuNX/n6YWYF/SYy7bSba4D4FSz8DJeKY/S/r+g==",
      "license": "MIT",
      "dependencies": {
        "@types/use-sync-external-store": "^0.0.6",
        "use-sync-external-store": "^1.4.0"
      },
      "peerDependencies": {
        "@types/react": "^18.2.25 || ^19",
        "react": "^18.0 || ^19",
        "redux": "^5.0.0"
      },
      "peerDependenciesMeta": {
        "@types/react": {
          "optional": true
        },
        "redux": {
          "optional": true
        }
      }
    },
    "node_modules/react-refresh": {
      "version": "0.17.0",
      "resolved": "https://registry.npmjs.org/react-refresh/-/react-refresh-0.17.0.tgz",
      "integrity": "sha512-z6F7K9bV85EfseRCp2bzrpyQ0Gkw1uLoCel9XBVWPg/TjRj94SkJzUTGfOa4bs7iJvBWtQG0Wq7wnI0syw3EBQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-router": {
      "version": "7.13.0",
      "resolved": "https://registry.npmjs.org/react-router/-/react-router-7.13.0.tgz",
      "integrity": "sha512-PZgus8ETambRT17BUm/LL8lX3Of+oiLaPuVTRH3l1eLvSPpKO3AvhAEb5N7ihAFZQrYDqkvvWfFh9p0z9VsjLw==",
      "license": "MIT",
      "dependencies": {
        "cookie": "^1.0.1",
        "set-cookie-parser": "^2.6.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "react": ">=18",
        "react-dom": ">=18"
      },
      "peerDependenciesMeta": {
        "react-dom": {
          "optional": true
        }
      }
    },
    "node_modules/react-router-dom": {
      "version": "7.13.0",
      "resolved": "https://registry.npmjs.org/react-router-dom/-/react-router-dom-7.13.0.tgz",
      "integrity": "sha512-5CO/l5Yahi2SKC6rGZ+HDEjpjkGaG/ncEP7eWFTvFxbHP8yeeI0PxTDjimtpXYlR3b3i9/WIL4VJttPrESIf2g==",
      "license": "MIT",
      "dependencies": {
        "react-router": "7.13.0"
      },
      "engines": {
        "node": ">=20.0.0"
      },
      "peerDependencies": {
        "react": ">=18",
        "react-dom": ">=18"
      }
    },
    "node_modules/recharts": {
      "version": "3.7.0",
      "resolved": "https://registry.npmjs.org/recharts/-/recharts-3.7.0.tgz",
      "integrity": "sha512-l2VCsy3XXeraxIID9fx23eCb6iCBsxUQDnE8tWm6DFdszVAO7WVY/ChAD9wVit01y6B2PMupYiMmQwhgPHc9Ew==",
      "license": "MIT",
      "workspaces": [
        "www"
      ],
      "dependencies": {
        "@reduxjs/toolkit": "1.x.x || 2.x.x",
        "clsx": "^2.1.1",
        "decimal.js-light": "^2.5.1",
        "es-toolkit": "^1.39.3",
        "eventemitter3": "^5.0.1",
        "immer": "^10.1.1",
        "react-redux": "8.x.x || 9.x.x",
        "reselect": "5.1.1",
        "tiny-invariant": "^1.3.3",
        "use-sync-external-store": "^1.2.2",
        "victory-vendor": "^37.0.2"
      },
      "engines": {
        "node": ">=18"
      },
      "peerDependencies": {
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0",
        "react-dom": "^16.0.0 || ^17.0.0 || ^18.0.0 || ^19.0.0",
        "react-is": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0"
      }
    },
    "node_modules/redux": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/redux/-/redux-5.0.1.tgz",
      "integrity": "sha512-M9/ELqF6fy8FwmkpnF0S3YKOqMyoWJ4+CS5Efg2ct3oY9daQvd/Pc71FpGZsVsbl3Cpb+IIcjBDUnnyBdQbq4w==",
      "license": "MIT"
    },
    "node_modules/redux-thunk": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/redux-thunk/-/redux-thunk-3.1.0.tgz",
      "integrity": "sha512-NW2r5T6ksUKXCabzhL9z+h206HQw/NJkcLm1GPImRQ8IzfXwRGqjVhKJGauHirT0DAuyy6hjdnMZaRoAcy0Klw==",
      "license": "MIT",
      "peerDependencies": {
        "redux": "^5.0.0"
      }
    },
    "node_modules/reselect": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/reselect/-/reselect-5.1.1.tgz",
      "integrity": "sha512-K/BG6eIky/SBpzfHZv/dd+9JBFiS4SWV7FIujVyJRux6e45+73RaUHXLmIR1f7WOMaQ0U1km6qwklRQxpJJY0w==",
      "license": "MIT"
    },
    "node_modules/rollup": {
      "version": "4.57.1",
      "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.57.1.tgz",
      "integrity": "sha512-oQL6lgK3e2QZeQ7gcgIkS2YZPg5slw37hYufJ3edKlfQSGGm8ICoxswK15ntSzF/a8+h7ekRy7k7oWc3BQ7y8A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/estree": "1.0.8"
      },
      "bin": {
        "rollup": "dist/bin/rollup"
      },
      "engines": {
        "node": ">=18.0.0",
        "npm": ">=8.0.0"
      },
      "optionalDependencies": {
        "@rollup/rollup-android-arm-eabi": "4.57.1",
        "@rollup/rollup-android-arm64": "4.57.1",
        "@rollup/rollup-darwin-arm64": "4.57.1",
        "@rollup/rollup-darwin-x64": "4.57.1",
        "@rollup/rollup-freebsd-arm64": "4.57.1",
        "@rollup/rollup-freebsd-x64": "4.57.1",
        "@rollup/rollup-linux-arm-gnueabihf": "4.57.1",
        "@rollup/rollup-linux-arm-musleabihf": "4.57.1",
        "@rollup/rollup-linux-arm64-gnu": "4.57.1",
        "@rollup/rollup-linux-arm64-musl": "4.57.1",
        "@rollup/rollup-linux-loong64-gnu": "4.57.1",
        "@rollup/rollup-linux-loong64-musl": "4.57.1",
        "@rollup/rollup-linux-ppc64-gnu": "4.57.1",
        "@rollup/rollup-linux-ppc64-musl": "4.57.1",
        "@rollup/rollup-linux-riscv64-gnu": "4.57.1",
        "@rollup/rollup-linux-riscv64-musl": "4.57.1",
        "@rollup/rollup-linux-s390x-gnu": "4.57.1",
        "@rollup/rollup-linux-x64-gnu": "4.57.1",
        "@rollup/rollup-linux-x64-musl": "4.57.1",
        "@rollup/rollup-openbsd-x64": "4.57.1",
        "@rollup/rollup-openharmony-arm64": "4.57.1",
        "@rollup/rollup-win32-arm64-msvc": "4.57.1",
        "@rollup/rollup-win32-ia32-msvc": "4.57.1",
        "@rollup/rollup-win32-x64-gnu": "4.57.1",
        "@rollup/rollup-win32-x64-msvc": "4.57.1",
        "fsevents": "~2.3.2"
      }
    },
    "node_modules/scheduler": {
      "version": "0.23.2",
      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
      "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0"
      }
    },
    "node_modules/semver": {
      "version": "6.3.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
      "dev": true,
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      }
    },
    "node_modules/set-cookie-parser": {
      "version": "2.7.2",
      "resolved": "https://registry.npmjs.org/set-cookie-parser/-/set-cookie-parser-2.7.2.tgz",
      "integrity": "sha512-oeM1lpU/UvhTxw+g3cIfxXHyJRc/uidd3yK1P242gzHds0udQBYzs3y8j4gCCW+ZJ7ad0yctld8RYO+bdurlvw==",
      "license": "MIT"
    },
    "node_modules/source-map-js": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
      "dev": true,
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/tiny-invariant": {
      "version": "1.3.3",
      "resolved": "https://registry.npmjs.org/tiny-invariant/-/tiny-invariant-1.3.3.tgz",
      "integrity": "sha512-+FbBPE1o9QAYvviau/qC5SE3caw21q3xkvWKBtja5vgqOWIHHJ3ioaq1VPfn/Szqctz2bU/oYeKd9/z5BL+PVg==",
      "license": "MIT"
    },
    "node_modules/update-browserslist-db": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz",
      "integrity": "sha512-Js0m9cx+qOgDxo0eMiFGEueWztz+d4+M3rGlmKPT+T4IS/jP4ylw3Nwpu6cpTTP8R1MAC1kF4VbdLt3ARf209w==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "escalade": "^3.2.0",
        "picocolors": "^1.1.1"
      },
      "bin": {
        "update-browserslist-db": "cli.js"
      },
      "peerDependencies": {
        "browserslist": ">= 4.21.0"
      }
    },
    "node_modules/use-sync-external-store": {
      "version": "1.6.0",
      "resolved": "https://registry.npmjs.org/use-sync-external-store/-/use-sync-external-store-1.6.0.tgz",
      "integrity": "sha512-Pp6GSwGP/NrPIrxVFAIkOQeyw8lFenOHijQWkUTrDvrF4ALqylP2C/KCkeS9dpUM3KvYRQhna5vt7IL95+ZQ9w==",
      "license": "MIT",
      "peerDependencies": {
        "react": "^16.8.0 || ^17.0.0 || ^18.0.0 || ^19.0.0"
      }
    },
    "node_modules/victory-vendor": {
      "version": "37.3.6",
      "resolved": "https://registry.npmjs.org/victory-vendor/-/victory-vendor-37.3.6.tgz",
      "integrity": "sha512-SbPDPdDBYp+5MJHhBCAyI7wKM3d5ivekigc2Dk2s7pgbZ9wIgIBYGVw4zGHBml/qTFbexrofXW6Gu4noGxrOwQ==",
      "license": "MIT AND ISC",
      "dependencies": {
        "@types/d3-array": "^3.0.3",
        "@types/d3-ease": "^3.0.0",
        "@types/d3-interpolate": "^3.0.1",
        "@types/d3-scale": "^4.0.2",
        "@types/d3-shape": "^3.1.0",
        "@types/d3-time": "^3.0.0",
        "@types/d3-timer": "^3.0.0",
        "d3-array": "^3.1.6",
        "d3-ease": "^3.0.1",
        "d3-interpolate": "^3.0.1",
        "d3-scale": "^4.0.2",
        "d3-shape": "^3.1.0",
        "d3-time": "^3.0.0",
        "d3-timer": "^3.0.1"
      }
    },
    "node_modules/vite": {
      "version": "5.4.21",
      "resolved": "https://registry.npmjs.org/vite/-/vite-5.4.21.tgz",
      "integrity": "sha512-o5a9xKjbtuhY6Bi5S3+HvbRERmouabWbyUcpXXUA1u+GNUKoROi9byOJ8M0nHbHYHkYICiMlqxkg1KkYmm25Sw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "esbuild": "^0.21.3",
        "postcss": "^8.4.43",
        "rollup": "^4.20.0"
      },
      "bin": {
        "vite": "bin/vite.js"
      },
      "engines": {
        "node": "^18.0.0 || >=20.0.0"
      },
      "funding": {
        "url": "https://github.com/vitejs/vite?sponsor=1"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.3"
      },
      "peerDependencies": {
        "@types/node": "^18.0.0 || >=20.0.0",
        "less": "*",
        "lightningcss": "^1.21.0",
        "sass": "*",
        "sass-embedded": "*",
        "stylus": "*",
        "sugarss": "*",
        "terser": "^5.4.0"
      },
      "peerDependenciesMeta": {
        "@types/node": {
          "optional": true
        },
        "less": {
          "optional": true
        },
        "lightningcss": {
          "optional": true
        },
        "sass": {
          "optional": true
        },
        "sass-embedded": {
          "optional": true
        },
        "stylus": {
          "optional": true
        },
        "sugarss": {
          "optional": true
        },
        "terser": {
          "optional": true
        }
      }
    },
    "node_modules/yallist": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
      "dev": true,
      "license": "ISC"
    }
  }
}

--- END OF FILE ---

--- FILE: .env.example ---
# Amazon Listing Image Generator - Frontend Environment
# Copy this file to .env and fill in your values
#
# NOTE: API keys are now managed on the BACKEND only.
# The frontend no longer needs AI provider keys.
# See backend/.env.example for API key configuration.

# ============================================
# GOOGLE CALENDAR INTEGRATION (optional)
# ============================================
# For Clockwise-style focus time blocking during sessions

# Get credentials from: https://console.cloud.google.com/apis/credentials
# 1. Create a project in Google Cloud Console
# 2. Enable Google Calendar API
# 3. Create OAuth 2.0 credentials (Web application)
# 4. Add http://localhost:3000 to authorized JavaScript origins

VITE_GOOGLE_CLIENT_ID=your_google_client_id.apps.googleusercontent.com
VITE_GOOGLE_API_KEY=your_google_api_key

--- END OF FILE ---

--- FILE: frontend/next.config.js ---
/** @type {import('next').NextConfig} */
const nextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: "http",
        hostname: "localhost",
        port: "8000",
        pathname: "/images/**",
      },
    ],
  },
};

module.exports = nextConfig;

--- END OF FILE ---

--- FILE: frontend/tailwind.config.ts ---
import type { Config } from "tailwindcss";

const config: Config = {
  content: [
    "./src/pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/components/**/*.{js,ts,jsx,tsx,mdx}",
    "./src/app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          50: "#f0f9ff",
          100: "#e0f2fe",
          200: "#bae6fd",
          300: "#7dd3fc",
          400: "#38bdf8",
          500: "#0ea5e9",
          600: "#0284c7",
          700: "#0369a1",
          800: "#075985",
          900: "#0c4a6e",
        },
      },
    },
  },
  plugins: [],
};

export default config;

--- END OF FILE ---

--- FILE: frontend/package.json ---
{
  "name": "imagegen-frontend",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  },
  "dependencies": {
    "next": "14.1.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "lucide-react": "^0.312.0"
  },
  "devDependencies": {
    "@types/node": "^20.11.0",
    "@types/react": "^18.2.48",
    "@types/react-dom": "^18.2.18",
    "autoprefixer": "^10.4.17",
    "postcss": "^8.4.33",
    "tailwindcss": "^3.4.1",
    "typescript": "^5.3.3"
  }
}

--- END OF FILE ---

--- FILE: frontend/tsconfig.json ---
{
  "compilerOptions": {
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}

--- END OF FILE ---

--- FILE: frontend/.env.example ---
# Backend API URL
NEXT_PUBLIC_API_URL=http://localhost:8000

--- END OF FILE ---

--- FILE: frontend/postcss.config.js ---
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};

--- END OF FILE ---

--- FILE: frontend/src/app/layout.tsx ---
import type { Metadata } from "next";
import "./globals.css";

export const metadata: Metadata = {
  title: "ImageGen - Create Beautiful Images with AI",
  description: "Simple AI image generation for everyone. No design skills required.",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body className="bg-gray-50 min-h-screen">{children}</body>
    </html>
  );
}

--- END OF FILE ---

--- FILE: frontend/src/app/page.tsx ---
"use client";

import { useState } from "react";
import { PromptInput } from "@/components/PromptInput";
import { StyleSelector } from "@/components/StyleSelector";
import { ImageDisplay } from "@/components/ImageDisplay";
import { Gallery } from "@/components/Gallery";
import { api } from "@/lib/api";

export default function Home() {
  const [prompt, setPrompt] = useState("");
  const [style, setStyle] = useState<string | null>(null);
  const [aspectRatio, setAspectRatio] = useState("1:1");
  const [isGenerating, setIsGenerating] = useState(false);
  const [currentImage, setCurrentImage] = useState<string | null>(null);
  const [error, setError] = useState<string | null>(null);

  const handleGenerate = async () => {
    if (!prompt.trim()) return;

    setIsGenerating(true);
    setError(null);

    try {
      const result = await api.generateImage(prompt, style, aspectRatio);
      setCurrentImage(result.image_url);
    } catch (err) {
      setError(err instanceof Error ? err.message : "Failed to generate image");
    } finally {
      setIsGenerating(false);
    }
  };

  return (
    <main className="min-h-screen">
      {/* Header */}
      <header className="gradient-bg text-white py-8">
        <div className="max-w-4xl mx-auto px-4 text-center">
          <h1 className="text-4xl font-bold mb-2">ImageGen</h1>
          <p className="text-lg opacity-90">
            Create beautiful images with AI. No design skills needed.
          </p>
        </div>
      </header>

      {/* Main Content */}
      <div className="max-w-4xl mx-auto px-4 py-8">
        {/* Prompt Input */}
        <div className="bg-white rounded-xl shadow-lg p-6 mb-8">
          <PromptInput
            value={prompt}
            onChange={setPrompt}
            onGenerate={handleGenerate}
            isGenerating={isGenerating}
          />

          {/* Style Selector */}
          <StyleSelector
            selected={style}
            onSelect={setStyle}
          />

          {/* Aspect Ratio */}
          <div className="mt-4">
            <label className="block text-sm font-medium text-gray-700 mb-2">
              Aspect Ratio
            </label>
            <div className="flex gap-2">
              {["1:1", "16:9", "9:16"].map((ratio) => (
                <button
                  key={ratio}
                  onClick={() => setAspectRatio(ratio)}
                  className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${
                    aspectRatio === ratio
                      ? "bg-primary-500 text-white"
                      : "bg-gray-100 text-gray-700 hover:bg-gray-200"
                  }`}
                >
                  {ratio}
                </button>
              ))}
            </div>
          </div>
        </div>

        {/* Error Display */}
        {error && (
          <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-8">
            {error}
          </div>
        )}

        {/* Generated Image */}
        <ImageDisplay
          imageUrl={currentImage}
          isGenerating={isGenerating}
          prompt={prompt}
        />

        {/* Gallery */}
        <div className="mt-12">
          <h2 className="text-2xl font-bold text-gray-800 mb-4">Your Creations</h2>
          <Gallery onSelect={(url) => setCurrentImage(url)} />
        </div>
      </div>
    </main>
  );
}

--- END OF FILE ---

--- FILE: frontend/src/app/globals.css ---
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

.gradient-bg {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

--- END OF FILE ---

--- FILE: frontend/src/components/Gallery.tsx ---
"use client";

import { useState, useEffect } from "react";
import { Trash2 } from "lucide-react";
import { api } from "@/lib/api";

interface Image {
  id: string;
  prompt: string;
  created_at: string;
}

interface GalleryProps {
  onSelect: (url: string) => void;
}

export function Gallery({ onSelect }: GalleryProps) {
  const [images, setImages] = useState<Image[]>([]);
  const [loading, setLoading] = useState(true);

  const fetchImages = async () => {
    try {
      const data = await api.getImages();
      setImages(data.images || []);
    } catch (error) {
      console.error("Failed to fetch images:", error);
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchImages();
    // Refresh gallery periodically
    const interval = setInterval(fetchImages, 10000);
    return () => clearInterval(interval);
  }, []);

  const handleDelete = async (imageId: string, e: React.MouseEvent) => {
    e.stopPropagation();
    try {
      await api.deleteImage(imageId);
      setImages(images.filter((img) => img.id !== imageId));
    } catch (error) {
      console.error("Failed to delete image:", error);
    }
  };

  if (loading) {
    return (
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        {[...Array(4)].map((_, i) => (
          <div
            key={i}
            className="aspect-square bg-gray-200 rounded-lg animate-pulse"
          />
        ))}
      </div>
    );
  }

  if (images.length === 0) {
    return (
      <div className="text-center py-12 text-gray-400">
        <p>No images yet. Generate your first one above!</p>
      </div>
    );
  }

  return (
    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
      {images.map((image) => (
        <div
          key={image.id}
          className="group relative aspect-square bg-gray-100 rounded-lg overflow-hidden cursor-pointer hover:ring-2 hover:ring-primary-500 transition-all"
          onClick={() => onSelect(`/images/${image.id}.png`)}
        >
          <img
            src={api.getImageUrl(`/images/${image.id}.png`)}
            alt={image.prompt}
            className="w-full h-full object-cover"
          />
          <div className="absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors">
            <button
              onClick={(e) => handleDelete(image.id, e)}
              className="absolute top-2 right-2 p-2 bg-red-500 text-white rounded-lg opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600"
            >
              <Trash2 className="w-4 h-4" />
            </button>
          </div>
          <div className="absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity">
            <p className="text-white text-xs truncate">{image.prompt}</p>
          </div>
        </div>
      ))}
    </div>
  );
}

--- END OF FILE ---

--- FILE: frontend/src/components/ImageDisplay.tsx ---
"use client";

import { Download, Loader2 } from "lucide-react";
import { api } from "@/lib/api";

interface ImageDisplayProps {
  imageUrl: string | null;
  isGenerating: boolean;
  prompt: string;
}

export function ImageDisplay({
  imageUrl,
  isGenerating,
  prompt,
}: ImageDisplayProps) {
  const handleDownload = async () => {
    if (!imageUrl) return;

    const fullUrl = api.getImageUrl(imageUrl);
    const response = await fetch(fullUrl);
    const blob = await response.blob();

    const url = window.URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = `imagegen-${Date.now()}.png`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
  };

  if (isGenerating) {
    return (
      <div className="bg-white rounded-xl shadow-lg p-8">
        <div className="aspect-square max-w-md mx-auto bg-gray-100 rounded-lg flex items-center justify-center">
          <div className="text-center">
            <Loader2 className="w-12 h-12 animate-spin text-primary-500 mx-auto mb-4" />
            <p className="text-gray-600">Creating your image...</p>
            <p className="text-sm text-gray-400 mt-2">This may take a moment</p>
          </div>
        </div>
      </div>
    );
  }

  if (!imageUrl) {
    return (
      <div className="bg-white rounded-xl shadow-lg p-8">
        <div className="aspect-square max-w-md mx-auto bg-gray-100 rounded-lg flex items-center justify-center">
          <div className="text-center text-gray-400">
            <p className="text-lg">Your image will appear here</p>
            <p className="text-sm mt-2">Enter a prompt and click Generate</p>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="bg-white rounded-xl shadow-lg p-8">
      <div className="max-w-md mx-auto">
        <img
          src={api.getImageUrl(imageUrl)}
          alt={prompt}
          className="w-full rounded-lg shadow-md"
        />
        <div className="mt-4 flex justify-between items-center">
          <p className="text-sm text-gray-500 truncate flex-1 mr-4">{prompt}</p>
          <button
            onClick={handleDownload}
            className="flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700 transition-colors"
          >
            <Download className="w-4 h-4" />
            Download
          </button>
        </div>
      </div>
    </div>
  );
}

--- END OF FILE ---

--- FILE: frontend/src/components/PromptInput.tsx ---
"use client";

import { Sparkles, Loader2 } from "lucide-react";

interface PromptInputProps {
  value: string;
  onChange: (value: string) => void;
  onGenerate: () => void;
  isGenerating: boolean;
}

const QUICK_PROMPTS = [
  "A cozy coffee shop on a rainy day",
  "A magical forest with glowing butterflies",
  "A futuristic city at sunset",
  "A cute cat wearing a tiny hat",
];

export function PromptInput({
  value,
  onChange,
  onGenerate,
  isGenerating,
}: PromptInputProps) {
  return (
    <div>
      <label className="block text-sm font-medium text-gray-700 mb-2">
        Describe your image
      </label>
      <div className="flex gap-3">
        <textarea
          value={value}
          onChange={(e) => onChange(e.target.value)}
          placeholder="A peaceful mountain lake at sunset with snow-capped peaks..."
          className="flex-1 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none"
          rows={3}
          disabled={isGenerating}
        />
        <button
          onClick={onGenerate}
          disabled={isGenerating || !value.trim()}
          className="px-6 py-4 bg-primary-500 text-white rounded-lg font-medium hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2"
        >
          {isGenerating ? (
            <>
              <Loader2 className="w-5 h-5 animate-spin" />
              Creating...
            </>
          ) : (
            <>
              <Sparkles className="w-5 h-5" />
              Generate
            </>
          )}
        </button>
      </div>

      {/* Quick prompts for beginners */}
      <div className="mt-4">
        <p className="text-sm text-gray-500 mb-2">Try one of these:</p>
        <div className="flex flex-wrap gap-2">
          {QUICK_PROMPTS.map((prompt) => (
            <button
              key={prompt}
              onClick={() => onChange(prompt)}
              className="px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-full text-gray-700 transition-colors"
            >
              {prompt}
            </button>
          ))}
        </div>
      </div>
    </div>
  );
}

--- END OF FILE ---

--- FILE: frontend/src/components/StyleSelector.tsx ---
"use client";

interface StyleSelectorProps {
  selected: string | null;
  onSelect: (style: string | null) => void;
}

const STYLES = [
  { id: "photorealistic", name: "Photorealistic", emoji: "📷" },
  { id: "anime", name: "Anime", emoji: "🎨" },
  { id: "watercolor", name: "Watercolor", emoji: "🖌️" },
  { id: "digital_art", name: "Digital Art", emoji: "💻" },
  { id: "oil_painting", name: "Oil Painting", emoji: "🎭" },
  { id: "3d_render", name: "3D Render", emoji: "🔮" },
  { id: "sketch", name: "Sketch", emoji: "✏️" },
  { id: "fantasy", name: "Fantasy", emoji: "✨" },
];

export function StyleSelector({ selected, onSelect }: StyleSelectorProps) {
  return (
    <div className="mt-6">
      <label className="block text-sm font-medium text-gray-700 mb-2">
        Style (optional)
      </label>
      <div className="flex flex-wrap gap-2">
        <button
          onClick={() => onSelect(null)}
          className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${
            selected === null
              ? "bg-gray-800 text-white"
              : "bg-gray-100 text-gray-700 hover:bg-gray-200"
          }`}
        >
          None
        </button>
        {STYLES.map((style) => (
          <button
            key={style.id}
            onClick={() => onSelect(style.id)}
            className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1 ${
              selected === style.id
                ? "bg-primary-500 text-white"
                : "bg-gray-100 text-gray-700 hover:bg-gray-200"
            }`}
          >
            <span>{style.emoji}</span>
            <span>{style.name}</span>
          </button>
        ))}
      </div>
    </div>
  );
}

--- END OF FILE ---

--- FILE: frontend/src/lib/api.ts ---
const API_URL = process.env.NEXT_PUBLIC_API_URL || "http://localhost:8000";

export const api = {
  async generateImage(
    prompt: string,
    style: string | null,
    aspectRatio: string
  ) {
    const response = await fetch(`${API_URL}/api/generate/`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        prompt,
        style,
        aspect_ratio: aspectRatio,
      }),
    });

    if (!response.ok) {
      throw new Error("Failed to generate image");
    }

    return response.json();
  },

  async getImages(limit = 20, offset = 0) {
    const response = await fetch(
      `${API_URL}/api/images/?limit=${limit}&offset=${offset}`
    );

    if (!response.ok) {
      throw new Error("Failed to fetch images");
    }

    return response.json();
  },

  async getStyles() {
    const response = await fetch(`${API_URL}/api/prompts/styles`);

    if (!response.ok) {
      throw new Error("Failed to fetch styles");
    }

    return response.json();
  },

  async getSuggestions() {
    const response = await fetch(`${API_URL}/api/prompts/suggestions`);

    if (!response.ok) {
      throw new Error("Failed to fetch suggestions");
    }

    return response.json();
  },

  async deleteImage(imageId: string) {
    const response = await fetch(`${API_URL}/api/images/${imageId}`, {
      method: "DELETE",
    });

    if (!response.ok) {
      throw new Error("Failed to delete image");
    }

    return response.json();
  },

  getImageUrl(path: string) {
    return `${API_URL}${path}`;
  },
};

--- END OF FILE ---

--- FILE: .claude/settings.local.json ---
{
  "permissions": {
    "allow": [
      "Bash(test:*)",
      "Bash(source:*)",
      "Bash(pip install:*)",
      "Bash(uvicorn:*)",
      "Bash(curl:*)",
      "Bash(npm run dev:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwiZW1haWwiOiJ0ZXN0QHRlc3QuY29tIiwiZXhwIjoxNzcxNjAzNDE5fQ.xKlvhwoqf3_7LPgLE4-8mNx9qMSuiqXI4BoJM1CvwRw\")",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp/image-gen-mvp log --oneline -10)",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp/image-gen-mvp remote -v)",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp log --oneline -10)",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp remote -v)",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp branch -a)",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp/image-gen-mvp branch -a)",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp/image-gen-mvp status)",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp status)",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp log --all --oneline)",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp show 8093eb4 --stat)",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp/image-gen-mvp diff --cached --stat)",
      "Bash(git -C /Users/yanchenchiang/Documents/GitHub/image-gen-mvp show main:frontend/src/components/AuthModal.tsx)",
      "Bash(ls:*)",
      "Bash(/Users/yanchenchiang/Documents/GitHub/image-gen-mvp/backend/venv/bin/python:*)",
      "Bash(/Users/yanchenchiang/Documents/GitHub/image-gen-mvp/backend/venv/bin/pip list:*)",
      "Bash(node_modules/.bin/vite:*)",
      "Bash(npm install:*)",
      "Bash(chmod:*)",
      "Bash(xattr:*)",
      "Bash(kill:*)",
      "Bash(venv/bin/python:*)",
      "Bash(lsof:*)",
      "Bash(python3:*)",
      "Bash(arch -arm64 venv/bin/python:*)"
    ]
  }
}

--- END OF FILE ---

--- FILE: backend/requirements.txt ---
# Web framework
fastapi>=0.109.0
uvicorn[standard]>=0.27.0

# AI Services
replicate>=0.23.0
httpx>=0.26.0

# Database
sqlalchemy>=2.0.25
aiosqlite>=0.19.0

# Authentication & Security
python-jose[cryptography]>=3.3.0
bcrypt>=4.0.0
python-multipart>=0.0.6

# Utilities
python-dotenv>=1.0.0
pydantic[email]>=2.5.3
pydantic-settings>=2.1.0
pillow>=10.2.0

# Development
pytest>=7.4.4
pytest-asyncio>=0.23.3

--- END OF FILE ---

--- FILE: backend/test_gemini_text.py ---
#!/usr/bin/env python3
import httpx
import json

api_key = "***REMOVED***"
url = f"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key={api_key}"

request_body = {
    "contents": [{"parts": [{"text": "Say hello"}]}],
}

try:
    response = httpx.post(url, json=request_body, timeout=30.0)
    print(f"Status Code: {response.status_code}")
    if response.status_code == 200:
        print("✓ API key is VALID for Gemini text generation")
        data = response.json()
        text = data.get("candidates", [{}])[0].get("content", {}).get("parts", [{}])[0].get("text", "")
        print(f"Response: {text[:100]}")
    else:
        print("✗ API key validation failed")
        print(f"Error: {json.dumps(response.json(), indent=2)}")
except Exception as e:
    print(f"Error: {e}")

--- END OF FILE ---

--- FILE: backend/test_gemini_direct.py ---
#!/usr/bin/env python3
import httpx
import json

api_key = "***REMOVED***"
url = f"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key={api_key}"

request_body = {
    "contents": [{"parts": [{"text": "A cute robot"}]}],
    "generationConfig": {
        "responseModalities": ["image", "text"],
        "responseMimeType": "image/png",
    },
}

try:
    response = httpx.post(url, json=request_body, timeout=60.0)
    print(f"Status Code: {response.status_code}")
    print(f"Response: {json.dumps(response.json(), indent=2)}")
except Exception as e:
    print(f"Error: {e}")

--- END OF FILE ---

--- FILE: backend/test_gemini_image3.py ---
#!/usr/bin/env python3
import httpx
import json

api_key = "***REMOVED***"
url = f"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key={api_key}"

# Correct configuration based on documentation
request_body = {
    "contents": [{"parts": [{"text": "Generate a cute robot holding a coffee cup"}]}],
    "generationConfig": {
        "response_modalities": ["Text", "Image"],
    },
}

try:
    response = httpx.post(url, json=request_body, timeout=60.0)
    print(f"Status Code: {response.status_code}")
    if response.status_code == 200:
        print("✓ SUCCESS! Gemini image generation works!")
        data = response.json()
        print(f"\nResponse structure:")
        for i, candidate in enumerate(data.get('candidates', [])):
            print(f"\nCandidate {i+1}:")
            parts = candidate.get('content', {}).get('parts', [])
            for j, part in enumerate(parts):
                if 'text' in part:
                    print(f"  Part {j+1}: Text - {part['text'][:100]}")
                if 'inlineData' in part:
                    mime = part['inlineData'].get('mimeType', '')
                    data_len = len(part['inlineData'].get('data', ''))
                    print(f"  Part {j+1}: Image - {mime}, {data_len} chars (base64)")
    else:
        print("✗ API call failed")
        print(f"Error: {json.dumps(response.json(), indent=2)}")
except Exception as e:
    print(f"Error: {e}")

--- END OF FILE ---

--- FILE: backend/test_gemini_image2.py ---
#!/usr/bin/env python3
import httpx
import json

api_key = "***REMOVED***"
url = f"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp-image-generation:generateContent?key={api_key}"

# Try without responseMimeType
request_body = {
    "contents": [{"parts": [{"text": "A cute robot holding a coffee cup"}]}],
    "generationConfig": {
        "responseModalities": ["IMAGE"],
    },
}

try:
    response = httpx.post(url, json=request_body, timeout=60.0)
    print(f"Status Code: {response.status_code}")
    if response.status_code == 200:
        print("✓ SUCCESS! Gemini image generation works!")
        data = response.json()
        print(f"Full response structure:")
        print(json.dumps(data, indent=2)[:1000])
    else:
        print("✗ API call failed")
        print(f"Error: {json.dumps(response.json(), indent=2)}")
except Exception as e:
    print(f"Error: {e}")

--- END OF FILE ---

--- FILE: backend/test_gemini.sh ---
#!/bin/bash

TOKEN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwiZW1haWwiOiJ0ZXN0QGV4YW1wbGUuY29tIiwiZXhwIjoxNzcyMTI0Mzc0fQ.sq6PMgSgDCUuTH4daSGsHRWQ-BbvYSZeJjafXk7Wr18"

echo "Testing Gemini API connection..."
echo ""

curl -X POST http://localhost:8000/api/generate/ \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{"prompt": "A cute robot holding a coffee cup", "provider": "gemini", "model": "gemini-2.0-flash-exp-image-generation", "aspect_ratio": "1:1"}'

--- END OF FILE ---

--- FILE: backend/.env ---
# ============================================
# Backend Configuration
# ============================================

# Application
APP_ENV=development
DEBUG=true
SECRET_KEY=change_this_to_a_random_secret_key

# JWT Auth
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=10080  # 7 days

# ============================================
# AI Provider API Keys (stored ONLY on backend)
# ============================================

# Replicate (Flux Schnell, Flux Pro, SDXL)
# Get token from: https://replicate.com/account
REPLICATE_API_TOKEN=

# OpenAI (DALL-E 3, DALL-E 2)
# Get key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key_here

# Google Gemini (Imagen 3, Gemini 2.0 Flash)
# Get key from: https://aistudio.google.com/app/apikey
GEMINI_API_KEY=***REMOVED***

# Default provider to use when none specified
DEFAULT_PROVIDER=gemini

# ============================================
# Rate Limits
# ============================================
DAILY_GENERATION_LIMIT=50
MONTHLY_GENERATION_LIMIT=1000

# ============================================
# Database
# ============================================
DATABASE_URL=sqlite+aiosqlite:///./imagegen.db

# ============================================
# CORS (frontend URL)
# ============================================
FRONTEND_URL=http://localhost:3000

# ============================================
# Storage (local for MVP)
# ============================================
STORAGE_PATH=./generated

--- END OF FILE ---

--- FILE: backend/test_gemini_image.py ---
#!/usr/bin/env python3
import httpx
import json

api_key = "***REMOVED***"
url = f"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp-image-generation:generateContent?key={api_key}"

request_body = {
    "contents": [{"parts": [{"text": "A cute robot holding a coffee cup"}]}],
    "generationConfig": {
        "responseModalities": ["image", "text"],
        "responseMimeType": "image/png",
    },
}

try:
    response = httpx.post(url, json=request_body, timeout=60.0)
    print(f"Status Code: {response.status_code}")
    if response.status_code == 200:
        print("✓ SUCCESS! Gemini image generation works!")
        data = response.json()
        print(f"Response has {len(data.get('candidates', []))} candidates")
        for candidate in data.get('candidates', []):
            parts = candidate.get('content', {}).get('parts', [])
            print(f"  Candidate has {len(parts)} parts")
            for part in parts:
                if 'inlineData' in part:
                    mime = part['inlineData'].get('mimeType', '')
                    data_len = len(part['inlineData'].get('data', ''))
                    print(f"    ✓ Found image data: {mime}, {data_len} bytes (base64)")
    else:
        print("✗ API call failed")
        print(f"Error: {json.dumps(response.json(), indent=2)}")
except Exception as e:
    print(f"Error: {e}")

--- END OF FILE ---

--- FILE: backend/test_imagen_direct.py ---
#!/usr/bin/env python3
import httpx
import json

api_key = "***REMOVED***"
url = "https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict"

request_body = {
    "instances": [{"prompt": "A cute robot holding a coffee cup"}],
    "parameters": {
        "sampleCount": 1,
        "aspectRatio": "1:1",
        "safetyFilterLevel": "block_few",
        "personGeneration": "allow_adult",
        "outputOptions": {"mimeType": "image/png"},
    },
}

try:
    response = httpx.post(
        url,
        headers={
            "Authorization": f"Bearer {api_key}",
            "Content-Type": "application/json",
            "x-goog-api-key": api_key,
        },
        json=request_body,
        timeout=60.0,
    )
    print(f"Status Code: {response.status_code}")
    data = response.json()
    print(f"Response keys: {list(data.keys())}")
    if response.status_code != 200:
        print(f"Error: {json.dumps(data, indent=2)}")
    else:
        print("Success! Image generated.")
        if "predictions" in data:
            print(f"Predictions count: {len(data['predictions'])}")
except Exception as e:
    print(f"Error: {e}")

--- END OF FILE ---

--- FILE: backend/.env.example ---
# ============================================
# Backend Configuration
# ============================================

# Application
APP_ENV=development
DEBUG=true
SECRET_KEY=change_this_to_a_random_secret_key

# JWT Auth
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=10080  # 7 days

# ============================================
# AI Provider API Keys (stored ONLY on backend)
# ============================================

# Replicate (Flux Schnell, Flux Pro, SDXL)
# Get token from: https://replicate.com/account
REPLICATE_API_TOKEN=your_replicate_api_token_here

# OpenAI (DALL-E 3, DALL-E 2)
# Get key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key_here

# Google Gemini (Imagen 3, Gemini 2.0 Flash)
# Get key from: https://aistudio.google.com/app/apikey
GEMINI_API_KEY=your_gemini_api_key_here

# Optional Nano Banana token (if you use Nano Banana as a server-side API token)
# NANO_BANANA_TOKEN=your_nano_banana_token_here

# Default provider to use when none specified
DEFAULT_PROVIDER=replicate

# ============================================
# Rate Limits
# ============================================
DAILY_GENERATION_LIMIT=50
MONTHLY_GENERATION_LIMIT=1000

# ============================================
# Database
# ============================================
DATABASE_URL=sqlite+aiosqlite:///./imagegen.db

# ============================================
# CORS (frontend URL)
# ============================================
FRONTEND_URL=http://localhost:3000

# ============================================
# Storage (local for MVP)
# ============================================
STORAGE_PATH=./generated

--- END OF FILE ---

--- FILE: backend/test_replicate.py ---
#!/usr/bin/env python3
"""Test script to verify Replicate API token"""
import os
from dotenv import load_dotenv

# Load .env file
load_dotenv()

token = os.getenv("REPLICATE_API_TOKEN")

print(f"Token loaded: {'Yes' if token else 'No'}")
if token:
    print(f"Token starts with: {token[:10] if len(token) >= 10 else token}...")
    print(f"Token length: {len(token)}")

    # Try to initialize Replicate client
    try:
        import replicate
        client = replicate.Client(api_token=token)
        print("✅ Replicate client created successfully")

        # Try to run a simple model
        print("\nTesting API call...")
        output = client.run(
            "black-forest-labs/flux-schnell",
            input={
                "prompt": "test product photo",
                "num_outputs": 1,
                "aspect_ratio": "1:1",
            }
        )
        print(f"✅ SUCCESS! Generated image: {output[0] if isinstance(output, list) else output}")

    except Exception as e:
        print(f"❌ ERROR: {type(e).__name__}: {e}")
else:
    print("❌ No token found in .env file")

--- END OF FILE ---

--- FILE: backend/app/config.py ---
from pydantic_settings import BaseSettings
from functools import lru_cache


class Settings(BaseSettings):
    # App
    app_env: str = "development"
    debug: bool = True
    secret_key: str = "change-me-in-production"

    # JWT
    jwt_algorithm: str = "HS256"
    jwt_expire_minutes: int = 10080  # 7 days

    # AI Provider Keys
    replicate_api_token: str = ""
    openai_api_key: str = ""
    gemini_api_key: str = ""
    # Optional Nano Banana token (can be used as a server-side API token
    # or as a fallback when clients do not provide a per-request token)
    nano_banana_token: str = ""

    # Default provider
    default_provider: str = "replicate"

    # Database
    database_url: str = "sqlite+aiosqlite:///./imagegen.db"

    # CORS
    frontend_url: str = "http://localhost:3000"

    # Storage
    storage_path: str = "./generated"

    # Rate Limits
    daily_generation_limit: int = 50
    monthly_generation_limit: int = 1000

    class Config:
        env_file = ".env"


@lru_cache()
def get_settings() -> Settings:
    return Settings()

--- END OF FILE ---

--- FILE: backend/app/database.py ---
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession, async_sessionmaker
from sqlalchemy.orm import DeclarativeBase

from app.config import get_settings

settings = get_settings()

engine = create_async_engine(settings.database_url, echo=settings.debug)
async_session = async_sessionmaker(engine, class_=AsyncSession, expire_on_commit=False)


class Base(DeclarativeBase):
    pass


async def get_db():
    async with async_session() as session:
        yield session


async def create_tables():
    async with engine.begin() as conn:
        await conn.run_sync(Base.metadata.create_all)

--- END OF FILE ---

--- FILE: backend/app/__init__.py ---
# ImageGen MVP Backend

--- END OF FILE ---

--- FILE: backend/app/main.py ---
from contextlib import asynccontextmanager
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from fastapi.staticfiles import StaticFiles
import os

from app.config import get_settings
from app.database import create_tables
from app.services.providers import init_providers
from app.api import auth, generate, images, prompts, usage

settings = get_settings()

# Ensure storage directory exists before StaticFiles mount
os.makedirs(settings.storage_path, exist_ok=True)


@asynccontextmanager
async def lifespan(app: FastAPI):
    # Startup
    await create_tables()
    init_providers()
    print(f"[startup] Database tables created")
    print(f"[startup] Storage path: {settings.storage_path}")
    yield
    # Shutdown


app = FastAPI(
    title="ImageGen MVP",
    description="Secure image generation proxy API",
    version="0.2.0",
    lifespan=lifespan
)

# CORS middleware
app.add_middleware(
    CORSMiddleware,
    allow_origins=[settings.frontend_url],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Mount static files for generated images
app.mount("/images", StaticFiles(directory=settings.storage_path), name="images")

# Include routers
app.include_router(auth.router, prefix="/api/auth", tags=["Auth"])
app.include_router(generate.router, prefix="/api/generate", tags=["Generation"])
app.include_router(images.router, prefix="/api/images", tags=["Images"])
app.include_router(prompts.router, prefix="/api/prompts", tags=["Prompts"])
app.include_router(usage.router, prefix="/api/usage", tags=["Usage"])


@app.get("/")
async def root():
    return {"message": "ImageGen MVP API", "status": "running", "version": "0.2.0"}


@app.get("/health")
async def health_check():
    return {"status": "healthy"}

--- END OF FILE ---

--- FILE: backend/app/models/user.py ---
from sqlalchemy import Column, Integer, String, Boolean, DateTime
from sqlalchemy.sql import func

from app.database import Base


class User(Base):
    __tablename__ = "users"

    id = Column(Integer, primary_key=True, index=True)
    email = Column(String(255), unique=True, index=True, nullable=False)
    hashed_password = Column(String(255), nullable=False)
    display_name = Column(String(100), nullable=True)
    is_active = Column(Boolean, default=True)
    created_at = Column(DateTime, server_default=func.now())
    updated_at = Column(DateTime, server_default=func.now(), onupdate=func.now())

--- END OF FILE ---

--- FILE: backend/app/models/generation.py ---
from sqlalchemy import Column, Integer, String, Float, DateTime, ForeignKey, Text
from sqlalchemy.sql import func

from app.database import Base


class Generation(Base):
    __tablename__ = "generations"

    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=False, index=True)
    prompt = Column(Text, nullable=False)
    enhanced_prompt = Column(Text, nullable=True)
    provider = Column(String(50), nullable=False)
    model = Column(String(100), nullable=False)
    status = Column(String(20), default="pending")  # pending, processing, completed, failed
    image_url = Column(String(500), nullable=True)
    image_id = Column(String(50), nullable=True, index=True)
    aspect_ratio = Column(String(10), default="1:1")
    width = Column(Integer, nullable=True)
    height = Column(Integer, nullable=True)
    cost_estimate = Column(Float, default=0.0)
    duration_ms = Column(Integer, nullable=True)
    error_message = Column(Text, nullable=True)
    failover_from = Column(String(50), nullable=True)
    metadata_json = Column(Text, nullable=True)
    created_at = Column(DateTime, server_default=func.now())

--- END OF FILE ---

--- FILE: backend/app/models/__init__.py ---
# Database Models
from app.models.user import User
from app.models.generation import Generation

__all__ = ["User", "Generation"]

--- END OF FILE ---

--- FILE: backend/app/api/auth.py ---
from __future__ import annotations

from typing import Optional
from fastapi import APIRouter, HTTPException, Depends
from pydantic import BaseModel, EmailStr
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select

from app.database import get_db
from app.models.user import User
from app.services.auth import (
    hash_password,
    verify_password,
    create_access_token,
    get_current_user,
)

router = APIRouter()


class RegisterRequest(BaseModel):
    email: EmailStr
    password: str
    display_name: str = ""


class LoginRequest(BaseModel):
    email: EmailStr
    password: str


class AuthResponse(BaseModel):
    access_token: str
    token_type: str = "bearer"
    user: dict


class UserResponse(BaseModel):
    id: int
    email: str
    display_name: Optional[str]
    created_at: str


@router.post("/register", response_model=AuthResponse)
async def register(request: RegisterRequest, db: AsyncSession = Depends(get_db)):
    """Create a new user account."""
    if len(request.password) < 8:
        raise HTTPException(status_code=422, detail="Password must be at least 8 characters")

    # Check if email already exists
    result = await db.execute(select(User).where(User.email == request.email))
    if result.scalar_one_or_none():
        raise HTTPException(status_code=409, detail="Email already registered")

    user = User(
        email=request.email,
        hashed_password=hash_password(request.password),
        display_name=request.display_name or request.email.split("@")[0],
    )
    db.add(user)
    await db.commit()
    await db.refresh(user)

    token = create_access_token(user.id, user.email)
    return AuthResponse(
        access_token=token,
        user={
            "id": user.id,
            "email": user.email,
            "display_name": user.display_name,
        },
    )


@router.post("/login", response_model=AuthResponse)
async def login(request: LoginRequest, db: AsyncSession = Depends(get_db)):
    """Authenticate and return JWT."""
    result = await db.execute(
        select(User).where(User.email == request.email, User.is_active == True)
    )
    user = result.scalar_one_or_none()

    if not user or not verify_password(request.password, user.hashed_password):
        raise HTTPException(status_code=401, detail="Invalid email or password")

    token = create_access_token(user.id, user.email)
    return AuthResponse(
        access_token=token,
        user={
            "id": user.id,
            "email": user.email,
            "display_name": user.display_name,
        },
    )


@router.get("/me")
async def get_me(current_user: User = Depends(get_current_user)):
    """Get current user profile."""
    return {
        "id": current_user.id,
        "email": current_user.email,
        "display_name": current_user.display_name,
        "created_at": str(current_user.created_at),
    }

--- END OF FILE ---

--- FILE: backend/app/api/generate.py ---
from fastapi import APIRouter, HTTPException, Depends, Header
from pydantic import BaseModel
from typing import Optional
from sqlalchemy.ext.asyncio import AsyncSession

from app.database import get_db
from app.models.user import User
from app.services.auth import get_current_user
from app.services.generation_service import generate_image
from app.services.providers import get_all_providers

router = APIRouter()

STYLE_KEYWORDS = {
    "photorealistic": "photorealistic, 8k, professional photography",
    "anime": "anime style, vibrant colors, detailed illustration",
    "watercolor": "watercolor painting, soft colors, artistic",
    "digital_art": "digital art, vibrant, modern",
    "fantasy": "fantasy art, magical, ethereal",
}


def enhance_prompt_text(prompt: str, style: Optional[str] = None) -> str:
    if style and style in STYLE_KEYWORDS:
        return f"{prompt}, {STYLE_KEYWORDS[style]}"
    return f"{prompt}, highly detailed, professional quality, beautiful lighting"


class GenerateRequest(BaseModel):
    prompt: str
    provider: Optional[str] = None
    model: Optional[str] = None
    aspect_ratio: Optional[str] = "1:1"
    width: Optional[int] = 1024
    height: Optional[int] = 1024
    style: Optional[str] = None
    failover: Optional[bool] = True


class GenerateResponse(BaseModel):
    success: bool
    generation_id: int
    image_url: Optional[str] = None
    image_id: Optional[str] = None
    provider: Optional[str] = None
    model: Optional[str] = None
    cost_estimate: Optional[float] = None
    duration_ms: Optional[int] = None
    failover_from: Optional[str] = None
    error: Optional[str] = None


@router.post("/", response_model=GenerateResponse)
async def create_generation(
    request: GenerateRequest,
    current_user: User = Depends(get_current_user),
    db: AsyncSession = Depends(get_db),
    nano_banana_token: Optional[str] = Header(None, alias="x-nano-banana-token"),
):
    """Generate an image from a text prompt."""
    try:
        # Enhance prompt with style if provided
        prompt = request.prompt
        if request.style:
            prompt = f"{prompt}, {request.style} style"

        gen = await generate_image(
            user_id=current_user.id,
            prompt=prompt,
            provider_name=request.provider,
            model=request.model,
            aspect_ratio=request.aspect_ratio,
            width=request.width,
            height=request.height,
            failover=request.failover,
            auth_token=nano_banana_token,
            db=db,
        )

        return GenerateResponse(
            success=True,
            generation_id=gen.id,
            image_url=gen.image_url,
            image_id=gen.image_id,
            provider=gen.provider,
            model=gen.model,
            cost_estimate=gen.cost_estimate,
            duration_ms=gen.duration_ms,
            failover_from=gen.failover_from,
        )
    except HTTPException:
        raise  # Re-raise 429 rate limit errors
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


@router.post("/enhance-prompt")
async def enhance_prompt(
    request: GenerateRequest,
    current_user: User = Depends(get_current_user),
):
    """Enhance a simple prompt to get better results."""
    enhanced = enhance_prompt_text(request.prompt, request.style)
    return {"original": request.prompt, "enhanced": enhanced}


@router.get("/providers")
async def list_providers(current_user: User = Depends(get_current_user)):
    """List all configured AI providers and their models."""
    providers = get_all_providers()
    result = []

    for name, provider in providers.items():
        result.append({
            "id": name,
            "name": name.capitalize(),
            "available": True,
            "models": provider.get_available_models(),
        })

    return {"providers": result, "default_provider": "replicate"}

--- END OF FILE ---

--- FILE: backend/app/api/__init__.py ---
# API Routes

--- END OF FILE ---

--- FILE: backend/app/api/prompts.py ---
from fastapi import APIRouter
from typing import List

router = APIRouter()

# Beginner-friendly prompt templates and suggestions
STYLE_PRESETS = {
    "photorealistic": "photorealistic, highly detailed, professional photography, 8k",
    "anime": "anime style, vibrant colors, detailed illustration",
    "watercolor": "watercolor painting, soft colors, artistic, flowing",
    "oil_painting": "oil painting, classical art style, textured brushstrokes",
    "digital_art": "digital art, vibrant, modern illustration",
    "sketch": "pencil sketch, hand-drawn, detailed linework",
    "3d_render": "3D render, octane render, highly detailed, realistic lighting",
    "cartoon": "cartoon style, bold colors, fun, playful",
    "minimalist": "minimalist, clean, simple, modern design",
    "fantasy": "fantasy art, magical, ethereal, detailed"
}

PROMPT_STARTERS = [
    {"category": "Nature", "prompts": [
        "A peaceful mountain lake at sunset",
        "Cherry blossoms in full bloom",
        "A cozy cabin in a snowy forest"
    ]},
    {"category": "Animals", "prompts": [
        "A majestic lion resting under a tree",
        "Colorful tropical fish in coral reef",
        "A cute puppy playing in autumn leaves"
    ]},
    {"category": "Fantasy", "prompts": [
        "A magical floating castle in the clouds",
        "An enchanted forest with glowing mushrooms",
        "A dragon perched on a mountain peak"
    ]},
    {"category": "Food", "prompts": [
        "A delicious stack of pancakes with berries",
        "Fresh sushi platter on wooden board",
        "A steaming cup of coffee with latte art"
    ]},
    {"category": "Architecture", "prompts": [
        "A futuristic city skyline at night",
        "A cozy Mediterranean village street",
        "Ancient temple ruins in the jungle"
    ]}
]


@router.get("/styles")
async def get_styles():
    """Get available style presets for beginners."""
    return {
        "styles": [
            {"id": key, "name": key.replace("_", " ").title(), "keywords": value}
            for key, value in STYLE_PRESETS.items()
        ]
    }


@router.get("/suggestions")
async def get_suggestions():
    """Get prompt suggestions organized by category."""
    return {"categories": PROMPT_STARTERS}


@router.get("/tips")
async def get_tips():
    """Get tips for writing better prompts."""
    return {
        "tips": [
            "Be specific - describe colors, lighting, and mood",
            "Include the subject, setting, and style",
            "Use descriptive adjectives (vibrant, peaceful, dramatic)",
            "Mention the time of day for outdoor scenes",
            "Add quality keywords like 'detailed' or 'professional'",
            "Try combining unexpected elements for unique results"
        ]
    }

--- END OF FILE ---

--- FILE: backend/app/api/images.py ---
from fastapi import APIRouter, HTTPException, Depends
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select, desc
import os

from app.config import get_settings
from app.database import get_db
from app.models.user import User
from app.models.generation import Generation
from app.services.auth import get_current_user

router = APIRouter()
settings = get_settings()


@router.get("/")
async def list_images(
    limit: int = 20,
    offset: int = 0,
    current_user: User = Depends(get_current_user),
    db: AsyncSession = Depends(get_db),
):
    """List user's generated images with pagination."""
    # Count total
    from sqlalchemy import func
    count_result = await db.execute(
        select(func.count(Generation.id)).where(
            Generation.user_id == current_user.id,
            Generation.status == "completed",
        )
    )
    total = count_result.scalar() or 0

    # Fetch page
    result = await db.execute(
        select(Generation)
        .where(Generation.user_id == current_user.id, Generation.status == "completed")
        .order_by(desc(Generation.created_at))
        .offset(offset)
        .limit(limit)
    )
    generations = result.scalars().all()

    images = [
        {
            "id": g.image_id,
            "generation_id": g.id,
            "prompt": g.prompt,
            "image_url": g.image_url,
            "provider": g.provider,
            "model": g.model,
            "aspect_ratio": g.aspect_ratio,
            "cost_estimate": g.cost_estimate,
            "created_at": str(g.created_at),
        }
        for g in generations
    ]

    return {"images": images, "total": total, "limit": limit, "offset": offset}


@router.get("/{image_id}")
async def get_image(
    image_id: str,
    current_user: User = Depends(get_current_user),
    db: AsyncSession = Depends(get_db),
):
    """Get details for a specific image."""
    result = await db.execute(
        select(Generation).where(
            Generation.image_id == image_id,
            Generation.user_id == current_user.id,
        )
    )
    gen = result.scalar_one_or_none()

    if not gen:
        raise HTTPException(status_code=404, detail="Image not found")

    return {
        "id": gen.image_id,
        "generation_id": gen.id,
        "prompt": gen.prompt,
        "image_url": gen.image_url,
        "provider": gen.provider,
        "model": gen.model,
        "aspect_ratio": gen.aspect_ratio,
        "cost_estimate": gen.cost_estimate,
        "duration_ms": gen.duration_ms,
        "created_at": str(gen.created_at),
    }


@router.delete("/{image_id}")
async def delete_image(
    image_id: str,
    current_user: User = Depends(get_current_user),
    db: AsyncSession = Depends(get_db),
):
    """Delete a generated image."""
    result = await db.execute(
        select(Generation).where(
            Generation.image_id == image_id,
            Generation.user_id == current_user.id,
        )
    )
    gen = result.scalar_one_or_none()

    if not gen:
        raise HTTPException(status_code=404, detail="Image not found")

    # Delete file
    filepath = os.path.join(settings.storage_path, f"{image_id}.png")
    if os.path.exists(filepath):
        os.remove(filepath)

    # Mark as deleted
    gen.status = "deleted"
    await db.commit()

    return {"success": True, "message": "Image deleted"}

--- END OF FILE ---

--- FILE: backend/app/api/usage.py ---
from fastapi import APIRouter, Depends
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select, func, desc
from datetime import date, datetime

from app.database import get_db
from app.models.user import User
from app.models.generation import Generation
from app.services.auth import get_current_user
from app.config import get_settings

router = APIRouter()
settings = get_settings()


@router.get("/summary")
async def usage_summary(
    current_user: User = Depends(get_current_user),
    db: AsyncSession = Depends(get_db),
):
    """Get usage summary for current user."""
    today = date.today()
    first_of_month = today.replace(day=1)

    # Daily count
    daily_result = await db.execute(
        select(func.count(Generation.id)).where(
            Generation.user_id == current_user.id,
            func.date(Generation.created_at) == str(today),
            Generation.status != "failed",
        )
    )
    daily_count = daily_result.scalar() or 0

    # Monthly count
    monthly_result = await db.execute(
        select(func.count(Generation.id)).where(
            Generation.user_id == current_user.id,
            Generation.created_at >= datetime.combine(first_of_month, datetime.min.time()),
            Generation.status != "failed",
        )
    )
    monthly_count = monthly_result.scalar() or 0

    # Total count
    total_result = await db.execute(
        select(func.count(Generation.id)).where(
            Generation.user_id == current_user.id,
            Generation.status == "completed",
        )
    )
    total_count = total_result.scalar() or 0

    # Total cost
    cost_result = await db.execute(
        select(func.sum(Generation.cost_estimate)).where(
            Generation.user_id == current_user.id,
            Generation.status == "completed",
        )
    )
    total_cost = cost_result.scalar() or 0.0

    return {
        "daily": {
            "used": daily_count,
            "limit": settings.daily_generation_limit,
            "remaining": max(0, settings.daily_generation_limit - daily_count),
        },
        "monthly": {
            "used": monthly_count,
            "limit": settings.monthly_generation_limit,
            "remaining": max(0, settings.monthly_generation_limit - monthly_count),
        },
        "total_generations": total_count,
        "total_cost_estimate": round(total_cost, 4),
    }


@router.get("/history")
async def usage_history(
    limit: int = 50,
    offset: int = 0,
    provider: str = None,
    current_user: User = Depends(get_current_user),
    db: AsyncSession = Depends(get_db),
):
    """Get generation history for current user."""
    query = select(Generation).where(Generation.user_id == current_user.id)

    if provider:
        query = query.where(Generation.provider == provider)

    # Count
    count_query = select(func.count(Generation.id)).where(
        Generation.user_id == current_user.id
    )
    if provider:
        count_query = count_query.where(Generation.provider == provider)

    total_result = await db.execute(count_query)
    total = total_result.scalar() or 0

    # Fetch
    result = await db.execute(
        query.order_by(desc(Generation.created_at)).offset(offset).limit(limit)
    )
    generations = result.scalars().all()

    items = [
        {
            "id": g.id,
            "prompt": g.prompt[:100],
            "provider": g.provider,
            "model": g.model,
            "status": g.status,
            "cost_estimate": g.cost_estimate,
            "duration_ms": g.duration_ms,
            "created_at": str(g.created_at),
        }
        for g in generations
    ]

    return {"generations": items, "total": total}

--- END OF FILE ---

--- FILE: backend/app/services/auth.py ---
from datetime import datetime, timedelta
import bcrypt
from jose import JWTError, jwt
from fastapi import Depends, HTTPException, status
from fastapi.security import HTTPBearer, HTTPAuthorizationCredentials
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select

from app.config import get_settings
from app.database import get_db
from app.models.user import User

settings = get_settings()
security = HTTPBearer()


def hash_password(password: str) -> str:
    return bcrypt.hashpw(password.encode("utf-8"), bcrypt.gensalt()).decode("utf-8")


def verify_password(plain: str, hashed: str) -> bool:
    return bcrypt.checkpw(plain.encode("utf-8"), hashed.encode("utf-8"))


def create_access_token(user_id: int, email: str) -> str:
    expire = datetime.utcnow() + timedelta(minutes=settings.jwt_expire_minutes)
    payload = {"sub": str(user_id), "email": email, "exp": expire}
    return jwt.encode(payload, settings.secret_key, algorithm=settings.jwt_algorithm)


async def get_current_user(
    credentials: HTTPAuthorizationCredentials = Depends(security),
    db: AsyncSession = Depends(get_db)
) -> User:
    token = credentials.credentials
    try:
        payload = jwt.decode(token, settings.secret_key, algorithms=[settings.jwt_algorithm])
        user_id = int(payload.get("sub"))
    except (JWTError, ValueError):
        raise HTTPException(status_code=401, detail="Invalid or expired token")

    result = await db.execute(
        select(User).where(User.id == user_id, User.is_active == True)
    )
    user = result.scalar_one_or_none()
    if not user:
        raise HTTPException(status_code=401, detail="User not found")
    return user

--- END OF FILE ---

--- FILE: backend/app/services/generation_service.py ---
from __future__ import annotations

from typing import Optional
import time
import uuid
import os
import httpx
from sqlalchemy.ext.asyncio import AsyncSession

from app.config import get_settings
from app.models.generation import Generation
from app.services.rate_limiter import check_rate_limit
from app.services.providers import get_provider, get_all_providers, FAILOVER_ORDER

settings = get_settings()


async def download_and_save(image_url: str) -> tuple[str, str]:
    """Download image from URL and save locally. Returns (image_id, local_url)."""
    image_id = str(uuid.uuid4())[:8]
    filepath = os.path.join(settings.storage_path, f"{image_id}.png")
    os.makedirs(settings.storage_path, exist_ok=True)

    # If it's already a local path, skip download
    if image_url.startswith("/images/"):
        return image_url.split("/")[-1].replace(".png", ""), image_url

    async with httpx.AsyncClient(timeout=60.0) as client:
        response = await client.get(image_url)
        response.raise_for_status()

        with open(filepath, "wb") as f:
            f.write(response.content)

    return image_id, f"/images/{image_id}.png"


async def generate_image(
    user_id: int,
    prompt: str,
    provider_name: Optional[str],
    model: Optional[str],
    aspect_ratio: str,
    width: int,
    height: int,
    failover: bool,
    auth_token: Optional[str] = None,
    db: AsyncSession = None,
) -> Generation:
    """Orchestrate image generation with rate limiting, provider selection, and failover."""

    # 1. Check rate limits
    await check_rate_limit(user_id, db)

    # 2. Build provider list
    providers_to_try = []
    if provider_name:
        providers_to_try.append(provider_name)

    if failover:
        for p in FAILOVER_ORDER:
            if p not in providers_to_try and get_provider(p):
                providers_to_try.append(p)

    # If no specific provider, use all configured
    if not providers_to_try:
        providers_to_try = [p for p in FAILOVER_ORDER if get_provider(p)]

    if not providers_to_try:
        raise Exception("No AI providers configured. Set API keys in backend .env")

    # 3. Create pending generation record
    gen = Generation(
        user_id=user_id,
        prompt=prompt,
        provider=providers_to_try[0],
        model=model or "default",
        status="processing",
        aspect_ratio=aspect_ratio,
        width=width,
        height=height,
    )
    db.add(gen)
    await db.commit()
    await db.refresh(gen)

    # 4. Try each provider
    last_error = None
    failover_from = None

    for pname in providers_to_try:
        provider = get_provider(pname)
        if not provider:
            continue

        try:
            start = time.time()
            result = await provider.generate(
                prompt=prompt,
                model=model if pname == providers_to_try[0] else None,
                aspect_ratio=aspect_ratio,
                width=width,
                height=height,
                auth_token=auth_token,
            )
            duration = int((time.time() - start) * 1000)

            # Download and save image locally if it's a remote URL
            image_id, local_url = await download_and_save(result.image_url)

            # Update generation record
            gen.status = "completed"
            gen.provider = pname
            gen.model = result.model
            gen.image_url = local_url
            gen.image_id = image_id
            gen.cost_estimate = result.cost_estimate
            gen.duration_ms = duration
            gen.failover_from = failover_from
            await db.commit()

            return gen

        except Exception as e:
            failover_from = pname
            last_error = e
            continue

    # All providers failed
    gen.status = "failed"
    gen.error_message = str(last_error)
    await db.commit()
    raise Exception(f"All providers failed. Last error: {last_error}")

--- END OF FILE ---

--- FILE: backend/app/services/rate_limiter.py ---
from datetime import datetime, date
from sqlalchemy import select, func
from sqlalchemy.ext.asyncio import AsyncSession
from fastapi import HTTPException

from app.models.generation import Generation
from app.config import get_settings

settings = get_settings()


async def check_rate_limit(user_id: int, db: AsyncSession) -> dict:
    """Check if user is within rate limits. Raises 429 if exceeded."""
    today = date.today()
    first_of_month = today.replace(day=1)

    # Daily count
    daily_result = await db.execute(
        select(func.count(Generation.id)).where(
            Generation.user_id == user_id,
            func.date(Generation.created_at) == str(today),
            Generation.status != "failed",
        )
    )
    daily_count = daily_result.scalar() or 0

    # Monthly count
    monthly_result = await db.execute(
        select(func.count(Generation.id)).where(
            Generation.user_id == user_id,
            Generation.created_at >= datetime.combine(first_of_month, datetime.min.time()),
            Generation.status != "failed",
        )
    )
    monthly_count = monthly_result.scalar() or 0

    limits = {
        "daily": {
            "used": daily_count,
            "limit": settings.daily_generation_limit,
            "remaining": max(0, settings.daily_generation_limit - daily_count),
        },
        "monthly": {
            "used": monthly_count,
            "limit": settings.monthly_generation_limit,
            "remaining": max(0, settings.monthly_generation_limit - monthly_count),
        },
    }

    if daily_count >= settings.daily_generation_limit:
        raise HTTPException(
            status_code=429,
            detail={"message": "Daily generation limit reached", "limits": limits},
        )

    if monthly_count >= settings.monthly_generation_limit:
        raise HTTPException(
            status_code=429,
            detail={"message": "Monthly generation limit reached", "limits": limits},
        )

    return limits

--- END OF FILE ---

--- FILE: backend/app/services/__init__.py ---
# Services

--- END OF FILE ---

--- FILE: backend/app/services/image_generator.py ---
import replicate
import httpx
import os
import json
import uuid
from datetime import datetime
from typing import Optional

from app.config import get_settings

settings = get_settings()


class ImageGenerator:
    """Service for generating images using AI models."""

    def __init__(self):
        self.client = replicate.Client(api_token=settings.replicate_api_token)

        # Default model - Flux Schnell (fast and good quality)
        self.model = "black-forest-labs/flux-schnell"

    async def generate(
        self,
        prompt: str,
        aspect_ratio: str = "1:1",
        model: Optional[str] = None
    ) -> dict:
        """Generate an image from a text prompt."""

        # Map aspect ratios to dimensions
        dimensions = {
            "1:1": (1024, 1024),
            "16:9": (1344, 768),
            "9:16": (768, 1344),
            "4:3": (1152, 896),
            "3:4": (896, 1152)
        }

        width, height = dimensions.get(aspect_ratio, (1024, 1024))

        # Run the model
        output = self.client.run(
            model or self.model,
            input={
                "prompt": prompt,
                "width": width,
                "height": height,
                "num_outputs": 1,
                "output_format": "png"
            }
        )

        # Get the image URL from output
        image_url = output[0] if isinstance(output, list) else output

        # Download and save locally
        image_id = str(uuid.uuid4())[:8]
        local_path = await self._save_image(image_url, image_id)

        # Save metadata
        self._save_metadata(image_id, prompt, aspect_ratio, local_path)

        return {
            "id": image_id,
            "url": f"/images/{image_id}.png",
            "prompt": prompt
        }

    async def _save_image(self, url: str, image_id: str) -> str:
        """Download and save image locally."""
        async with httpx.AsyncClient() as client:
            response = await client.get(url)
            response.raise_for_status()

            filepath = os.path.join(settings.storage_path, f"{image_id}.png")
            with open(filepath, "wb") as f:
                f.write(response.content)

            return filepath

    def _save_metadata(
        self,
        image_id: str,
        prompt: str,
        aspect_ratio: str,
        filepath: str
    ):
        """Save image metadata to JSON file."""
        metadata_file = os.path.join(settings.storage_path, "metadata.json")

        # Load existing metadata
        if os.path.exists(metadata_file):
            with open(metadata_file, "r") as f:
                metadata = json.load(f)
        else:
            metadata = []

        # Add new entry
        metadata.append({
            "id": image_id,
            "prompt": prompt,
            "aspect_ratio": aspect_ratio,
            "filepath": filepath,
            "created_at": datetime.utcnow().isoformat()
        })

        # Save updated metadata
        with open(metadata_file, "w") as f:
            json.dump(metadata, f, indent=2)

    def enhance_prompt(self, prompt: str, style: Optional[str] = None) -> str:
        """Enhance a simple prompt with quality keywords."""
        enhancements = [
            "highly detailed",
            "professional quality",
            "beautiful lighting"
        ]

        style_keywords = {
            "photorealistic": "photorealistic, 8k, professional photography",
            "anime": "anime style, vibrant colors, detailed illustration",
            "watercolor": "watercolor painting, soft colors, artistic",
            "digital_art": "digital art, vibrant, modern",
            "fantasy": "fantasy art, magical, ethereal"
        }

        enhanced = prompt

        if style and style in style_keywords:
            enhanced = f"{prompt}, {style_keywords[style]}"
        else:
            enhanced = f"{prompt}, {', '.join(enhancements)}"

        return enhanced

--- END OF FILE ---

--- FILE: backend/app/services/providers/replicate_provider.py ---
import asyncio
from typing import Optional

from app.config import get_settings
from app.services.providers.base import ImageProvider, GenerationResult

settings = get_settings()

COST_MAP = {
    "black-forest-labs/flux-schnell": 0.003,
    "black-forest-labs/flux-1.1-pro": 0.055,
    "black-forest-labs/flux-redux-schnell": 0.003,
    "stability-ai/sdxl": 0.004,
}


class ReplicateProvider(ImageProvider):
    provider_name = "replicate"

    def __init__(self):
        self.token = settings.replicate_api_token
        self.client = None

    def _get_client(self):
        if self.client is None and self.token:
            import replicate
            self.client = replicate.Client(api_token=self.token)
        return self.client

    def is_configured(self) -> bool:
        return bool(self.token)

    def get_available_models(self) -> list:
        return [
            {"id": "black-forest-labs/flux-schnell", "name": "Flux Schnell", "description": "Fast, high quality"},
            {"id": "black-forest-labs/flux-1.1-pro", "name": "Flux 1.1 Pro", "description": "Best quality, slower"},
            {"id": "stability-ai/sdxl", "name": "SDXL", "description": "Stable Diffusion XL"},
        ]

    async def generate(
        self,
        prompt: str,
        model: Optional[str] = None,
        aspect_ratio: str = "1:1",
        width: int = 1024,
        height: int = 1024,
        **kwargs,
    ) -> GenerationResult:
        model_id = model or "black-forest-labs/flux-schnell"

        if "flux" in model_id:
            input_params = {
                "prompt": prompt,
                "num_outputs": 1,
                "aspect_ratio": aspect_ratio,
                "output_format": "webp",
                "output_quality": 90,
            }
        else:
            input_params = {
                "prompt": prompt,
                "width": width,
                "height": height,
                "num_outputs": 1,
            }

        # Allow per-request token override
        auth_token = kwargs.get("auth_token")
        client = None
        if auth_token:
            try:
                import replicate

                client = replicate.Client(api_token=auth_token)
            except Exception:
                client = None

        if client is None:
            client = self._get_client()

        if not client:
            raise RuntimeError("Replicate client not configured")

        # Run in thread pool since replicate client is synchronous
        output = await asyncio.to_thread(
            client.run,
            model_id,
            input=input_params,
        )

        image_url = output[0] if isinstance(output, list) else str(output)

        return GenerationResult(
            image_url=image_url,
            provider=self.provider_name,
            model=model_id,
            cost_estimate=COST_MAP.get(model_id, 0.003),
        )

--- END OF FILE ---

--- FILE: backend/app/services/providers/__init__.py ---
_providers = {}

FAILOVER_ORDER = ["replicate", "gemini", "openai"]


def init_providers():
    """Initialize all providers. Call on app startup."""
    provider_classes = []

    try:
        from app.services.providers.replicate_provider import ReplicateProvider
        provider_classes.append(ReplicateProvider)
    except Exception as e:
        print(f"[startup] Replicate provider unavailable: {e}")

    try:
        from app.services.providers.openai_provider import OpenAIProvider
        provider_classes.append(OpenAIProvider)
    except Exception as e:
        print(f"[startup] OpenAI provider unavailable: {e}")

    try:
        from app.services.providers.gemini_provider import GeminiProvider
        provider_classes.append(GeminiProvider)
    except Exception as e:
        print(f"[startup] Gemini provider unavailable: {e}")

    for ProviderClass in provider_classes:
        provider = ProviderClass()
        if provider.is_configured():
            _providers[provider.provider_name] = provider
            print(f"[startup] Provider configured: {provider.provider_name}")

    if not _providers:
        print("[startup] WARNING: No AI providers configured. Set API keys in .env")


def get_provider(name: str):
    return _providers.get(name)


def get_all_providers():
    return _providers


def get_configured_provider_names():
    return list(_providers.keys())

--- END OF FILE ---

--- FILE: backend/app/services/providers/openai_provider.py ---
import httpx
from typing import Optional

from app.config import get_settings
from app.services.providers.base import ImageProvider, GenerationResult

settings = get_settings()

COST_MAP = {
    "dall-e-3": 0.04,
    "dall-e-3-hd": 0.08,
    "dall-e-2": 0.02,
}

SIZE_MAP = {
    "1:1": "1024x1024",
    "4:3": "1024x1024",
    "3:2": "1792x1024",
}


class OpenAIProvider(ImageProvider):
    provider_name = "openai"

    def __init__(self):
        self.api_key = settings.openai_api_key

    def is_configured(self) -> bool:
        return bool(self.api_key)

    def get_available_models(self) -> list:
        return [
            {"id": "dall-e-3", "name": "DALL-E 3", "description": "Latest model, high quality"},
            {"id": "dall-e-2", "name": "DALL-E 2", "description": "Supports variations"},
        ]

    async def generate(
        self,
        prompt: str,
        model: Optional[str] = None,
        aspect_ratio: str = "1:1",
        width: int = 1024,
        height: int = 1024,
        **kwargs,
    ) -> GenerationResult:
        model_id = model or "dall-e-3"
        size = SIZE_MAP.get(aspect_ratio, "1024x1024")
        quality = kwargs.get("quality", "standard")

        token = kwargs.get("auth_token") or self.api_key

        async with httpx.AsyncClient(timeout=120.0) as client:
            response = await client.post(
                "https://api.openai.com/v1/images/generations",
                headers={
                    "Authorization": f"Bearer {token}" if token else "",
                    "Content-Type": "application/json",
                },
                json={
                    "model": model_id,
                    "prompt": prompt,
                    "n": 1,
                    "size": size,
                    "quality": quality,
                    "response_format": "url",
                },
            )

            if response.status_code != 200:
                error = response.json()
                raise Exception(error.get("error", {}).get("message", f"OpenAI API error: {response.status_code}"))

            data = response.json()

        cost_key = f"{model_id}-hd" if quality == "hd" else model_id

        return GenerationResult(
            image_url=data["data"][0]["url"],
            provider=self.provider_name,
            model=model_id,
            cost_estimate=COST_MAP.get(cost_key, 0.04),
            metadata={"revised_prompt": data["data"][0].get("revised_prompt")},
        )

--- END OF FILE ---

--- FILE: backend/app/services/providers/gemini_provider.py ---
from __future__ import annotations

import httpx
import base64
import uuid
import os
from typing import Optional

from app.config import get_settings
from app.services.providers.base import ImageProvider, GenerationResult

settings = get_settings()


class GeminiProvider(ImageProvider):
    provider_name = "gemini"

    def __init__(self):
        self.api_key = settings.gemini_api_key

    def is_configured(self) -> bool:
        return bool(self.api_key)

    def get_available_models(self) -> list:
        return [
            {"id": "gemini-2.0-flash-exp-image-generation", "name": "Gemini 2.0 Flash", "description": "Native image generation"},
            {"id": "imagen-3.0-generate-002", "name": "Imagen 3", "description": "High quality Google model"},
            {"id": "imagen-3.0-fast-generate-001", "name": "Imagen 3 Fast", "description": "Faster generation"},
        ]

    async def generate(
        self,
        prompt: str,
        model: Optional[str] = None,
        aspect_ratio: str = "1:1",
        width: int = 1024,
        height: int = 1024,
        **kwargs,
    ) -> GenerationResult:
        model_id = model or "gemini-2.0-flash-exp-image-generation"

        if model_id.startswith("imagen"):
            return await self._generate_imagen(prompt, model_id, aspect_ratio)
        else:
            return await self._generate_native(prompt, model_id)

    async def _generate_native(self, prompt: str, model_id: str) -> GenerationResult:
        """Gemini 2.0 native image generation."""
        url = f"https://generativelanguage.googleapis.com/v1beta/models/{model_id}:generateContent?key={self.api_key}"

        request_body = {
            "contents": [{"parts": [{"text": f"Generate {prompt}"}]}],
            "generationConfig": {
                "response_modalities": ["Text", "Image"],
            },
        }

        async with httpx.AsyncClient(timeout=120.0) as client:
            response = await client.post(url, json=request_body)

            if response.status_code != 200:
                error = response.json()
                raise Exception(error.get("error", {}).get("message", f"Gemini API error: {response.status_code}"))

            data = response.json()

        # Extract image from response
        image_base64 = None
        for candidate in data.get("candidates", []):
            for part in candidate.get("content", {}).get("parts", []):
                if part.get("inlineData", {}).get("mimeType", "").startswith("image/"):
                    image_base64 = part["inlineData"]["data"]
                    break
            if image_base64:
                break

        if not image_base64:
            raise Exception("No image generated. Try a different prompt.")

        # Save base64 to file and return local URL
        image_url = self._save_base64_image(image_base64)

        return GenerationResult(
            image_url=image_url,
            provider=self.provider_name,
            model=model_id,
            cost_estimate=0.0,  # Free during preview
        )

    async def _generate_imagen(self, prompt: str, model_id: str, aspect_ratio: str) -> GenerationResult:
        """Google Imagen API."""
        url = f"https://generativelanguage.googleapis.com/v1beta/models/{model_id}:predict"

        request_body = {
            "instances": [{"prompt": prompt}],
            "parameters": {
                "sampleCount": 1,
                "aspectRatio": aspect_ratio,
                "safetyFilterLevel": "block_few",
                "personGeneration": "allow_adult",
                "outputOptions": {"mimeType": "image/png"},
            },
        }

        async with httpx.AsyncClient(timeout=120.0) as client:
            response = await client.post(
                url,
                headers={
                    "Authorization": f"Bearer {self.api_key}",
                    "Content-Type": "application/json",
                    "x-goog-api-key": self.api_key,
                },
                json=request_body,
            )

            if response.status_code != 200:
                error = response.json()
                raise Exception(error.get("error", {}).get("message", f"Imagen API error: {response.status_code}"))

            data = response.json()

        image_data = (
            data.get("predictions", [{}])[0].get("bytesBase64Encoded")
            or data.get("predictions", [{}])[0].get("image", {}).get("bytesBase64Encoded")
        )

        if not image_data:
            raise Exception("No image returned from Imagen API")

        image_url = self._save_base64_image(image_data)

        cost = 0.02 if "fast" not in model_id else 0.01

        return GenerationResult(
            image_url=image_url,
            provider=self.provider_name,
            model=model_id,
            cost_estimate=cost,
        )

    def _save_base64_image(self, base64_data: str) -> str:
        """Save base64 image data to file and return the local path."""
        image_id = str(uuid.uuid4())[:8]
        filepath = os.path.join(settings.storage_path, f"{image_id}.png")
        os.makedirs(settings.storage_path, exist_ok=True)

        with open(filepath, "wb") as f:
            f.write(base64.b64decode(base64_data))

        return f"/images/{image_id}.png"

--- END OF FILE ---

--- FILE: backend/app/services/providers/base.py ---
from abc import ABC, abstractmethod
from dataclasses import dataclass, field
from typing import Optional


@dataclass
class GenerationResult:
    image_url: str
    provider: str
    model: str
    cost_estimate: float = 0.0
    duration_ms: int = 0
    metadata: dict = field(default_factory=dict)


class ImageProvider(ABC):
    provider_name: str = ""

    @abstractmethod
    async def generate(
        self,
        prompt: str,
        model: Optional[str] = None,
        aspect_ratio: str = "1:1",
        width: int = 1024,
        height: int = 1024,
        **kwargs,
    ) -> GenerationResult:
        pass

    @abstractmethod
    def is_configured(self) -> bool:
        pass

    @abstractmethod
    def get_available_models(self) -> list:
        pass

--- END OF FILE ---

--- FILE: src/AppRouter.jsx ---
import { Routes, Route, Navigate } from 'react-router-dom'
import { AuthProvider, useAuth } from './hooks/useAuth.jsx'
import Layout from './components/Layout'
import Dashboard from './pages/Dashboard'
import MainImageGenerator from './pages/MainImageGenerator'
import SecondaryImageGenerator from './pages/SecondaryImageGenerator'
import CreativeCampaigns from './pages/CreativeCampaigns'
import ListingCopywriter from './pages/ListingCopywriter'
import APlusContent from './pages/APlusContent'
import BrandStory from './pages/BrandStory'
import StorefrontDesigner from './pages/StorefrontDesigner'
import Login from './pages/Login'
import App from './App' // Original app as legacy

function ProtectedRoute({ children }) {
  const { isAuthenticated, loading } = useAuth()

  if (loading) {
    return (
      <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', height: '100vh', background: '#0a0a0f', color: '#fff' }}>
        Loading...
      </div>
    )
  }

  if (!isAuthenticated) {
    return <Navigate to="/login" replace />
  }

  return children
}

function AppRouter() {
  return (
    <AuthProvider>
      <Routes>
        <Route path="/login" element={<Login />} />
        <Route
          path="/"
          element={
            <ProtectedRoute>
              <Layout />
            </ProtectedRoute>
          }
        >
          <Route index element={<Dashboard />} />
          <Route path="dashboard" element={<Dashboard />} />
          <Route path="tools/main-image-generator" element={<MainImageGenerator />} />
          <Route path="tools/secondary-images" element={<SecondaryImageGenerator />} />
          <Route path="tools/creative-campaigns" element={<CreativeCampaigns />} />
          <Route path="tools/listing-copywriter" element={<ListingCopywriter />} />
          <Route path="tools/aplus-content" element={<APlusContent />} />
          <Route path="tools/brand-story" element={<BrandStory />} />
          <Route path="tools/storefront" element={<StorefrontDesigner />} />
          <Route path="legacy" element={<App />} />
        </Route>
      </Routes>
    </AuthProvider>
  )
}

export default AppRouter

--- END OF FILE ---

--- FILE: src/App.css ---
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  --bg-primary: #0a0a0b;
  --bg-secondary: #141416;
  --bg-tertiary: #1c1c1f;
  --border: #3a3a3d;
  --text-primary: #ffffff;
  --text-secondary: #c0c0c5;
  --text-muted: #8b8b90;
  --accent: #ff9900;
  --accent-hover: #ffad33;
  --success: #22c55e;
  --error: #ef4444;
  --amazon-orange: #ff9900;
  --amazon-blue: #232f3e;
  --radius: 8px;
  --radius-lg: 12px;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  min-height: 100vh;
}

.app {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

/* Header */
.header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 24px;
  border-bottom: 1px solid var(--border);
  background: var(--bg-secondary);
}

.header h1 {
  font-size: 1.25rem;
  font-weight: 600;
}

.tabs {
  display: flex;
  gap: 4px;
  background: var(--bg-tertiary);
  padding: 4px;
  border-radius: var(--radius);
}

.tab {
  padding: 8px 16px;
  border: none;
  background: transparent;
  color: var(--text-secondary);
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  border-radius: 6px;
  transition: all 0.15s ease;
}

.tab:hover {
  color: var(--text-primary);
}

.tab.active {
  background: var(--accent);
  color: white;
}

/* Main Layout */
.main {
  display: flex;
  flex: 1;
  overflow: hidden;
}

.sidebar {
  width: 320px;
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  background: var(--bg-secondary);
}

.content {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  background: var(--bg-primary);
}

.gallery-main {
  padding: 24px;
  overflow-y: auto;
}

/* Prompt Input */
.prompt-section {
  padding: 20px;
  border-bottom: 1px solid var(--border);
}

.prompt-section h2 {
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
  margin-bottom: 12px;
}

.prompt-textarea {
  width: 100%;
  min-height: 120px;
  padding: 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 0.875rem;
  resize: vertical;
  transition: border-color 0.15s ease;
}

.prompt-textarea:focus {
  outline: none;
  border-color: var(--accent);
}

.prompt-textarea::placeholder {
  color: var(--text-muted);
}

/* Product Identity Section */
.product-identity {
  background: linear-gradient(135deg, rgba(255, 153, 0, 0.05) 0%, transparent 100%);
  border-radius: var(--radius);
  margin-bottom: 8px;
}

.product-inputs {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.input-field {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.input-field label {
  font-size: 0.75rem;
  font-weight: 500;
  color: var(--text-secondary);
}

.product-input {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 0.875rem;
  transition: border-color 0.15s ease;
}

.product-input:focus {
  outline: none;
  border-color: var(--accent);
}

.product-input::placeholder {
  color: var(--text-muted);
}

.product-input:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.asin-input {
  font-family: 'Monaco', 'Consolas', monospace;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.generate-btn {
  width: 100%;
  margin-top: 12px;
  padding: 12px;
  background: var(--accent);
  border: none;
  border-radius: var(--radius);
  color: white;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.15s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.generate-btn:hover:not(:disabled) {
  background: var(--accent-hover);
}

.generate-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Templates */
.templates {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 12px;
}

.template-btn {
  padding: 6px 10px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: 20px;
  color: var(--text-secondary);
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.template-btn:hover {
  border-color: var(--accent);
  color: var(--text-primary);
}

/* History */
.history-section {
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.history-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  border-bottom: 1px solid var(--border);
}

.history-header h2 {
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
}

.clear-btn {
  padding: 4px 8px;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--text-muted);
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.clear-btn:hover {
  border-color: var(--error);
  color: var(--error);
}

.history-list {
  flex: 1;
  overflow-y: auto;
  padding: 12px;
}

.history-item {
  display: flex;
  gap: 12px;
  padding: 10px;
  border-radius: var(--radius);
  cursor: pointer;
  transition: background 0.15s ease;
  margin-bottom: 8px;
}

.history-item:hover {
  background: var(--bg-tertiary);
}

.history-item.active {
  background: var(--bg-tertiary);
  border: 1px solid var(--accent);
}

.history-thumb {
  width: 48px;
  height: 48px;
  border-radius: 6px;
  object-fit: cover;
  flex-shrink: 0;
}

.history-info {
  flex: 1;
  min-width: 0;
}

.history-prompt {
  font-size: 0.8125rem;
  color: var(--text-primary);
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  line-height: 1.4;
}

.history-time {
  font-size: 0.6875rem;
  color: var(--text-muted);
}

.history-meta {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 4px;
}

.history-empty {
  padding: 40px 20px;
  text-align: center;
  color: var(--text-muted);
  font-size: 0.875rem;
}

/* Image Display */
.image-display {
  max-width: 800px;
  width: 100%;
}

.image-container {
  position: relative;
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  overflow: hidden;
  aspect-ratio: 1;
  display: flex;
  align-items: center;
  justify-content: center;
}

.generated-image {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

.image-placeholder {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16px;
  color: var(--text-muted);
}

.image-placeholder svg {
  opacity: 0.3;
}

.image-placeholder p {
  font-size: 0.875rem;
}

.placeholder-hint {
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-top: -8px;
}

.image-info {
  display: flex;
  gap: 8px;
  justify-content: center;
  margin-top: 12px;
}

.category-badge {
  display: inline-block;
  padding: 2px 8px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: 4px;
  font-size: 0.6875rem;
  color: var(--text-secondary);
}

.provider-badge {
  display: inline-block;
  padding: 2px 8px;
  background: rgba(99, 102, 241, 0.1);
  border: 1px solid rgba(99, 102, 241, 0.3);
  border-radius: 4px;
  font-size: 0.6875rem;
  color: #818cf8;
  text-transform: uppercase;
}

.image-actions {
  display: flex;
  gap: 8px;
  margin-top: 16px;
  justify-content: center;
}

.action-btn {
  padding: 10px 16px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.15s ease;
  display: flex;
  align-items: center;
  gap: 6px;
}

.action-btn:hover {
  border-color: var(--accent);
}

.action-btn.favorited {
  background: var(--accent);
  border-color: var(--accent);
}

.image-prompt {
  margin-top: 16px;
  padding: 12px;
  background: var(--bg-secondary);
  border-radius: var(--radius);
  font-size: 0.8125rem;
  color: var(--text-secondary);
  text-align: center;
}

/* Loading Spinner */
.spinner {
  width: 48px;
  height: 48px;
  border: 3px solid var(--border);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.loading-text {
  margin-top: 16px;
  color: var(--text-secondary);
  font-size: 0.875rem;
}

/* Error */
.error-message {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  color: var(--error);
}

.error-message p {
  font-size: 0.875rem;
}

/* Gallery */
.gallery {
  width: 100%;
}

.gallery h2 {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 24px;
}

.gallery-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
}

.gallery-card {
  background: var(--bg-secondary);
  border-radius: var(--radius-lg);
  overflow: hidden;
  border: 1px solid var(--border);
  transition: border-color 0.15s ease;
}

.gallery-card:hover {
  border-color: var(--accent);
}

.gallery-image {
  width: 100%;
  aspect-ratio: 1;
  object-fit: cover;
  cursor: pointer;
}

.gallery-card-info {
  padding: 12px;
}

.gallery-card-prompt {
  font-size: 0.8125rem;
  color: var(--text-secondary);
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  line-height: 1.4;
}

.gallery-card-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: 8px;
}

.gallery-card-time {
  font-size: 0.6875rem;
  color: var(--text-muted);
}

.remove-btn {
  padding: 4px 8px;
  background: transparent;
  border: none;
  color: var(--text-muted);
  font-size: 0.75rem;
  cursor: pointer;
  transition: color 0.15s ease;
}

.remove-btn:hover {
  color: var(--error);
}

.gallery-empty {
  text-align: center;
  padding: 60px 20px;
  color: var(--text-muted);
}

.gallery-empty p {
  font-size: 0.875rem;
  margin-top: 16px;
}

/* Footer */
.footer {
  display: flex;
  gap: 20px;
  justify-content: center;
  padding: 12px;
  border-top: 1px solid var(--border);
  background: var(--bg-secondary);
}

.shortcut {
  font-size: 0.75rem;
  color: var(--text-muted);
  display: flex;
  align-items: center;
  gap: 6px;
}

.shortcut kbd {
  padding: 2px 6px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: 4px;
  font-family: inherit;
  font-size: 0.6875rem;
}

/* Scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: var(--bg-secondary);
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-muted);
}

/* Header Brand */
.header-brand {
  display: flex;
  align-items: center;
  gap: 10px;
}

.badge {
  padding: 2px 8px;
  background: var(--amazon-orange);
  color: var(--amazon-blue);
  font-size: 0.625rem;
  font-weight: 700;
  border-radius: 4px;
  text-transform: uppercase;
}

/* Section Groups */
.section-group {
  margin-bottom: 16px;
}

.section-group:last-of-type {
  margin-bottom: 0;
}

/* Image Type Grid */
.image-type-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
}

.image-type-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.image-type-btn:hover {
  border-color: var(--accent);
  color: var(--text-primary);
}

.image-type-btn.active {
  background: var(--accent);
  border-color: var(--accent);
  color: white;
}

/* Main Image Templates */
.main-templates-section {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.05) 0%, transparent 100%);
  border-radius: var(--radius);
  padding: 16px;
  margin: -4px -4px 8px -4px;
}

.main-template-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
}

.main-template-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 12px 8px;
  background: var(--bg-tertiary);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.15s ease;
  text-align: center;
}

.main-template-btn:hover {
  border-color: var(--success);
  color: var(--text-primary);
  background: rgba(34, 197, 94, 0.1);
}

.main-template-btn.active {
  background: rgba(34, 197, 94, 0.15);
  border-color: var(--success);
  color: var(--success);
}

.main-template-btn .template-label {
  font-size: 0.75rem;
  font-weight: 600;
  margin-top: 2px;
}

.main-template-btn .template-desc {
  font-size: 0.65rem;
  color: var(--text-muted);
  line-height: 1.2;
}

.main-template-btn.active .template-desc {
  color: var(--text-secondary);
}

/* Aspect Ratio Selector */
.aspect-ratio-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}

.aspect-ratio-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  padding: 12px 8px;
  background: var(--bg-tertiary);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.15s ease;
}

.aspect-ratio-btn:hover {
  border-color: var(--accent);
  color: var(--text-primary);
}

.aspect-ratio-btn.active {
  background: rgba(255, 153, 0, 0.1);
  border-color: var(--accent);
  color: var(--accent);
}

.aspect-ratio-btn.recommended.active {
  background: rgba(34, 197, 94, 0.1);
  border-color: var(--success);
  color: var(--success);
}

.ratio-preview {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: 4px;
}

.ratio-1-1 {
  width: 32px;
  height: 32px;
}

.ratio-4-3 {
  width: 32px;
  height: 24px;
}

.ratio-3-2 {
  width: 36px;
  height: 24px;
}

.aspect-ratio-btn.active .ratio-preview {
  background: currentColor;
  opacity: 0.3;
  border-color: currentColor;
}

.ratio-info {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
}

.ratio-label {
  font-size: 0.7rem;
  font-weight: 600;
}

.ratio-badge {
  font-size: 0.55rem;
  padding: 2px 6px;
  background: var(--success);
  color: white;
  border-radius: 10px;
  text-transform: uppercase;
  font-weight: 600;
}

.aspect-ratio-tip {
  font-size: 0.7rem;
  color: var(--text-muted);
  margin-top: 8px;
  text-align: center;
}

.image-type-btn span {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.type-hint {
  margin-top: 8px;
  font-size: 0.6875rem;
  color: var(--text-muted);
  font-style: italic;
}

/* Category Select */
.category-select {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.875rem;
  cursor: pointer;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%236b6b70' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
}

.category-select:focus {
  outline: none;
  border-color: var(--accent);
}

.category-select option {
  background: var(--bg-secondary);
  color: var(--text-primary);
}

/* Amazon Tip */
.amazon-tip {
  margin-top: 12px;
  padding: 10px 12px;
  background: rgba(255, 153, 0, 0.1);
  border: 1px solid rgba(255, 153, 0, 0.3);
  border-radius: var(--radius);
  font-size: 0.6875rem;
  color: var(--amazon-orange);
  line-height: 1.4;
}

.amazon-tip strong {
  display: block;
  margin-bottom: 4px;
}

/* Image Type Badge in History/Gallery */
.type-badge {
  display: inline-block;
  padding: 2px 6px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: 4px;
  font-size: 0.625rem;
  color: var(--text-muted);
  text-transform: uppercase;
  margin-top: 4px;
}

/* Wider sidebar for more controls */
.sidebar {
  width: 380px;
  overflow-y: auto;
}

.prompt-section {
  padding: 16px;
  border-bottom: 1px solid var(--border);
  overflow-y: auto;
  max-height: 65vh;
}

/* Smaller textarea for Amazon version */
.prompt-textarea {
  min-height: 80px;
}

/* Templates adjustment */
.templates {
  margin-top: 8px;
}

/* Spin animation for loader */
.spin {
  animation: spin 1s linear infinite;
}

/* Session Panel */
.session-panel {
  padding: 16px;
  border-bottom: 1px solid var(--border);
  background: var(--bg-tertiary);
}

.session-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
}

.session-header h2 {
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
}

.calendar-connect-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--text-muted);
  font-size: 0.6875rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.calendar-connect-btn:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.active-session {
  text-align: center;
}

.session-timer {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-bottom: 8px;
}

.timer-icon {
  color: var(--success);
}

.timer-icon.pulse {
  animation: pulse 2s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.timer-value {
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--text-primary);
}

.session-project {
  font-size: 0.8125rem;
  color: var(--text-secondary);
  margin-bottom: 8px;
}

.session-live-stats {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-bottom: 12px;
}

.live-stat {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 0.75rem;
  color: var(--text-muted);
}

.start-session {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.project-input {
  width: 100%;
  padding: 8px 12px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.8125rem;
}

.project-input:focus {
  outline: none;
  border-color: var(--accent);
}

.project-input::placeholder {
  color: var(--text-muted);
}

.session-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 10px;
  border: none;
  border-radius: var(--radius);
  font-size: 0.8125rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
}

.session-btn.start {
  background: var(--success);
  color: white;
}

.session-btn.start:hover {
  background: #1db954;
}

.session-btn.stop {
  background: var(--error);
  color: white;
}

.session-btn.stop:hover {
  background: #dc2626;
}

.session-stats {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--border);
}

.session-stats h3 {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.6875rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
  margin-bottom: 12px;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
}

.stat-item {
  text-align: center;
  padding: 8px;
  background: var(--bg-secondary);
  border-radius: 6px;
}

.stat-item .stat-value {
  font-size: 1rem;
  font-weight: 600;
  color: var(--accent);
}

.stat-item .stat-label {
  font-size: 0.625rem;
  color: var(--text-muted);
  text-transform: uppercase;
}

/* Settings Panel */
.settings-main {
  padding: 24px;
  overflow-y: auto;
}

.settings-panel {
  max-width: 800px;
  margin: 0 auto;
}

.settings-section {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 20px;
  margin-bottom: 20px;
}

.settings-section h3 {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 16px;
  color: var(--text-primary);
}

.section-desc {
  font-size: 0.8125rem;
  color: var(--text-secondary);
  margin-bottom: 16px;
  line-height: 1.5;
}

.api-status {
  background: var(--bg-tertiary);
  border-radius: var(--radius);
  padding: 16px;
}

.status-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
}

.status-label {
  font-size: 0.8125rem;
  color: var(--text-muted);
}

.status-value {
  font-size: 0.8125rem;
  font-weight: 500;
}

.status-value.connected {
  color: var(--success);
}

.status-value.not-connected {
  color: var(--text-muted);
}

.demo-notice {
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-top: 12px;
  padding: 8px;
  background: var(--bg-secondary);
  border-radius: 4px;
}

.config-notice {
  font-size: 0.75rem;
  color: var(--text-muted);
  padding: 12px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
}

.validate-btn,
.connect-calendar-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-top: 12px;
  padding: 8px 16px;
  background: var(--accent);
  border: none;
  border-radius: var(--radius);
  color: white;
  font-size: 0.8125rem;
  cursor: pointer;
  transition: background 0.15s ease;
}

.validate-btn:hover,
.connect-calendar-btn:hover {
  background: var(--accent-hover);
}

.validate-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.validation-result {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-top: 12px;
  padding: 8px 12px;
  border-radius: var(--radius);
  font-size: 0.8125rem;
}

.validation-result.valid {
  background: rgba(34, 197, 94, 0.1);
  color: var(--success);
}

.validation-result.invalid {
  background: rgba(239, 68, 68, 0.1);
  color: var(--error);
}

.calendar-connected {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px;
  background: rgba(34, 197, 94, 0.1);
  border-radius: var(--radius);
  color: var(--success);
  font-size: 0.8125rem;
}

.disconnect-btn {
  margin-left: auto;
  padding: 4px 8px;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--text-muted);
  font-size: 0.75rem;
  cursor: pointer;
}

.disconnect-btn:hover {
  border-color: var(--error);
  color: var(--error);
}

/* Export Grid */
.export-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
}

.export-group {
  background: var(--bg-tertiary);
  border-radius: var(--radius);
  padding: 16px;
}

.export-group h4 {
  font-size: 0.8125rem;
  font-weight: 500;
  margin-bottom: 12px;
  color: var(--text-primary);
}

.export-buttons {
  display: flex;
  gap: 8px;
  margin-bottom: 8px;
}

.export-btn {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  padding: 8px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.export-btn:hover:not(:disabled) {
  border-color: var(--accent);
  color: var(--text-primary);
}

.export-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.export-btn.exporting {
  background: var(--accent);
  border-color: var(--accent);
  color: white;
}

.export-count {
  font-size: 0.6875rem;
  color: var(--text-muted);
}

/* Danger Zone */
.danger-zone {
  border-color: rgba(239, 68, 68, 0.3);
}

.danger-zone h3 {
  color: var(--error);
}

.clear-data-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 16px;
  background: transparent;
  border: 1px solid var(--error);
  border-radius: var(--radius);
  color: var(--error);
  font-size: 0.8125rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.clear-data-btn:hover {
  background: var(--error);
  color: white;
}

.danger-warning {
  margin-top: 8px;
  font-size: 0.75rem;
  color: var(--text-muted);
}

/* Session indicator in footer */
.session-indicator {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 4px 10px;
  background: rgba(34, 197, 94, 0.1);
  border-radius: 20px;
  font-size: 0.75rem;
  color: var(--success);
}

.session-dot {
  width: 6px;
  height: 6px;
  background: var(--success);
  border-radius: 50%;
  animation: pulse 2s ease-in-out infinite;
}

/* Progress bar for loading */
.progress-container {
  width: 100%;
  margin-top: 16px;
}

.progress-bar {
  height: 4px;
  background: var(--bg-tertiary);
  border-radius: 2px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: var(--accent);
  transition: width 0.3s ease;
}

.progress-message {
  margin-top: 8px;
  font-size: 0.75rem;
  color: var(--text-muted);
  text-align: center;
}

/* Reference Image Upload */
.reference-upload-section {
  padding: 16px;
  border-bottom: 1px solid var(--border);
}

.reference-upload-section .section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
}

.reference-upload-section .section-header h2 {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
}

.image-count {
  font-size: 0.6875rem;
  color: var(--text-muted);
  background: var(--bg-tertiary);
  padding: 2px 8px;
  border-radius: 10px;
}

.drop-zone {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 24px 16px;
  background: var(--bg-tertiary);
  border: 2px dashed var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
}

.drop-zone:hover:not(.disabled) {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.05);
}

.drop-zone.dragging {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.1);
}

.drop-zone.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.drop-zone p {
  margin-top: 8px;
  font-size: 0.8125rem;
  color: var(--text-secondary);
}

.drop-hint {
  font-size: 0.6875rem;
  color: var(--text-muted);
  margin-top: 4px;
}

.upload-error {
  margin-top: 8px;
  font-size: 0.75rem;
  color: var(--error);
}

/* Reference Images List */
.reference-images-list {
  margin-top: 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.reference-image-item {
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  border-left: 3px solid var(--tag-color);
  overflow: hidden;
}

.reference-image-item.expanded {
  border-color: var(--tag-color);
}

.ref-image-main {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px;
}

.ref-image-reorder {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
}

.reorder-btn {
  width: 20px;
  height: 16px;
  background: transparent;
  border: none;
  color: var(--text-muted);
  font-size: 0.5rem;
  cursor: pointer;
  padding: 0;
  line-height: 1;
}

.reorder-btn:hover:not(:disabled) {
  color: var(--accent);
}

.reorder-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.ref-order {
  font-size: 0.625rem;
  color: var(--text-muted);
  font-weight: 600;
}

.ref-image-preview {
  position: relative;
  width: 48px;
  height: 48px;
  flex-shrink: 0;
}

.ref-image-preview img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 4px;
}

.ref-tag-indicator {
  position: absolute;
  bottom: 2px;
  right: 2px;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  border: 2px solid var(--bg-tertiary);
}

.ref-image-info {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.ref-image-name {
  font-size: 0.75rem;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.ref-image-strength {
  font-size: 0.625rem;
  color: var(--tag-color);
  font-weight: 600;
}

.ref-image-actions {
  display: flex;
  gap: 4px;
}

.ref-action-btn {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.15s ease;
}

.ref-action-btn:hover:not(:disabled) {
  border-color: var(--accent);
  color: var(--accent);
}

.ref-action-btn.remove:hover:not(:disabled) {
  border-color: var(--error);
  color: var(--error);
}

.ref-action-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Reference Image Controls */
.ref-image-controls {
  padding: 12px;
  background: var(--bg-secondary);
  border-top: 1px solid var(--border);
}

.ref-image-controls .control-group {
  margin-bottom: 12px;
}

.ref-image-controls .control-group:last-child {
  margin-bottom: 0;
}

.ref-image-controls label {
  display: block;
  font-size: 0.6875rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.03em;
  color: var(--text-muted);
  margin-bottom: 6px;
}

.strength-slider {
  display: flex;
  align-items: center;
  gap: 10px;
}

.strength-slider input[type="range"] {
  flex: 1;
  height: 4px;
  -webkit-appearance: none;
  appearance: none;
  background: var(--bg-tertiary);
  border-radius: 2px;
  outline: none;
}

.strength-slider input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 14px;
  height: 14px;
  background: var(--accent);
  border-radius: 50%;
  cursor: pointer;
}

.strength-slider input[type="range"]::-moz-range-thumb {
  width: 14px;
  height: 14px;
  background: var(--accent);
  border-radius: 50%;
  cursor: pointer;
  border: none;
}

.strength-value {
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--accent);
  min-width: 35px;
  text-align: right;
}

.tag-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.tag-btn {
  padding: 4px 10px;
  border: 1px solid var(--tag-color);
  border-radius: 20px;
  font-size: 0.6875rem;
  color: var(--tag-color);
  background: transparent;
  cursor: pointer;
  transition: all 0.15s ease;
}

.tag-btn:hover:not(:disabled) {
  background: var(--tag-color);
  color: white;
}

.tag-btn.active {
  color: white;
}

.tag-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Style Presets */
.style-presets-section {
  padding: 16px;
  border-bottom: 1px solid var(--border);
}

.style-presets-section .section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
}

.style-presets-section .section-header h2 {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
}

.save-preset-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  background: var(--accent);
  border: none;
  border-radius: 4px;
  color: white;
  font-size: 0.6875rem;
  cursor: pointer;
  transition: background 0.15s ease;
}

.save-preset-btn:hover:not(:disabled) {
  background: var(--accent-hover);
}

.save-preset-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.create-preset-form {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
}

.preset-name-input {
  flex: 1;
  padding: 8px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.8125rem;
}

.preset-name-input:focus {
  outline: none;
  border-color: var(--accent);
}

.preset-form-actions {
  display: flex;
  gap: 4px;
}

.preset-action {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  transition: background 0.15s ease;
}

.preset-action.save {
  background: var(--success);
  color: white;
}

.preset-action.save:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.preset-action.cancel {
  background: var(--bg-tertiary);
  color: var(--text-muted);
}

.preset-action.cancel:hover {
  background: var(--border);
}

/* Presets List */
.presets-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.preset-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
}

.preset-item:hover {
  border-color: var(--accent);
}

.preset-item.active {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.1);
}

.preset-thumbnails {
  display: flex;
  position: relative;
  width: 44px;
  height: 32px;
  flex-shrink: 0;
}

.preset-thumb {
  position: absolute;
  width: 24px;
  height: 24px;
  border-radius: 4px;
  background-size: cover;
  background-position: center;
  border: 2px solid var(--bg-tertiary);
}

.preset-thumb:nth-child(1) { left: 0; }
.preset-thumb:nth-child(2) { left: 10px; }
.preset-thumb:nth-child(3) { left: 20px; }

.preset-more {
  position: absolute;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.5rem;
  color: var(--text-muted);
}

.preset-info {
  flex: 1;
  min-width: 0;
}

.preset-name {
  display: block;
  font-size: 0.8125rem;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.preset-count {
  font-size: 0.625rem;
  color: var(--text-muted);
}

.preset-delete-btn {
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  opacity: 0;
  transition: all 0.15s ease;
}

.preset-item:hover .preset-delete-btn {
  opacity: 1;
}

.preset-delete-btn:hover {
  color: var(--error);
}

.presets-empty {
  text-align: center;
  padding: 20px;
  color: var(--text-muted);
}

.presets-empty p {
  font-size: 0.8125rem;
  margin-top: 8px;
}

.presets-empty span {
  font-size: 0.6875rem;
  display: block;
  margin-top: 4px;
}

/* Prompt Preview */
.prompt-preview {
  margin: 12px 16px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
}

.prompt-preview.expanded {
  border-color: var(--accent);
}

.preview-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 12px;
  cursor: pointer;
  transition: background 0.15s ease;
}

.preview-header:hover {
  background: var(--bg-secondary);
}

.preview-title {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.75rem;
  color: var(--text-secondary);
}

.ref-badge {
  padding: 2px 6px;
  background: var(--accent);
  color: white;
  font-size: 0.5rem;
  font-weight: 600;
  border-radius: 10px;
  margin-left: 4px;
}

.copy-prompt-btn {
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  color: var(--text-muted);
  cursor: pointer;
  transition: color 0.15s ease;
}

.copy-prompt-btn:hover {
  color: var(--accent);
}

.preview-content {
  padding: 12px;
  background: var(--bg-secondary);
  border-top: 1px solid var(--border);
}

.preview-part {
  display: flex;
  gap: 10px;
  margin-bottom: 8px;
  font-size: 0.75rem;
}

.preview-part:last-child {
  margin-bottom: 0;
}

.part-label {
  flex-shrink: 0;
  width: 80px;
  font-weight: 500;
  color: var(--text-muted);
}

.part-content {
  flex: 1;
  color: var(--text-primary);
  padding-left: 8px;
  border-left: 2px solid var(--border);
}

.preview-part.reference .part-content {
  border-left-width: 3px;
}

.part-tag {
  display: inline-block;
  padding: 1px 6px;
  border-radius: 10px;
  font-size: 0.5rem;
  color: white;
  margin-right: 6px;
  text-transform: uppercase;
  font-weight: 600;
}

.part-filename {
  font-size: 0.625rem;
  color: var(--text-muted);
  margin-left: 4px;
}

.preview-note {
  margin-top: 12px;
  padding: 8px;
  background: var(--bg-tertiary);
  border-radius: 4px;
  font-size: 0.625rem;
  color: var(--text-muted);
  line-height: 1.4;
}

/* Responsive */
@media (max-width: 768px) {
  .main {
    flex-direction: column;
  }

  .sidebar {
    width: 100%;
    border-right: none;
    border-bottom: 1px solid var(--border);
    max-height: 60vh;
  }

  .header {
    flex-direction: column;
    gap: 12px;
  }

  .image-type-grid {
    grid-template-columns: repeat(3, 1fr);
  }

  .prompt-section {
    max-height: none;
  }

  .export-grid {
    grid-template-columns: 1fr;
  }

  .stats-grid {
    grid-template-columns: repeat(4, 1fr);
  }
}

--- END OF FILE ---

--- FILE: src/main.jsx ---
import React from 'react'
import ReactDOM from 'react-dom/client'
import { BrowserRouter } from 'react-router-dom'
import AppRouter from './AppRouter'
import './App.css'
import './pages.css'

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <BrowserRouter>
      <AppRouter />
    </BrowserRouter>
  </React.StrictMode>
)

--- END OF FILE ---

--- FILE: src/App.jsx ---
import { useState, useEffect, useCallback } from 'react'
import PromptInput, { MAIN_IMAGE_TEMPLATES, ASPECT_RATIOS } from './components/PromptInput'
import ImageDisplay from './components/ImageDisplay'
import History from './components/History'
import Gallery from './components/Gallery'
import SessionPanel from './components/SessionPanel'
import SettingsPanel from './components/SettingsPanel'
import ReferenceImageUpload from './components/ReferenceImageUpload'
import StylePresets from './components/StylePresets'
import PromptPreview from './components/PromptPreview'
import { generateImage, getProviderInfo } from './api/imageGen'
import { initDatabase, saveImage, getAllImages, getFavoriteImages, put, remove, getAll, clear, getAllPresets, savePreset, deletePreset, getActiveSession } from './services/database'
import { startSession, endSession, updateSessionStats, getSessionStats } from './services/sessionTracker'
import { initGoogleCalendar, signIn, signOut, isSignedIn, createFocusTimeEvent, updateSessionEvent } from './services/calendar'

// Build optimized prompt based on Amazon listing image type
function buildAmazonPrompt(basePrompt, imageType, productCategory, productName, mainTemplate) {
  const categoryContext = productCategory ? `${productCategory} product: ` : ''
  const productContext = productName ? `"${productName}" - ` : ''

  // Get template modifier for main images
  const templateModifier = imageType === 'main' && mainTemplate
    ? MAIN_IMAGE_TEMPLATES.find(t => t.id === mainTemplate)?.promptModifier || ''
    : ''

  const typePrompts = {
    main: `Professional Amazon product photography, ${categoryContext}${productContext}${basePrompt}, ${templateModifier}, pure white background RGB(255,255,255), studio lighting, product centered and filling 85% of frame, high resolution, sharp focus, no text, no logos, no watermarks, commercial product shot`,
    lifestyle: `Lifestyle product photography for Amazon listing, ${categoryContext}${productContext}${basePrompt}, natural setting, product in use, warm lighting, aspirational scene, high quality, professional photography, showing product benefits in real life context`,
    infographic: `Amazon product infographic image, ${categoryContext}${productContext}${basePrompt}, clean layout, feature callouts, benefit highlights, professional design, easy to read, white or light background, product showcase with key features labeled`,
    detail: `Macro product photography for Amazon, ${categoryContext}${productContext}${basePrompt}, extreme close-up detail shot, sharp focus on texture and materials, studio lighting, professional quality, showing craftsmanship and quality`,
    comparison: `Amazon comparison infographic, ${categoryContext}${productContext}${basePrompt}, side by side comparison layout, clear visual difference, professional design, highlighting advantages, clean background`
  }

  return typePrompts[imageType] || basePrompt
}

function App() {
  // Core state
  const [prompt, setPrompt] = useState('')
  const [imageType, setImageType] = useState('main')
  const [productCategory, setProductCategory] = useState('')
  const [productName, setProductName] = useState('')
  const [productAsin, setProductAsin] = useState('')
  const [mainTemplate, setMainTemplate] = useState('hero')
  const [aspectRatio, setAspectRatio] = useState('1:1')
  const [currentImage, setCurrentImage] = useState(null)
  const [isLoading, setIsLoading] = useState(false)
  const [loadingProgress, setLoadingProgress] = useState(null)
  const [error, setError] = useState(null)

  // Data state
  const [history, setHistory] = useState([])
  const [favorites, setFavorites] = useState([])
  const [allImages, setAllImages] = useState([])
  const [allSessions, setAllSessions] = useState([])

  // Reference images state
  const [referenceImages, setReferenceImages] = useState([])
  const [stylePresets, setStylePresets] = useState([])

  // Session state
  const [activeSession, setActiveSession] = useState(null)
  const [sessionStats, setSessionStats] = useState(null)

  // Calendar state
  const [isCalendarConnected, setIsCalendarConnected] = useState(false)
  const [calendarInitialized, setCalendarInitialized] = useState(false)

  // UI state
  const [activeTab, setActiveTab] = useState('generate')
  const [dbReady, setDbReady] = useState(false)

  const providerInfo = getProviderInfo()

  // Initialize database and load data
  useEffect(() => {
    async function init() {
      try {
        await initDatabase()
        setDbReady(true)

        // Load existing data
        const images = await getAllImages()
        const favs = await getFavoriteImages()
        const sessions = await getAll('sessions')
        const stats = await getSessionStats()
        const active = await getActiveSession()
        const presets = await getAllPresets()

        setAllImages(images)
        setHistory(images.slice(0, 50))
        setFavorites(favs)
        setAllSessions(sessions)
        setSessionStats(stats)
        setActiveSession(active)
        setStylePresets(presets || [])

        // Initialize Google Calendar
        const calendarReady = await initGoogleCalendar()
        setCalendarInitialized(calendarReady)
        if (calendarReady && isSignedIn()) {
          setIsCalendarConnected(true)
        }
      } catch (err) {
        console.error('Initialization error:', err)
      }
    }
    init()
  }, [])

  // Handle image generation
  const handleGenerate = useCallback(async () => {
    if (!prompt.trim()) return

    // Auto-start session if none active
    let session = activeSession
    if (!session) {
      session = await startSession(null, productCategory || 'Amazon Listings')
      setActiveSession(session)

      // Create calendar event if connected
      if (isCalendarConnected) {
        try {
          const event = await createFocusTimeEvent(session, {
            title: `Image Generation: ${productCategory || 'Amazon Listings'}`,
            duration: 60
          })
          session.calendarEventId = event.id
          await put('sessions', session)
        } catch (err) {
          console.warn('Failed to create calendar event:', err)
        }
      }
    }

    setIsLoading(true)
    setError(null)
    setLoadingProgress({ status: 'starting', progress: 0, message: 'Preparing...' })

    try {
      const fullPrompt = buildAmazonPrompt(prompt, imageType, productCategory, productName, mainTemplate)

      // Get dimensions for the selected aspect ratio
      const ratioConfig = ASPECT_RATIOS.find(r => r.id === aspectRatio) || ASPECT_RATIOS[0]

      // Pass reference images and aspect ratio to API
      const result = await generateImage(fullPrompt, {
        referenceImages: referenceImages.length > 0 ? referenceImages : undefined,
        aspectRatio: aspectRatio,
        width: ratioConfig.dimensions.width,
        height: ratioConfig.dimensions.height
      }, (progress) => {
        setLoadingProgress(progress)
      })

      const newEntry = {
        id: Date.now(),
        prompt,
        fullPrompt,
        imageType,
        productCategory,
        productName,
        productAsin,
        mainTemplate: imageType === 'main' ? mainTemplate : null,
        aspectRatio,
        imageUrl: result.url,
        provider: result.provider,
        model: result.model,
        sessionId: session.id,
        isFavorite: false,
        timestamp: new Date().toISOString(),
        usedReferences: result.usedReferences || 0,
        referenceCount: referenceImages.length
      }

      // Save to database
      if (dbReady) {
        await saveImage(newEntry)
      }

      // Update session stats
      const updatedSession = await updateSessionStats(session.id, imageType)
      setActiveSession(updatedSession)

      setCurrentImage(newEntry)
      setHistory(prev => [newEntry, ...prev].slice(0, 50))
      setAllImages(prev => [newEntry, ...prev])
    } catch (err) {
      setError(err.message || 'Failed to generate image')
    } finally {
      setIsLoading(false)
      setLoadingProgress(null)
    }
  }, [prompt, imageType, productCategory, productName, productAsin, mainTemplate, aspectRatio, activeSession, isCalendarConnected, dbReady, referenceImages])

  // Session management
  const handleStartSession = useCallback(async (projectName) => {
    const session = await startSession(null, projectName || 'Amazon Listings')
    setActiveSession(session)

    if (isCalendarConnected) {
      try {
        const event = await createFocusTimeEvent(session, {
          title: `Image Generation: ${projectName || 'Amazon Listings'}`,
          duration: 60
        })
        session.calendarEventId = event.id
        await put('sessions', session)
      } catch (err) {
        console.warn('Failed to create calendar event:', err)
      }
    }

    return session
  }, [isCalendarConnected])

  const handleEndSession = useCallback(async () => {
    if (!activeSession) return

    const completedSession = await endSession(activeSession.id)

    // Update calendar event with actual duration
    if (isCalendarConnected && completedSession.calendarEventId) {
      try {
        await updateSessionEvent(completedSession.calendarEventId, completedSession)
      } catch (err) {
        console.warn('Failed to update calendar event:', err)
      }
    }

    setActiveSession(null)
    setAllSessions(prev => prev.map(s => s.id === completedSession.id ? completedSession : s))

    // Refresh stats
    const stats = await getSessionStats()
    setSessionStats(stats)
  }, [activeSession, isCalendarConnected])

  // Calendar connection
  const handleConnectCalendar = useCallback(async () => {
    if (!calendarInitialized) {
      alert('Calendar integration not configured. Add Google API credentials to .env')
      return
    }

    try {
      await signIn()
      setIsCalendarConnected(true)
    } catch (err) {
      console.error('Calendar sign-in failed:', err)
      alert('Failed to connect to Google Calendar')
    }
  }, [calendarInitialized])

  const handleDisconnectCalendar = useCallback(() => {
    signOut()
    setIsCalendarConnected(false)
  }, [])

  // Favorites management
  const handleSaveToFavorites = useCallback(async () => {
    if (!currentImage || currentImage.isFavorite) return

    const updated = { ...currentImage, isFavorite: true }
    if (dbReady) {
      await saveImage(updated)
    }

    setCurrentImage(updated)
    setFavorites(prev => [updated, ...prev])
    setHistory(prev => prev.map(img => img.id === updated.id ? updated : img))
    setAllImages(prev => prev.map(img => img.id === updated.id ? updated : img))
  }, [currentImage, dbReady])

  const handleRemoveFromFavorites = useCallback(async (id) => {
    const image = allImages.find(img => img.id === id)
    if (!image) return

    const updated = { ...image, isFavorite: false }
    if (dbReady) {
      await saveImage(updated)
    }

    setFavorites(prev => prev.filter(f => f.id !== id))
    setHistory(prev => prev.map(img => img.id === id ? updated : img))
    setAllImages(prev => prev.map(img => img.id === id ? updated : img))
    if (currentImage?.id === id) {
      setCurrentImage(updated)
    }
  }, [allImages, currentImage, dbReady])

  // History management
  const handleHistorySelect = useCallback((entry) => {
    setCurrentImage(entry)
    setPrompt(entry.prompt)
    if (entry.imageType) setImageType(entry.imageType)
    if (entry.productCategory) setProductCategory(entry.productCategory)
    if (entry.productName) setProductName(entry.productName)
    if (entry.productAsin) setProductAsin(entry.productAsin)
    if (entry.mainTemplate) setMainTemplate(entry.mainTemplate)
    if (entry.aspectRatio) setAspectRatio(entry.aspectRatio)
  }, [])

  const handleClearHistory = useCallback(async () => {
    setHistory([])
    // Note: This only clears UI, not database
  }, [])

  // Clear all data
  const handleClearAllData = useCallback(async () => {
    if (!confirm('Are you sure you want to delete ALL data? This cannot be undone.')) return

    if (dbReady) {
      await clear('sessions')
      await clear('images')
      await clear('calendarEvents')
    }

    setHistory([])
    setFavorites([])
    setAllImages([])
    setAllSessions([])
    setCurrentImage(null)
    setActiveSession(null)
    setSessionStats(null)
  }, [dbReady])

  // Style preset management
  const handleSavePreset = useCallback(async (preset) => {
    if (dbReady) {
      await savePreset(preset)
    }
    setStylePresets(prev => [...prev, preset])
  }, [dbReady])

  const handleLoadPreset = useCallback((preset) => {
    // Load reference images from the preset
    const loadedImages = preset.images.map(img => ({
      ...img,
      id: `ref-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
      preview: img.base64 // Use base64 as preview since we don't have object URLs
    }))
    setReferenceImages(loadedImages)
  }, [])

  const handleDeletePreset = useCallback(async (presetId) => {
    if (dbReady) {
      await deletePreset(presetId)
    }
    setStylePresets(prev => prev.filter(p => p.id !== presetId))
  }, [dbReady])

  // Keyboard shortcuts
  useEffect(() => {
    const handleKeyDown = (e) => {
      if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
        e.preventDefault()
        handleGenerate()
      }
      if ((e.ctrlKey || e.metaKey) && e.key === 's') {
        e.preventDefault()
        handleSaveToFavorites()
      }
    }

    window.addEventListener('keydown', handleKeyDown)
    return () => window.removeEventListener('keydown', handleKeyDown)
  }, [handleGenerate, handleSaveToFavorites])

  const isFavorited = currentImage?.isFavorite

  return (
    <div className="app">
      <header className="header">
        <div className="header-brand">
          <h1>Amazon Listing Image Generator</h1>
          <span className="badge">{providerInfo.isDemo ? 'DEMO' : providerInfo.provider.toUpperCase()}</span>
        </div>
        <nav className="tabs">
          <button
            className={`tab ${activeTab === 'generate' ? 'active' : ''}`}
            onClick={() => setActiveTab('generate')}
          >
            Generate
          </button>
          <button
            className={`tab ${activeTab === 'gallery' ? 'active' : ''}`}
            onClick={() => setActiveTab('gallery')}
          >
            Saved ({favorites.length})
          </button>
          <button
            className={`tab ${activeTab === 'settings' ? 'active' : ''}`}
            onClick={() => setActiveTab('settings')}
          >
            Settings
          </button>
        </nav>
      </header>

      {activeTab === 'generate' ? (
        <main className="main">
          <div className="sidebar">
            <SessionPanel
              activeSession={activeSession}
              onStartSession={handleStartSession}
              onEndSession={handleEndSession}
              sessionStats={sessionStats}
              isCalendarConnected={isCalendarConnected}
              onConnectCalendar={handleConnectCalendar}
            />
            <PromptInput
              prompt={prompt}
              setPrompt={setPrompt}
              onGenerate={handleGenerate}
              isLoading={isLoading}
              imageType={imageType}
              setImageType={setImageType}
              productCategory={productCategory}
              setProductCategory={setProductCategory}
              productName={productName}
              setProductName={setProductName}
              productAsin={productAsin}
              setProductAsin={setProductAsin}
              mainTemplate={mainTemplate}
              setMainTemplate={setMainTemplate}
              aspectRatio={aspectRatio}
              setAspectRatio={setAspectRatio}
            />
            <ReferenceImageUpload
              referenceImages={referenceImages}
              setReferenceImages={setReferenceImages}
              disabled={isLoading}
            />
            <StylePresets
              presets={stylePresets}
              currentImages={referenceImages}
              onSavePreset={handleSavePreset}
              onLoadPreset={handleLoadPreset}
              onDeletePreset={handleDeletePreset}
              disabled={isLoading}
            />
            <PromptPreview
              textPrompt={prompt}
              referenceImages={referenceImages}
              imageType={imageType}
              productCategory={productCategory}
            />
            <History
              history={history}
              onSelect={handleHistorySelect}
              onClear={handleClearHistory}
              currentId={currentImage?.id}
            />
          </div>

          <div className="content">
            <ImageDisplay
              image={currentImage}
              isLoading={isLoading}
              loadingProgress={loadingProgress}
              error={error}
              onSave={handleSaveToFavorites}
              isFavorited={isFavorited}
            />
          </div>
        </main>
      ) : activeTab === 'gallery' ? (
        <main className="main gallery-main">
          <Gallery
            favorites={favorites}
            onRemove={handleRemoveFromFavorites}
            onSelect={(entry) => {
              setCurrentImage(entry)
              setPrompt(entry.prompt)
              if (entry.imageType) setImageType(entry.imageType)
              if (entry.productCategory) setProductCategory(entry.productCategory)
              if (entry.productName) setProductName(entry.productName)
              if (entry.productAsin) setProductAsin(entry.productAsin)
              if (entry.mainTemplate) setMainTemplate(entry.mainTemplate)
              if (entry.aspectRatio) setAspectRatio(entry.aspectRatio)
              setActiveTab('generate')
            }}
          />
        </main>
      ) : (
        <main className="main settings-main">
          <SettingsPanel
            sessions={allSessions}
            images={allImages}
            sessionStats={sessionStats}
            onClearData={handleClearAllData}
            isCalendarConnected={isCalendarConnected}
            onConnectCalendar={handleConnectCalendar}
            onDisconnectCalendar={handleDisconnectCalendar}
          />
        </main>
      )}

      <footer className="footer">
        <span className="shortcut">Ctrl+Enter: Generate</span>
        <span className="shortcut">Ctrl+S: Save to Gallery</span>
        {activeSession && (
          <span className="session-indicator">
            <span className="session-dot"></span>
            Session Active
          </span>
        )}
      </footer>
    </div>
  )
}

export default App

--- END OF FILE ---

--- FILE: src/pages.css ---
/* ============================================
   Layout Styles
   ============================================ */

.layout {
  display: flex;
  min-height: 100vh;
  background: var(--bg-primary);
}

.mobile-menu-btn {
  display: none;
  position: fixed;
  top: 16px;
  left: 16px;
  z-index: 1001;
  padding: 8px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  cursor: pointer;
}

.sidebar-nav {
  width: 260px;
  background: var(--bg-secondary);
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  position: fixed;
  height: 100vh;
  z-index: 1000;
}

.sidebar-header {
  padding: 20px;
  border-bottom: 1px solid var(--border);
}

.logo {
  display: flex;
  align-items: center;
  gap: 10px;
  color: var(--text-primary);
  text-decoration: none;
  font-weight: 600;
  font-size: 1.1rem;
}

.logo-icon {
  color: var(--accent);
}

.nav-links {
  flex: 1;
  padding: 16px 12px;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.nav-link {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  color: var(--text-secondary);
  text-decoration: none;
  border-radius: var(--radius);
  transition: all 0.15s ease;
}

.nav-link:hover {
  background: var(--bg-tertiary);
  color: var(--text-primary);
}

.nav-link.active {
  background: rgba(255, 153, 0, 0.1);
  color: var(--accent);
}

.nav-arrow {
  margin-left: auto;
}

.sidebar-footer {
  padding: 16px;
  border-top: 1px solid var(--border);
}

.credits-display {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
  color: var(--accent);
  font-weight: 500;
  margin-bottom: 12px;
}

.legacy-link {
  display: block;
  text-align: center;
  color: var(--text-muted);
  font-size: 0.75rem;
  text-decoration: none;
}

.legacy-link:hover {
  color: var(--text-secondary);
}

.main-content {
  flex: 1;
  margin-left: 260px;
  padding: 24px;
  overflow-y: auto;
}

.sidebar-overlay {
  display: none;
}

/* ============================================
   Dashboard Styles
   ============================================ */

.dashboard {
  max-width: 1400px;
  margin: 0 auto;
}

.dashboard-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 32px;
}

.dashboard-header h1 {
  font-size: 1.75rem;
  font-weight: 600;
  margin-bottom: 4px;
}

.dashboard-header p {
  color: var(--text-secondary);
}

.stats-section {
  margin-bottom: 32px;
}

.stats-grid-4 {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
}

.stat-card {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 20px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
}

.stat-icon {
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255, 153, 0, 0.1);
  border-radius: var(--radius);
  color: var(--accent);
}

.stat-info {
  display: flex;
  flex-direction: column;
}

.stat-value {
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--text-primary);
}

.stat-label {
  font-size: 0.8125rem;
  color: var(--text-secondary);
}

.stat-change {
  font-size: 0.75rem;
  color: var(--success);
}

.tools-section {
  margin-bottom: 32px;
}

.tools-section h2 {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 16px;
}

.tools-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
}

.tool-card {
  display: flex;
  align-items: flex-start;
  gap: 16px;
  padding: 24px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  text-decoration: none;
  transition: all 0.2s ease;
}

.tool-card:hover {
  border-color: var(--tool-color);
  transform: translateY(-2px);
}

.tool-icon {
  width: 56px;
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius);
  flex-shrink: 0;
}

.tool-content h3 {
  font-size: 1.125rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 8px;
}

.tool-content p {
  font-size: 0.875rem;
  color: var(--text-secondary);
  margin-bottom: 12px;
  line-height: 1.5;
}

.tool-features {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.feature-tag {
  padding: 4px 8px;
  background: var(--bg-tertiary);
  border-radius: 4px;
  font-size: 0.6875rem;
  color: var(--text-muted);
}

.tool-arrow {
  margin-left: auto;
  color: var(--text-muted);
}

.projects-section .section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.projects-section h2 {
  font-size: 1.25rem;
  font-weight: 600;
}

.view-all {
  color: var(--accent);
  font-size: 0.875rem;
  text-decoration: none;
}

.projects-table {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  overflow: hidden;
}

.projects-table table {
  width: 100%;
  border-collapse: collapse;
}

.projects-table th {
  text-align: left;
  padding: 12px 16px;
  background: var(--bg-tertiary);
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
}

.projects-table td {
  padding: 12px 16px;
  border-top: 1px solid var(--border);
  font-size: 0.875rem;
}

.project-name {
  display: flex;
  align-items: center;
  gap: 8px;
}

.star-icon {
  color: var(--text-muted);
}

.marketplace-badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 8px;
  background: var(--bg-tertiary);
  border-radius: 4px;
  font-size: 0.75rem;
}

.status-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 500;
}

.status-complete {
  background: rgba(34, 197, 94, 0.1);
  color: var(--success);
}

.status-processing {
  background: rgba(255, 153, 0, 0.1);
  color: var(--accent);
}

.status-draft {
  background: var(--bg-tertiary);
  color: var(--text-muted);
}

/* ============================================
   Page Header
   ============================================ */

.page-header {
  margin-bottom: 24px;
}

.page-header h1 {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 4px;
}

.page-header p {
  color: var(--text-secondary);
}

/* ============================================
   Main Image Generator
   ============================================ */

.main-image-generator {
  max-width: 1600px;
  margin: 0 auto;
}

.generator-layout {
  display: grid;
  grid-template-columns: 320px 1fr 320px;
  gap: 24px;
}

.generator-sidebar,
.results-section {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 20px;
}

.input-section {
  margin-bottom: 24px;
}

.input-tabs {
  display: flex;
  gap: 8px;
  margin-bottom: 16px;
}

.input-tab {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 10px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  font-size: 0.8125rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.input-tab:hover {
  border-color: var(--accent);
}

.input-tab.active {
  background: var(--accent);
  border-color: var(--accent);
  color: white;
}

.asin-input {
  position: relative;
}

.asin-input input {
  width: 100%;
  padding: 12px 40px 12px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.875rem;
  font-family: monospace;
}

.asin-input input:focus {
  outline: none;
  border-color: var(--accent);
}

.asin-input input.invalid {
  border-color: var(--error);
}

.asin-status {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
}

.asin-status.valid {
  color: var(--success);
}

.asin-status.invalid {
  color: var(--error);
}

.upload-zone {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 32px 16px;
  background: var(--bg-tertiary);
  border: 2px dashed var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
}

.upload-zone:hover,
.upload-zone.drag-active {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.05);
}

.upload-zone p {
  margin-top: 12px;
  color: var(--text-secondary);
}

.upload-zone span {
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-top: 4px;
}

.uploaded-preview {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
}

.uploaded-preview img {
  width: 80px;
  height: 80px;
  object-fit: cover;
  border-radius: var(--radius);
}

.uploaded-preview span {
  font-size: 0.75rem;
  color: var(--text-secondary);
  margin-top: 8px;
}

.remove-upload {
  position: absolute;
  top: -8px;
  right: -8px;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--error);
  border: none;
  border-radius: 50%;
  color: white;
  cursor: pointer;
}

.config-section h3 {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.875rem;
  font-weight: 600;
  margin-bottom: 16px;
}

.config-group {
  margin-bottom: 20px;
}

.config-group label {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 0.8125rem;
  color: var(--text-secondary);
  margin-bottom: 8px;
}

.config-value {
  font-weight: 600;
  color: var(--accent);
}

.config-group input[type="range"] {
  width: 100%;
  height: 4px;
  background: var(--bg-tertiary);
  border-radius: 2px;
  -webkit-appearance: none;
}

.config-group input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 16px;
  height: 16px;
  background: var(--accent);
  border-radius: 50%;
  cursor: pointer;
}

/* Config Dropdown Select */
.config-select {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.8125rem;
  cursor: pointer;
  transition: border-color 0.15s ease;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23a0a0a5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  padding-right: 36px;
}

.config-select:hover {
  border-color: var(--accent);
}

.config-select:focus {
  outline: none;
  border-color: var(--accent);
}

.config-select option {
  background: var(--bg-secondary);
  color: var(--text-primary);
  padding: 8px;
}

/* Batch Generation Controls */
.batch-controls {
  background: linear-gradient(135deg, rgba(255, 153, 0, 0.05) 0%, transparent 100%);
  padding: 16px;
  border-radius: var(--radius);
  border: 1px solid rgba(255, 153, 0, 0.2);
}

.batch-label {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px !important;
}

.batch-total {
  font-weight: 700;
  color: var(--accent);
  font-size: 1rem;
}

.batch-sliders {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.batch-slider-item {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.slider-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 0.75rem;
  color: var(--text-secondary);
}

.slider-value {
  font-weight: 600;
  color: var(--text-primary);
  background: var(--bg-tertiary);
  padding: 2px 8px;
  border-radius: 4px;
}

.batch-hint {
  font-size: 0.75rem;
  color: var(--text-secondary);
  margin-top: 12px;
  text-align: center;
  padding: 8px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
}

.hint-warning {
  color: var(--accent);
  font-weight: 500;
}

/* Generation Progress */
.generation-progress {
  background: var(--bg-tertiary);
  border-radius: var(--radius);
  padding: 16px;
  margin-bottom: 16px;
}

.progress-bar {
  height: 8px;
  background: var(--bg-secondary);
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 8px;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), var(--success));
  border-radius: 4px;
  transition: width 0.3s ease;
}

.progress-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.progress-text {
  font-size: 0.8rem;
  color: var(--text-secondary);
}

.progress-count {
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--accent);
}

/* Results Section Enhancements */
.results-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 12px;
}

.results-count {
  font-weight: 400;
  color: var(--text-muted);
  margin-left: 8px;
}

.results-actions {
  display: flex;
  gap: 8px;
}

.btn-ghost {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--text-secondary);
}

.btn-ghost:hover {
  border-color: var(--accent);
  color: var(--text-primary);
}

/* Result Card Selection */
.result-card {
  position: relative;
  cursor: pointer;
  transition: all 0.15s ease;
}

.result-card.selected {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(255, 153, 0, 0.3);
}

.result-checkbox {
  position: absolute;
  top: 8px;
  left: 8px;
  z-index: 10;
}

.result-checkbox input[type="checkbox"] {
  width: 20px;
  height: 20px;
  cursor: pointer;
  accent-color: var(--accent);
}

.variation-badge {
  font-size: 0.6rem;
  padding: 2px 6px;
  background: var(--accent);
  color: white;
  border-radius: 4px;
  margin-left: 6px;
  font-weight: 600;
}

.results-empty span {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-top: 4px;
}

.model-selector {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.model-option {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  padding: 10px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
}

.model-option:hover {
  border-color: var(--accent);
}

.model-option.selected {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.1);
}

.model-name {
  font-size: 0.8125rem;
  color: var(--text-primary);
  font-weight: 500;
}

.model-desc {
  font-size: 0.6875rem;
  color: var(--text-muted);
}

.model-badge {
  font-size: 0.5rem;
  padding: 2px 6px;
  background: var(--accent);
  color: white;
  border-radius: 10px;
  margin-top: 4px;
}

.marketplace-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}

.marketplace-btn {
  padding: 8px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.marketplace-btn:hover {
  border-color: var(--accent);
}

.marketplace-btn.selected {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.1);
}

/* Aspect Ratio Grid */
.aspect-ratio-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
}

.aspect-ratio-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  padding: 10px 6px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
}

.aspect-ratio-btn:hover {
  border-color: var(--accent);
}

.aspect-ratio-btn.selected {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.1);
}

.ratio-icon {
  font-size: 1.2rem;
}

.ratio-label {
  font-size: 0.65rem;
  font-weight: 500;
  color: var(--text-secondary);
}

.aspect-ratio-btn.selected .ratio-label {
  color: var(--accent);
}

/* Amazon-compliant Aspect Ratio Grid (3 options only) */
.aspect-ratio-grid-amazon {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.aspect-ratio-btn-amazon {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 14px;
  background: var(--bg-tertiary);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
  text-align: left;
}

.aspect-ratio-btn-amazon:hover {
  border-color: var(--accent);
}

.aspect-ratio-btn-amazon.selected {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.1);
}

.aspect-ratio-btn-amazon.recommended.selected {
  border-color: var(--success);
  background: rgba(34, 197, 94, 0.1);
}

.aspect-ratio-btn-amazon .ratio-icon {
  font-size: 1.5rem;
}

.aspect-ratio-btn-amazon .ratio-details {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.aspect-ratio-btn-amazon .ratio-label {
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--text-primary);
}

.aspect-ratio-btn-amazon.selected .ratio-label {
  color: var(--accent);
}

.aspect-ratio-btn-amazon.recommended.selected .ratio-label {
  color: var(--success);
}

.aspect-ratio-btn-amazon .ratio-badge {
  font-size: 0.6rem;
  padding: 2px 6px;
  background: var(--success);
  color: white;
  border-radius: 10px;
  text-transform: uppercase;
  font-weight: 600;
  width: fit-content;
}

.ratio-tip {
  font-size: 0.7rem;
  color: var(--text-muted);
  margin-top: 8px;
}

/* Templates Section */
.templates-section {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 20px;
}

.templates-header {
  margin-bottom: 16px;
}

.templates-header h3 {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 12px;
}

.template-count {
  font-size: 0.75rem;
  font-weight: normal;
  color: var(--accent);
  margin-left: auto;
}

.category-filters {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.category-btn {
  padding: 6px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: 20px;
  font-size: 0.75rem;
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.15s ease;
}

.category-btn:hover {
  border-color: var(--accent);
}

.category-btn.active {
  background: var(--accent);
  border-color: var(--accent);
  color: white;
}

.templates-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 12px;
  max-height: 400px;
  overflow-y: auto;
  padding: 4px;
}

.template-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 16px 12px;
  background: var(--bg-tertiary);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
  position: relative;
}

.template-card:hover {
  border-color: var(--accent);
}

.template-card.selected {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.1);
}

.template-thumbnail {
  font-size: 2rem;
  margin-bottom: 8px;
}

.template-name {
  font-size: 0.6875rem;
  color: var(--text-secondary);
  text-align: center;
}

.template-check {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--accent);
  border-radius: 50%;
  color: white;
  opacity: 0;
}

.template-card.selected .template-check {
  opacity: 1;
}

.generate-action {
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid var(--border);
}

.error-message {
  padding: 10px;
  background: rgba(239, 68, 68, 0.1);
  border-radius: var(--radius);
  color: var(--error);
  font-size: 0.8125rem;
  margin-bottom: 12px;
}

/* Results Section */
.results-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.results-header h3 {
  font-size: 1rem;
  font-weight: 600;
}

.results-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  color: var(--text-muted);
  text-align: center;
}

.results-empty p {
  margin-top: 12px;
  font-size: 0.875rem;
}

.results-grid {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.result-card {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
}

.result-card img {
  width: 100%;
  aspect-ratio: 1;
  object-fit: cover;
}

.result-info {
  padding: 12px;
  border-top: 1px solid var(--border);
}

.result-template {
  display: block;
  font-size: 0.8125rem;
  color: var(--text-primary);
}

.result-model {
  font-size: 0.6875rem;
  color: var(--text-muted);
}

.result-actions {
  display: flex;
  gap: 8px;
  padding: 8px 12px;
  border-top: 1px solid var(--border);
  background: var(--bg-tertiary);
}

.action-btn {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 8px;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.15s ease;
}

.action-btn:hover {
  border-color: var(--accent);
  color: var(--accent);
}

/* ============================================
   Creative Campaigns
   ============================================ */

.creative-campaigns {
  max-width: 1400px;
  margin: 0 auto;
}

.campaign-input {
  max-width: 600px;
  margin: 0 auto;
}

.input-card {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 24px;
}

.input-form {
  margin-top: 20px;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  font-size: 0.8125rem;
  font-weight: 500;
  color: var(--text-secondary);
  margin-bottom: 8px;
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.875rem;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: var(--accent);
}

.marketplace-select {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.mp-btn {
  padding: 8px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
}

.mp-btn:hover {
  border-color: var(--accent);
}

.mp-btn.selected {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.1);
}

.mode-toggle {
  display: flex;
  gap: 12px;
}

.mode-btn {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  padding: 16px;
  background: var(--bg-tertiary);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
}

.mode-btn:hover {
  border-color: var(--accent);
}

.mode-btn.active {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.1);
}

.mode-btn span {
  font-size: 0.6875rem;
  color: var(--text-muted);
}

.progress-bar {
  height: 4px;
  background: var(--bg-tertiary);
  border-radius: 2px;
  margin-top: 16px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: var(--accent);
  transition: width 0.3s ease;
}

/* Campaign Results */
.campaign-results {
  position: relative;
}

.results-tabs {
  display: flex;
  gap: 12px;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.results-tab {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 16px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.results-tab:hover {
  border-color: var(--accent);
}

.results-tab.active {
  background: var(--accent);
  border-color: var(--accent);
  color: white;
}

.export-btn {
  margin-left: auto;
}

/* Market Intel */
.market-intel {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.intel-section {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 24px;
}

.intel-section h3 {
  font-size: 1.125rem;
  font-weight: 600;
  margin-bottom: 16px;
}

.stats-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
}

.stat-box {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
}

.stat-box svg {
  color: var(--accent);
}

.stat-number {
  display: block;
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--text-primary);
}

.charts-row {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 24px;
}

.chart-box {
  padding: 16px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
}

.chart-box h4 {
  font-size: 0.875rem;
  font-weight: 500;
  margin-bottom: 12px;
}

.themes-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
}

.theme-column {
  padding: 16px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
}

.theme-column h4 {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.875rem;
  font-weight: 600;
  margin-bottom: 12px;
}

.theme-column.positive h4 {
  color: var(--success);
}

.theme-column.pain h4 {
  color: var(--error);
}

.theme-column.requests h4 {
  color: var(--accent);
}

.theme-column ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.theme-column li {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 0;
  border-bottom: 1px solid var(--border);
  font-size: 0.8125rem;
}

.theme-column li:last-child {
  border-bottom: none;
}

.theme-column .count {
  margin-left: auto;
  color: var(--text-muted);
  font-size: 0.75rem;
}

/* Customer Avatars */
.avatars-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
}

.avatar-card {
  padding: 20px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
}

.avatar-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
}

.avatar-icon {
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--accent);
  border-radius: 50%;
  color: white;
}

.avatar-header h4 {
  font-size: 1rem;
  font-weight: 600;
}

.segment-badge {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 10px;
  font-size: 0.6875rem;
}

.segment-badge.primary {
  background: rgba(255, 153, 0, 0.1);
  color: var(--accent);
}

.segment-badge.secondary {
  background: var(--bg-secondary);
  color: var(--text-secondary);
}

.avatar-details {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
}

.detail-group h5 {
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  color: var(--text-muted);
  margin-bottom: 8px;
}

.detail-group p {
  font-size: 0.8125rem;
  color: var(--text-secondary);
  margin-bottom: 4px;
}

.detail-group ul {
  list-style: disc;
  padding-left: 16px;
  margin: 0;
}

.detail-group li {
  font-size: 0.8125rem;
  color: var(--text-secondary);
  margin-bottom: 4px;
}

/* Recommendations */
.recommendations-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
}

.recommendation-card {
  padding: 16px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
}

.recommendation-card h4 {
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--accent);
  margin-bottom: 12px;
}

.recommendation-card ul {
  list-style: disc;
  padding-left: 16px;
  margin: 0;
}

.recommendation-card li {
  font-size: 0.8125rem;
  color: var(--text-secondary);
  margin-bottom: 8px;
}

/* Chat Panel */
.chat-toggle {
  position: fixed;
  bottom: 24px;
  right: 24px;
  width: 56px;
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--accent);
  border: none;
  border-radius: 50%;
  color: white;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  z-index: 100;
}

.chat-panel {
  position: fixed;
  bottom: 96px;
  right: 24px;
  width: 360px;
  height: 480px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  display: flex;
  flex-direction: column;
  z-index: 100;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
}

.chat-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px;
  border-bottom: 1px solid var(--border);
}

.chat-header h4 {
  font-size: 1rem;
  font-weight: 600;
}

.chat-header button {
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 1.25rem;
  cursor: pointer;
}

.chat-messages {
  flex: 1;
  padding: 16px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.chat-message {
  max-width: 85%;
  padding: 10px 14px;
  border-radius: var(--radius);
  font-size: 0.875rem;
  line-height: 1.4;
}

.chat-message.user {
  align-self: flex-end;
  background: var(--accent);
  color: white;
}

.chat-message.assistant {
  align-self: flex-start;
  background: var(--bg-tertiary);
  color: var(--text-primary);
}

.chat-suggestions {
  padding: 8px 16px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.chat-suggestions button {
  padding: 6px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: 20px;
  font-size: 0.6875rem;
  color: var(--text-secondary);
  cursor: pointer;
}

.chat-suggestions button:hover {
  border-color: var(--accent);
}

.chat-input {
  display: flex;
  gap: 8px;
  padding: 16px;
  border-top: 1px solid var(--border);
}

.chat-input input {
  flex: 1;
  padding: 10px 14px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.875rem;
}

.chat-input input:focus {
  outline: none;
  border-color: var(--accent);
}

.chat-input button {
  padding: 10px 16px;
  background: var(--accent);
  border: none;
  border-radius: var(--radius);
  color: white;
  font-size: 0.875rem;
  cursor: pointer;
}

/* ============================================
   Listing Copywriter
   ============================================ */

.listing-copywriter {
  max-width: 1400px;
  margin: 0 auto;
}

.mode-tabs {
  display: flex;
  gap: 8px;
  margin-bottom: 24px;
}

.mode-tab {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 20px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.mode-tab:hover {
  border-color: var(--accent);
}

.mode-tab.active {
  background: var(--accent);
  border-color: var(--accent);
  color: white;
}

.copywriter-layout {
  display: grid;
  grid-template-columns: 360px 1fr;
  gap: 24px;
}

.input-panel .input-card {
  position: sticky;
  top: 24px;
}

.input-card h3 {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 20px;
}

.marketplace-grid-small {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 8px;
}

.char-count {
  display: block;
  font-size: 0.6875rem;
  color: var(--text-muted);
  margin-top: 4px;
  text-align: right;
}

/* Results Panel */
.results-panel {
  min-height: 500px;
}

.results-content {
  display: flex;
  flex-direction: column;
  gap: 24px;
}

.results-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  margin-bottom: 8px;
}

.result-section {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 20px;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.section-header h3 {
  font-size: 1rem;
  font-weight: 600;
}

.title-tabs {
  display: flex;
  gap: 8px;
}

.title-tab {
  padding: 6px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.title-tab:hover {
  border-color: var(--accent);
}

.title-tab.active {
  background: var(--accent);
  border-color: var(--accent);
  color: white;
}

.title-content textarea,
.description-content textarea,
.search-terms-content textarea {
  width: 100%;
  padding: 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.875rem;
  resize: vertical;
}

.title-content textarea:focus,
.description-content textarea:focus,
.search-terms-content textarea:focus {
  outline: none;
  border-color: var(--accent);
}

.field-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 8px;
}

.field-footer .char-count {
  margin: 0;
}

.field-footer .char-count.warning {
  color: var(--error);
}

.field-actions {
  display: flex;
  gap: 8px;
}

.icon-btn {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  cursor: pointer;
  transition: all 0.15s ease;
}

.icon-btn:hover {
  border-color: var(--accent);
  color: var(--accent);
}

/* Bullets List */
.bullets-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.bullet-item {
  display: flex;
  gap: 12px;
  align-items: flex-start;
}

.bullet-drag {
  padding-top: 12px;
  color: var(--text-muted);
  cursor: grab;
}

.bullet-number {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--accent);
  border-radius: 50%;
  color: white;
  font-size: 0.75rem;
  font-weight: 600;
  flex-shrink: 0;
  margin-top: 8px;
}

.bullet-content {
  flex: 1;
}

.bullet-content textarea {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.8125rem;
  resize: vertical;
}

.bullet-content textarea:focus {
  outline: none;
  border-color: var(--accent);
}

/* Bulk Mode */
.bulk-mode {
  display: flex;
  justify-content: center;
  padding: 60px 20px;
}

.bulk-upload .upload-zone {
  width: 500px;
  padding: 60px;
}

.bulk-upload .upload-zone h3 {
  margin-top: 16px;
  font-size: 1.25rem;
}

.bulk-upload .upload-zone p {
  color: var(--text-secondary);
  margin-bottom: 20px;
}

/* ============================================
   Buttons
   ============================================ */

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 10px 16px;
  border: none;
  border-radius: var(--radius);
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.btn-primary {
  background: var(--accent);
  color: #000;
  font-weight: 600;
}

.btn-primary:hover:not(:disabled) {
  background: var(--accent-hover);
}

.btn-secondary {
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  color: #fff;
}

.btn-secondary:hover:not(:disabled) {
  border-color: var(--accent);
  color: #fff;
  background: rgba(255, 153, 0, 0.1);
}

.btn-ghost {
  background: transparent;
  color: #fff;
}

.btn-ghost:hover {
  color: var(--accent);
}

.btn-sm {
  padding: 6px 12px;
  font-size: 0.75rem;
}

.btn-large {
  width: 100%;
  padding: 14px;
  font-size: 1rem;
}

/* ============================================
   Responsive
   ============================================ */

@media (max-width: 1200px) {
  .generator-layout {
    grid-template-columns: 280px 1fr;
  }

  .results-section {
    display: none;
  }

  .tools-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .recommendations-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .mobile-menu-btn {
    display: flex;
  }

  .sidebar-nav {
    transform: translateX(-100%);
    transition: transform 0.3s ease;
  }

  .sidebar-nav.open {
    transform: translateX(0);
  }

  .sidebar-overlay {
    display: block;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
  }

  .main-content {
    margin-left: 0;
    padding: 16px;
    padding-top: 60px;
  }

  .generator-layout,
  .copywriter-layout {
    grid-template-columns: 1fr;
  }

  .tools-grid {
    grid-template-columns: 1fr;
  }

  .stats-grid-4,
  .stats-row {
    grid-template-columns: repeat(2, 1fr);
  }

  .charts-row,
  .themes-grid,
  .avatars-grid {
    grid-template-columns: 1fr;
  }

  .recommendations-grid {
    grid-template-columns: 1fr;
  }

  .chat-panel {
    width: calc(100% - 32px);
    right: 16px;
    left: 16px;
  }
}

/* ============================================
   Secondary Image Generator
   ============================================ */

.secondary-image-generator {
  flex: 1;
  padding: 24px;
  overflow-y: auto;
}

.secondary-layout {
  display: grid;
  grid-template-columns: 300px 1fr 1fr;
  gap: 20px;
  height: calc(100vh - 140px);
}

/* Campaign Summary */
.campaign-summary {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, transparent 100%);
  border: 1px solid rgba(59, 130, 246, 0.2);
}

.summary-content {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.summary-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 6px 0;
  border-bottom: 1px solid var(--border);
}

.summary-item:last-child {
  border-bottom: none;
}

.summary-item label {
  font-size: 0.75rem;
  color: var(--text-muted);
}

.summary-item span {
  font-size: 0.8rem;
  color: var(--text-primary);
  font-weight: 500;
  text-align: right;
  max-width: 60%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.no-campaign {
  text-align: center;
  padding: 20px;
}

.no-campaign p {
  color: var(--text-muted);
  margin-bottom: 12px;
}

/* Image Type Selection */
.image-type-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.image-type-option {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 12px;
  background: var(--bg-tertiary);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
  text-align: left;
}

.image-type-option:hover {
  border-color: var(--type-color, var(--accent));
}

.image-type-option.selected {
  border-color: var(--type-color, var(--accent));
  background: rgba(255, 255, 255, 0.05);
}

.type-icon {
  width: 32px;
  height: 32px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  flex-shrink: 0;
}

.type-info {
  flex: 1;
  min-width: 0;
}

.type-name {
  display: block;
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--text-primary);
}

.type-desc {
  display: block;
  font-size: 0.7rem;
  color: var(--text-muted);
}

.type-check {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  border: 2px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.image-type-option.selected .type-check {
  background: var(--type-color, var(--accent));
  border-color: var(--type-color, var(--accent));
  color: white;
}

.total-images {
  text-align: center;
  padding: 12px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
  font-size: 0.85rem;
  color: var(--text-secondary);
  margin-top: 12px;
}

.total-images strong {
  color: var(--accent);
  font-size: 1.1rem;
}

/* Prompts Section */
.prompts-section {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 20px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.prompts-header {
  margin-bottom: 16px;
}

.prompts-header h3 {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 1rem;
  color: var(--text-primary);
}

.prompts-count {
  font-weight: 400;
  color: var(--text-muted);
}

.prompts-empty {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
  text-align: center;
  padding: 40px;
}

.prompts-empty p {
  margin-top: 16px;
  font-size: 0.9rem;
}

.prompts-empty span {
  font-size: 0.8rem;
  margin-top: 4px;
}

.prompts-list {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.prompt-card {
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px;
}

.prompt-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

.prompt-type-badge {
  font-size: 0.65rem;
  font-weight: 600;
  padding: 3px 8px;
  border-radius: 4px;
  color: white;
  text-transform: uppercase;
}

.edited-badge {
  font-size: 0.6rem;
  padding: 2px 6px;
  background: var(--accent);
  color: white;
  border-radius: 4px;
}

.prompt-actions {
  margin-left: auto;
  display: flex;
  gap: 4px;
}

.prompt-actions .action-btn {
  padding: 4px;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.15s ease;
}

.prompt-actions .action-btn:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.prompt-text {
  font-size: 0.75rem;
  color: var(--text-secondary);
  line-height: 1.5;
}

.prompt-edit {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.prompt-edit textarea {
  width: 100%;
  padding: 10px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 0.75rem;
  resize: vertical;
  min-height: 80px;
}

.prompt-edit textarea:focus {
  outline: none;
  border-color: var(--accent);
}

.edit-actions {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
}

.generate-action {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--border);
}

/* Result type badge in secondary generator */
.result-type-badge {
  font-size: 0.6rem;
  font-weight: 600;
  padding: 2px 6px;
  border-radius: 4px;
  color: white;
  display: inline-block;
  margin-bottom: 4px;
}

/* Prompt Editor Styles */
.prompt-editor-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.active-prompt {
  flex: 1;
  display: flex;
  flex-direction: column;
}

.prompt-edit-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.prompt-label {
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-bottom: 4px;
}

.prompt-textarea {
  flex: 1;
  width: 100%;
  min-height: 200px;
  padding: 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-family: inherit;
  font-size: 0.85rem;
  line-height: 1.6;
  resize: vertical;
  transition: border-color 0.15s ease;
}

.prompt-textarea:focus {
  outline: none;
  border-color: var(--accent);
}

.prompt-textarea::placeholder {
  color: var(--text-muted);
}

.prompt-char-count {
  font-size: 0.7rem;
  color: var(--text-muted);
  text-align: right;
}

/* Responsive */
@media (max-width: 1200px) {
  .secondary-layout {
    grid-template-columns: 280px 1fr;
  }

  .secondary-layout .results-section {
    grid-column: 1 / -1;
  }
}

@media (max-width: 768px) {
  .secondary-layout {
    grid-template-columns: 1fr;
  }

  .secondary-image-generator {
    padding: 16px;
  }
}

/* ============================================
   A+ Content Creator Styles - Vertical Layout
   ============================================ */

.aplus-content-page.aplus-layout-vertical {
  display: flex;
  flex-direction: column;
  height: calc(100vh - 40px);
  padding: 0;
}

/* Top Toolbar */
.aplus-toolbar {
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}

.toolbar-row {
  padding: 12px 20px;
  border-bottom: 1px solid var(--border);
}

.toolbar-row:last-child {
  border-bottom: none;
}

.toolbar-main {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 20px;
}

.toolbar-left {
  display: flex;
  align-items: center;
  gap: 16px;
}

.toolbar-left h1 {
  font-size: 1.25rem;
  font-weight: 600;
  white-space: nowrap;
}

.content-type-switcher {
  display: flex;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
  padding: 3px;
}

.type-btn {
  padding: 6px 14px;
  background: transparent;
  border: none;
  border-radius: var(--radius);
  font-size: 0.8rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
  display: flex;
  align-items: center;
  gap: 6px;
  color: #fff;
}

.type-btn:hover:not(:disabled) {
  background: var(--bg-secondary);
  color: #fff;
}

.type-btn.active {
  background: var(--accent);
  color: #000;
  font-weight: 600;
}

.type-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  color: #888;
}

.type-width {
  font-size: 0.65rem;
  padding: 2px 6px;
  background: rgba(255, 255, 255, 0.15);
  color: rgba(255, 255, 255, 0.8);
  border-radius: 8px;
  font-weight: 400;
}

.type-btn.active .type-width {
  background: rgba(0, 0, 0, 0.2);
  color: rgba(0, 0, 0, 0.7);
}

.premium-badge {
  font-size: 0.7rem;
  margin-left: 2px;
}

.category-tab.premium-only {
  color: #ffcc00;
}

.category-tab.premium-only.active {
  background: linear-gradient(135deg, var(--accent) 0%, #ffcc00 100%);
  color: #000;
}

.toolbar-center {
  display: flex;
  align-items: center;
  gap: 16px;
  flex: 1;
  justify-content: center;
}

.asin-input-compact {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  width: 200px;
}

.asin-input-compact input {
  flex: 1;
  background: transparent;
  border: none;
  outline: none;
  font-size: 0.85rem;
  width: 100%;
  color: #fff;
}

.asin-input-compact input::placeholder {
  color: #888;
}

.asin-input-compact .asin-status {
  display: flex;
}

.asin-input-compact .asin-status.valid {
  color: var(--success);
}

.asin-input-compact .asin-status.invalid {
  color: var(--error);
}

.module-counter-badge {
  padding: 6px 12px;
  background: var(--bg-tertiary);
  border-radius: 16px;
  font-size: 0.8rem;
  font-weight: 500;
  color: var(--text-secondary);
}

.toolbar-right {
  display: flex;
  align-items: center;
  gap: 8px;
}

/* Guidelines Dropdown */
.guidelines-dropdown {
  position: relative;
}

.btn-icon-circle {
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: 50%;
  cursor: pointer;
  color: var(--text-secondary);
  transition: all 0.15s ease;
}

.btn-icon-circle:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.btn-icon-circle.active {
  background: var(--accent);
  border-color: var(--accent);
  color: #000;
}

.guidelines-popup {
  position: absolute;
  top: calc(100% + 8px);
  right: 0;
  width: 320px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
  z-index: 1000;
  overflow: hidden;
}

.guidelines-popup-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  border-bottom: 1px solid var(--border);
  background: var(--bg-tertiary);
}

.guidelines-popup-header h4 {
  font-size: 0.9rem;
  font-weight: 600;
}

.popup-close {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  color: var(--text-secondary);
  transition: all 0.15s ease;
}

.popup-close:hover {
  background: var(--bg-secondary);
  color: var(--text-primary);
}

.guidelines-popup-content {
  padding: 12px;
  max-height: 300px;
  overflow-y: auto;
}

.guideline-row {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 8px 10px;
  border-radius: var(--radius);
  font-size: 0.8rem;
  margin-bottom: 4px;
  color: #fff;
}

.guideline-row:last-child {
  margin-bottom: 0;
}

.guideline-row.do {
  background: rgba(34, 197, 94, 0.15);
  color: #a8f0c4;
}

.guideline-row.dont {
  background: rgba(239, 68, 68, 0.15);
  color: #fca5a5;
}

.guideline-row .guideline-icon {
  flex-shrink: 0;
  font-weight: 600;
}

.guideline-row.do .guideline-icon {
  color: var(--success);
}

.guideline-row.dont .guideline-icon {
  color: var(--error);
}

/* Module Library Row */
.toolbar-modules {
  padding: 12px 20px;
}

.category-tabs {
  display: flex;
  gap: 4px;
  margin-bottom: 12px;
}

.category-tab {
  padding: 6px 12px;
  background: transparent;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.15s ease;
  color: #fff;
}

.category-tab:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.category-tab.active {
  background: var(--accent);
  border-color: var(--accent);
  color: #000;
  font-weight: 600;
}

.modules-scroll {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  padding-bottom: 8px;
}

.modules-scroll::-webkit-scrollbar {
  height: 6px;
}

.modules-scroll::-webkit-scrollbar-track {
  background: var(--bg-tertiary);
  border-radius: 3px;
}

.modules-scroll::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

.module-chip {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
  white-space: nowrap;
  flex-shrink: 0;
  color: #fff;
}

.module-chip:hover:not(:disabled) {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.1);
}

.module-chip:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.chip-icon {
  font-size: 1.2rem;
}

.chip-name {
  font-size: 0.8rem;
  font-weight: 500;
  color: #fff;
}

.chip-size {
  font-size: 0.65rem;
  color: var(--text-secondary);
  padding: 2px 6px;
  background: var(--bg-secondary);
  border-radius: 8px;
}

.chip-add {
  color: var(--accent);
  margin-left: 4px;
}

/* Content Area - Full Width */
.aplus-content-area {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
  background: var(--bg-primary);
}

.builder-empty-full {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 400px;
  text-align: center;
  color: var(--text-secondary);
}

.builder-empty-full svg {
  margin-bottom: 20px;
  opacity: 0.4;
}

.builder-empty-full h3 {
  font-size: 1.25rem;
  color: var(--text-primary);
  margin-bottom: 8px;
}

.builder-empty-full p {
  font-size: 0.95rem;
  margin-bottom: 4px;
}

.builder-empty-full .hint {
  font-size: 0.8rem;
  opacity: 0.7;
}

/* Modules Container Full Width */
.modules-container-full {
  display: flex;
  flex-direction: column;
  gap: 12px;
  max-width: 1200px;
  margin: 0 auto;
}

.module-item-full {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  overflow: hidden;
  transition: all 0.15s ease;
}

.module-item-full.dragging {
  opacity: 0.5;
  border-color: var(--accent);
}

.module-item-full.expanded {
  border-color: var(--accent);
}

.module-header-full {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px 20px;
  cursor: grab;
}

.module-header-full:active {
  cursor: grabbing;
}

.module-icon-lg {
  font-size: 1.5rem;
}

.module-title-info {
  flex: 1;
}

.module-name-lg {
  display: block;
  font-weight: 600;
  font-size: 0.95rem;
  margin-bottom: 2px;
}

.module-dims {
  font-size: 0.75rem;
  color: var(--text-secondary);
}

.module-actions-full {
  display: flex;
  gap: 4px;
}

.module-content-full {
  padding: 20px;
  border-top: 1px solid var(--border);
  background: var(--bg-primary);
}

/* Preview Container Full */
.preview-container-full {
  background: white;
  border-radius: var(--radius-lg);
  padding: 24px;
  max-width: 1000px;
  margin: 0 auto;
}

/* Legacy support for existing module-* classes */
.module-number {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--accent);
  color: #000;
  border-radius: 50%;
  font-size: 0.8rem;
  font-weight: 600;
  flex-shrink: 0;
}

.module-drag-handle {
  color: var(--text-secondary);
  cursor: grab;
}

.btn-icon-sm {
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  color: var(--text-secondary);
  transition: all 0.15s ease;
}

.btn-icon-sm:hover:not(:disabled) {
  background: var(--bg-tertiary);
  color: var(--text-primary);
}

.btn-icon-sm:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.btn-icon-sm.delete-btn:hover {
  background: rgba(239, 68, 68, 0.1);
  color: var(--error);
}

/* Responsive Toolbar */
@media (max-width: 1024px) {
  .toolbar-main {
    flex-wrap: wrap;
  }

  .toolbar-center {
    order: 3;
    width: 100%;
    justify-content: flex-start;
    margin-top: 12px;
  }
}

@media (max-width: 768px) {
  .aplus-content-page.aplus-layout-vertical {
    height: auto;
    min-height: 100vh;
  }

  .toolbar-left h1 {
    font-size: 1rem;
  }

  .toolbar-right {
    flex-wrap: wrap;
  }

  .modules-scroll {
    padding-bottom: 12px;
  }

  .module-chip {
    padding: 8px 10px;
  }

  .chip-name {
    display: none;
  }
}

/* Category Filter */
.category-filter {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-bottom: 16px;
}

.category-filter .category-btn {
  padding: 6px 12px;
  font-size: 0.75rem;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: 16px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.category-filter .category-btn:hover {
  border-color: var(--accent);
}

.category-filter .category-btn.active {
  background: rgba(255, 153, 0, 0.1);
  border-color: var(--accent);
  color: var(--accent);
}

/* Module List */
.module-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 16px;
}

.module-card {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
}

.module-card:hover:not(.disabled) {
  border-color: var(--accent);
}

.module-card.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.module-icon {
  font-size: 1.5rem;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-secondary);
  border-radius: var(--radius);
}

.module-info {
  flex: 1;
  min-width: 0;
}

.module-name {
  display: block;
  font-size: 0.85rem;
  font-weight: 500;
  margin-bottom: 2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.module-dimensions {
  font-size: 0.7rem;
  color: var(--text-secondary);
}

.add-module-btn {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--accent);
  color: #000;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.15s ease;
}

.add-module-btn:hover:not(:disabled) {
  transform: scale(1.1);
}

.add-module-btn:disabled {
  background: var(--bg-secondary);
  color: var(--text-secondary);
  cursor: not-allowed;
}

/* Guidelines Section */
.guidelines-section {
  border-top: 1px solid var(--border);
  padding-top: 16px;
}

.guidelines-toggle {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  padding: 10px;
  background: transparent;
  border: none;
  cursor: pointer;
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--text-secondary);
}

.guidelines-toggle svg:last-child {
  margin-left: auto;
}

.guidelines-list {
  padding: 12px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
  margin-top: 8px;
}

.guideline-item {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  font-size: 0.75rem;
  padding: 6px 0;
  color: var(--text-secondary);
}

.guideline-item.do .guideline-icon {
  color: var(--success);
}

.guideline-item.dont .guideline-icon {
  color: var(--error);
}

/* Content Builder */
.content-builder {
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 20px;
  min-height: 500px;
}

.builder-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.builder-header h3 {
  font-size: 1rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

.module-count {
  font-weight: normal;
  color: var(--text-secondary);
  font-size: 0.85rem;
}

.builder-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  text-align: center;
  color: var(--text-secondary);
}

.builder-empty svg {
  margin-bottom: 16px;
  opacity: 0.5;
}

.builder-empty h4 {
  font-size: 1.1rem;
  color: var(--text-primary);
  margin-bottom: 8px;
}

.builder-empty p {
  font-size: 0.9rem;
  margin-bottom: 4px;
}

.builder-empty .hint {
  font-size: 0.8rem;
  opacity: 0.7;
}

/* Modules Container */
.modules-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.module-item {
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  transition: all 0.15s ease;
}

.module-item.dragging {
  opacity: 0.5;
  border-color: var(--accent);
}

.module-item.expanded {
  border-color: var(--accent);
}

.module-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  cursor: grab;
}

.module-header:active {
  cursor: grabbing;
}

.module-drag-handle {
  color: var(--text-secondary);
  cursor: grab;
}

.module-title {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  font-weight: 500;
  font-size: 0.9rem;
}

.module-number {
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--accent);
  color: #000;
  border-radius: 50%;
  font-size: 0.75rem;
  font-weight: 600;
}

.module-icon-small {
  font-size: 1rem;
}

.module-actions {
  display: flex;
  align-items: center;
  gap: 4px;
}

.btn-icon-sm {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  color: var(--text-secondary);
  transition: all 0.15s ease;
}

.btn-icon-sm:hover:not(:disabled) {
  background: var(--bg-secondary);
  color: var(--text-primary);
}

.btn-icon-sm:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.btn-icon-sm.delete-btn:hover {
  background: rgba(239, 68, 68, 0.1);
  color: var(--error);
}

/* Module Content / Editor */
.module-content {
  padding: 16px;
  border-top: 1px solid var(--border);
  background: var(--bg-secondary);
}

.module-editor {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* Reference Image Section */
.reference-image-section {
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
  margin-bottom: 8px;
}

.reference-image-section .module-label {
  display: flex;
  align-items: center;
  gap: 8px;
}

.label-hint {
  font-weight: normal;
  font-size: 0.75rem;
  color: var(--text-secondary);
}

.reference-image-upload-area {
  margin-top: 10px;
}

.reference-image-dropzone {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 24px;
  background: var(--bg-tertiary);
  border: 2px dashed var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
  text-align: center;
}

.reference-image-dropzone:hover {
  border-color: var(--accent);
  background: rgba(255, 153, 0, 0.05);
}

.reference-image-dropzone svg {
  color: var(--text-secondary);
  margin-bottom: 12px;
}

.dropzone-title {
  font-weight: 500;
  font-size: 0.9rem;
  margin-bottom: 4px;
}

.dropzone-hint {
  font-size: 0.75rem;
  color: var(--text-secondary);
  margin-top: 4px;
}

.reference-image-preview {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
}

.reference-image-preview img {
  width: 80px;
  height: 80px;
  object-fit: cover;
  border-radius: var(--radius);
}

.reference-image-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.reference-image-name {
  font-size: 0.85rem;
  font-weight: 500;
  word-break: break-all;
}

.reference-image-info .btn {
  align-self: flex-start;
}

/* AI Prompt Section */
.ai-prompt-section {
  padding: 16px 0;
  border-bottom: 1px solid var(--border);
  margin-bottom: 8px;
}

.ai-prompt-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 12px;
}

.ai-prompt-header .module-label {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 0;
}

.ai-prompt-actions {
  display: flex;
  gap: 8px;
}

.ai-prompt-textarea-wrapper {
  position: relative;
  margin-bottom: 12px;
}

.ai-prompt-textarea {
  width: 100%;
  padding: 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  font-size: 0.85rem;
  font-family: inherit;
  line-height: 1.5;
  resize: vertical;
  min-height: 150px;
  transition: border-color 0.15s ease;
}

.ai-prompt-textarea:focus {
  outline: none;
  border-color: var(--accent);
}

.ai-prompt-textarea::placeholder {
  color: var(--text-secondary);
}

.ai-prompt-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 8px;
  padding: 0 4px;
}

.ai-prompt-footer .char-count {
  font-size: 0.7rem;
  color: var(--text-secondary);
}

.ai-prompt-tags {
  display: flex;
  gap: 8px;
}

.prompt-tag {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 0.7rem;
  padding: 4px 8px;
  background: rgba(255, 153, 0, 0.1);
  color: var(--accent);
  border-radius: 12px;
}

.btn-generate-images {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  width: 100%;
  padding: 12px;
  font-weight: 500;
}

.btn-generate-images:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.ai-prompt-hint {
  font-size: 0.75rem;
  color: var(--text-secondary);
  text-align: center;
  margin-top: 8px;
}

.module-images {
  margin-bottom: 8px;
}

.module-label {
  display: block;
  font-size: 0.85rem;
  font-weight: 500;
  margin-bottom: 10px;
}

.module-label .dim {
  font-weight: normal;
  color: var(--text-secondary);
}

.module-image-grid {
  display: grid;
  gap: 12px;
}

.module-image-grid.images-1 {
  grid-template-columns: 1fr;
  max-width: 300px;
}

.module-image-grid.images-3 {
  grid-template-columns: repeat(3, 1fr);
}

.module-image-grid.images-4 {
  grid-template-columns: repeat(4, 1fr);
}

.module-image-grid.images-5 {
  grid-template-columns: repeat(5, 1fr);
}

.module-image-slot {
  background: var(--bg-tertiary);
  border: 2px dashed var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  min-height: 100px;
}

.module-image-upload {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  width: 100%;
  padding: 16px;
  cursor: pointer;
  color: var(--text-secondary);
  text-align: center;
  transition: all 0.15s ease;
}

.module-image-upload:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.module-image-upload svg {
  margin-bottom: 8px;
}

.module-image-upload span {
  font-size: 0.7rem;
}

.module-image-preview {
  position: relative;
  width: 100%;
  height: 100%;
}

.module-image-preview img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.remove-image-btn {
  position: absolute;
  top: 4px;
  right: 4px;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0, 0, 0, 0.7);
  border: none;
  border-radius: 50%;
  cursor: pointer;
  color: white;
}

.remove-image-btn:hover {
  background: var(--error);
}

/* Module Text Fields */
.module-text-fields {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.module-field {
  position: relative;
}

.module-field label {
  display: block;
  font-size: 0.85rem;
  font-weight: 500;
  margin-bottom: 8px;
}

.module-field input,
.module-field textarea {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  font-size: 0.9rem;
  transition: all 0.15s ease;
}

.module-field input:focus,
.module-field textarea:focus {
  outline: none;
  border-color: var(--accent);
}

.module-field textarea {
  resize: vertical;
  min-height: 80px;
}

.module-field .char-count {
  position: absolute;
  right: 12px;
  bottom: 8px;
  font-size: 0.7rem;
  color: var(--text-secondary);
}

.module-field input + .char-count {
  bottom: 10px;
}

.field-hint {
  font-size: 0.75rem;
  color: var(--text-secondary);
  margin-bottom: 8px;
}

.spec-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  margin-bottom: 8px;
}

.ai-generate-btn {
  align-self: flex-start;
  margin-top: 8px;
}

/* Preview Mode */
.preview-container {
  background: white;
  border-radius: var(--radius);
  padding: 20px;
  min-height: 400px;
}

.preview-frame {
  max-width: 970px;
  margin: 0 auto;
}

.preview-module {
  margin-bottom: 20px;
}

.module-preview {
  border: 1px solid #eee;
  border-radius: 4px;
  overflow: hidden;
}

.preview-text-only {
  padding: 20px;
  background: #f9f9f9;
}

.preview-text-only h4 {
  font-size: 1.1rem;
  margin-bottom: 8px;
  color: #333;
}

.preview-text-only p {
  color: #666;
  line-height: 1.6;
}

.preview-with-image {
  position: relative;
}

.preview-with-image img {
  width: 100%;
  display: block;
}

.preview-placeholder {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px;
  background: #f0f0f0;
  color: #999;
}

.preview-placeholder span {
  font-size: 0.8rem;
  margin-top: 8px;
}

.preview-text {
  padding: 16px;
  background: white;
}

.preview-text h4 {
  font-size: 1rem;
  color: #333;
}

/* Builder Actions */
.builder-actions {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 12px;
  padding-top: 20px;
  margin-top: 20px;
  border-top: 1px solid var(--border);
}

.validation-warning {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: rgba(239, 68, 68, 0.1);
  border-radius: var(--radius);
  font-size: 0.8rem;
  color: var(--error);
  margin-right: auto;
}

/* Responsive A+ Content */
@media (max-width: 1024px) {
  .aplus-layout {
    grid-template-columns: 1fr;
  }

  .module-library {
    position: static;
    max-height: none;
  }
}

@media (max-width: 768px) {
  .aplus-content-page {
    padding: 16px;
  }

  .content-type-tabs {
    flex-direction: column;
  }

  .module-image-grid.images-4,
  .module-image-grid.images-5 {
    grid-template-columns: repeat(2, 1fr);
  }

  .spec-row {
    grid-template-columns: 1fr;
  }
}

/* ============================================
   BRAND STORY CREATOR
   ============================================ */

.brand-story-page {
  /* Inherits from .aplus-content-page */
}

.brand-story-badge {
  font-size: 0.7rem;
  padding: 4px 10px;
  background: linear-gradient(135deg, rgba(255, 153, 0, 0.2), rgba(255, 200, 50, 0.15));
  color: var(--accent);
  border-radius: 12px;
  font-weight: 600;
  letter-spacing: 0.3px;
}

.mandatory-tag {
  font-size: 0.6rem;
  padding: 2px 6px;
  background: rgba(255, 100, 100, 0.15);
  color: #ff6b6b;
  border-radius: 6px;
  margin-left: 8px;
  font-weight: 500;
}

.module-chip.mandatory {
  border: 1px solid rgba(255, 153, 0, 0.3);
}

.chip-lock {
  color: var(--accent);
  opacity: 0.7;
}

/* ASIN Showcase Editor */
.asin-showcase-editor {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.asin-showcase-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
}

.asin-showcase-item {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.asin-showcase-image {
  width: 100%;
  border-radius: var(--radius);
  overflow: hidden;
  border: 2px dashed var(--border);
  background: var(--bg-tertiary);
}

.asin-showcase-image .module-image-upload {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  min-height: 100px;
  gap: 4px;
  cursor: pointer;
  color: var(--text-muted);
  transition: all 0.15s ease;
}

.asin-showcase-image .module-image-upload:hover {
  color: var(--accent);
  border-color: var(--accent);
}

.upload-size-sm {
  font-size: 0.65rem;
  color: var(--text-muted);
}

.asin-input-field {
  width: 100%;
  padding: 8px 10px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: #fff;
  font-size: 0.8rem;
  font-family: monospace;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.asin-input-field:focus {
  border-color: var(--accent);
  outline: none;
}

.asin-input-field::placeholder {
  text-transform: none;
  font-family: inherit;
  letter-spacing: 0;
  color: var(--text-muted);
}

.asin-validation {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 0.7rem;
  font-weight: 500;
}

.asin-validation.valid {
  color: #4caf50;
}

.asin-validation.invalid {
  color: #ff6b6b;
}

/* Q&A Editor */
.qa-editor {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.qa-pairs {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.qa-pair {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 16px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
  border: 1px solid var(--border);
}

.qa-pair-header {
  display: flex;
  align-items: center;
  gap: 8px;
}

.qa-number {
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--accent);
  background: rgba(255, 153, 0, 0.15);
  padding: 3px 8px;
  border-radius: 6px;
}

.qa-question-input {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: #fff;
  font-size: 0.85rem;
  font-weight: 600;
}

.qa-question-input:focus {
  border-color: var(--accent);
  outline: none;
}

.qa-question-input::placeholder {
  color: var(--text-muted);
  font-weight: 400;
}

.qa-answer-input {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: #fff;
  font-size: 0.8rem;
  resize: vertical;
  min-height: 60px;
  font-family: inherit;
}

.qa-answer-input:focus {
  border-color: var(--accent);
  outline: none;
}

.qa-answer-input::placeholder {
  color: var(--text-muted);
}

.qa-char-counter {
  display: flex;
  align-items: center;
  gap: 12px;
}

.char-count.over-limit {
  color: #ff6b6b !important;
  font-weight: 600;
}

.char-warning {
  font-size: 0.75rem;
  color: #ff6b6b;
  font-weight: 500;
}

/* Brand Story Preview - Carousel Layout */
.brand-story-preview {
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: 20px;
}

.brand-story-preview-header {
  text-align: center;
}

.brand-story-preview-header h3 {
  color: #fff;
  font-size: 1.1rem;
  margin: 0;
}

.brand-story-preview-header p {
  color: var(--text-muted);
  font-size: 0.8rem;
  margin: 4px 0 0;
}

.brand-story-carousel {
  display: flex;
  gap: 20px;
  overflow-x: auto;
  padding: 20px 10px;
  scroll-snap-type: x mandatory;
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}

.brand-story-carousel::-webkit-scrollbar {
  height: 6px;
}

.brand-story-carousel::-webkit-scrollbar-track {
  background: transparent;
}

.brand-story-carousel::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
}

.brand-carousel-card {
  flex: 0 0 auto;
  scroll-snap-align: start;
  border-radius: var(--radius);
  overflow: hidden;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
}

.brand-carousel-card.card-carousel-background {
  width: 600px;
  min-height: 300px;
}

.brand-carousel-card.card-focus-image {
  width: 280px;
}

.brand-carousel-card.card-logo-description {
  width: 300px;
}

.brand-carousel-card.card-asin-showcase {
  width: 400px;
}

.brand-carousel-card.card-brand-qa {
  width: 350px;
}

/* Preview Card Styles */
.brand-preview-card {
  padding: 16px;
  color: #fff;
}

.brand-preview-card img {
  width: 100%;
  border-radius: var(--radius);
  object-fit: cover;
}

.preview-card-title {
  font-size: 0.9rem;
  color: #fff;
  margin: 0 0 12px;
}

/* Background preview */
.brand-preview-bg {
  position: relative;
  padding: 0;
  min-height: 280px;
  overflow: hidden;
}

.brand-preview-bg .preview-bg-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  position: absolute;
  top: 0;
  left: 0;
  border-radius: 0;
}

.brand-preview-bg .preview-bg-placeholder {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 280px;
  color: var(--text-muted);
  gap: 8px;
}

.brand-preview-bg .preview-bg-overlay {
  position: relative;
  z-index: 1;
  padding: 20px;
  background: linear-gradient(transparent, rgba(0,0,0,0.7));
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  min-height: 280px;
}

.brand-preview-bg .preview-bg-overlay h3 {
  color: #fff;
  font-size: 1.1rem;
  margin: 0;
}

.brand-preview-bg .preview-bg-overlay p {
  color: rgba(255,255,255,0.8);
  font-size: 0.8rem;
  margin: 4px 0 0;
}

/* ASIN Preview */
.preview-asin-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
}

.preview-asin-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
}

.preview-asin-item img {
  width: 80px;
  height: 88px;
  object-fit: cover;
  border-radius: 6px;
}

.preview-placeholder-sm {
  width: 80px;
  height: 88px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-secondary);
  border-radius: 6px;
  color: var(--text-muted);
}

.preview-asin-label {
  font-size: 0.65rem;
  color: var(--text-muted);
  font-family: monospace;
}

/* Q&A Preview */
.brand-preview-qa {
  padding: 16px;
}

.preview-qa-item {
  margin-bottom: 12px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--border);
}

.preview-qa-item:last-child {
  border-bottom: none;
  margin-bottom: 0;
  padding-bottom: 0;
}

.preview-qa-item strong {
  display: block;
  font-size: 0.8rem;
  color: var(--accent);
  margin-bottom: 4px;
}

.preview-qa-item p {
  font-size: 0.75rem;
  color: var(--text-secondary);
  margin: 0;
  line-height: 1.4;
}

.preview-text h4 {
  color: #fff;
  font-size: 0.85rem;
  margin: 8px 0 4px;
}

.preview-text p {
  color: var(--text-secondary);
  font-size: 0.75rem;
  margin: 0;
  line-height: 1.4;
}

/* Responsive */
@media (max-width: 768px) {
  .asin-showcase-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .brand-carousel-card {
    width: 85vw !important;
    min-width: 260px;
  }

  .preview-asin-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* ============================================
   STOREFRONT DESIGNER
   ============================================ */

.storefront-page {
  /* Inherits from .aplus-content-page */
}

/* ─── Page Tabs ─── */
.sf-page-tabs-row {
  padding: 0 16px !important;
  border-bottom: 1px solid var(--border);
}

.sf-page-tabs {
  display: flex;
  align-items: center;
  gap: 4px;
  overflow-x: auto;
  scrollbar-width: none;
  padding: 8px 0;
}

.sf-page-tabs::-webkit-scrollbar {
  display: none;
}

.sf-page-tab {
  display: flex;
  align-items: center;
  gap: 2px;
  position: relative;
}

.sf-page-tab-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 14px;
  background: transparent;
  border: 1px solid transparent;
  border-radius: var(--radius);
  color: var(--text-secondary);
  font-size: 0.8rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
  white-space: nowrap;
}

.sf-page-tab-btn:hover {
  background: var(--bg-tertiary);
  color: #fff;
}

.sf-page-tab.active .sf-page-tab-btn {
  background: var(--bg-tertiary);
  border-color: var(--accent);
  color: #fff;
  font-weight: 600;
}

.sf-page-widget-count {
  font-size: 0.65rem;
  background: rgba(255, 255, 255, 0.1);
  padding: 2px 6px;
  border-radius: 8px;
  color: var(--text-muted);
}

.sf-page-tab.active .sf-page-widget-count {
  background: rgba(255, 153, 0, 0.2);
  color: var(--accent);
}

.sf-page-remove {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 22px;
  height: 22px;
  background: transparent;
  border: none;
  border-radius: 50%;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.15s ease;
}

.sf-page-remove:hover {
  background: rgba(255, 100, 100, 0.15);
  color: #ff6b6b;
}

.sf-page-name-input {
  padding: 6px 10px;
  background: var(--bg-secondary);
  border: 1px solid var(--accent);
  border-radius: var(--radius);
  color: #fff;
  font-size: 0.8rem;
  width: 120px;
  outline: none;
}

/* ─── Add Page Button & Template Dropdown ─── */
.sf-add-page-wrapper {
  position: relative;
}

.sf-add-page-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 14px;
  background: transparent;
  border: 1px dashed var(--border);
  border-radius: var(--radius);
  color: var(--text-muted);
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.15s ease;
  white-space: nowrap;
}

.sf-add-page-btn:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.sf-template-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  margin-top: 8px;
  width: 280px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  z-index: 100;
  overflow: hidden;
}

.sf-template-dropdown-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 14px;
  border-bottom: 1px solid var(--border);
}

.sf-template-dropdown-header h4 {
  margin: 0;
  font-size: 0.85rem;
  color: #fff;
}

.sf-template-option {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
  padding: 12px 14px;
  background: transparent;
  border: none;
  border-bottom: 1px solid var(--border);
  color: #fff;
  cursor: pointer;
  text-align: left;
  transition: background 0.15s ease;
}

.sf-template-option:last-child {
  border-bottom: none;
}

.sf-template-option:hover {
  background: var(--bg-tertiary);
}

.sf-template-icon {
  font-size: 1.4rem;
}

.sf-template-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.sf-template-name {
  font-size: 0.85rem;
  font-weight: 600;
  color: #fff;
}

.sf-template-desc {
  font-size: 0.7rem;
  color: var(--text-muted);
}

/* ─── Widget Limit Badge ─── */
.chip-limit {
  font-size: 0.55rem;
  padding: 2px 5px;
  background: rgba(255, 100, 100, 0.2);
  color: #ff6b6b;
  border-radius: 4px;
  font-weight: 700;
  letter-spacing: 0.5px;
}

/* ─── Video Upload ─── */
.video-upload-section {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.video-upload-area {
  border-radius: var(--radius);
}

.video-file-info {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 14px 16px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: #fff;
  font-size: 0.85rem;
}

.video-file-info span {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* ─── Shoppable Tags Editor ─── */
.shoppable-tags-editor {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.shoppable-tags-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.shoppable-tag-row {
  display: grid;
  grid-template-columns: 30px 1fr 1fr;
  gap: 8px;
  align-items: center;
}

.tag-number {
  font-size: 0.75rem;
  font-weight: 700;
  color: var(--accent);
  background: rgba(255, 153, 0, 0.15);
  padding: 4px 8px;
  border-radius: 6px;
  text-align: center;
}

/* ─── Product Grid Editor ─── */
.product-grid-editor {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.product-asin-textarea {
  width: 100%;
  padding: 12px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: #fff;
  font-size: 0.8rem;
  font-family: monospace;
  resize: vertical;
}

.product-asin-textarea:focus {
  border-color: var(--accent);
  outline: none;
}

.product-asin-textarea::placeholder {
  font-family: inherit;
  color: var(--text-muted);
}

.product-grid-options {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.grid-layout-options {
  display: flex;
  gap: 8px;
}

.layout-option {
  padding: 8px 16px;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-secondary);
  font-size: 0.8rem;
  cursor: pointer;
  transition: all 0.15s ease;
}

.layout-option:hover {
  border-color: var(--text-muted);
  color: #fff;
}

.layout-option.active {
  background: var(--accent);
  border-color: var(--accent);
  color: #000;
  font-weight: 600;
}

/* ─── Storefront Preview ─── */
.sf-preview-container {
  padding: 20px;
}

.sf-preview-frame {
  max-width: 1200px;
  margin: 0 auto;
  background: var(--bg-tertiary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
}

.sf-preview-header-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 12px 16px;
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border);
  color: #fff;
  font-size: 0.85rem;
  font-weight: 600;
}

.sf-preview-nav {
  display: flex;
  gap: 8px;
  margin-left: auto;
}

.sf-preview-nav-link {
  font-size: 0.75rem;
  padding: 4px 10px;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
  color: var(--text-muted);
  font-weight: 500;
}

.sf-preview-nav-link.active {
  background: var(--accent);
  color: #000;
}

.sf-preview-section {
  border-bottom: 1px solid var(--border);
}

.sf-preview-section:last-child {
  border-bottom: none;
}

/* Preview widget types */
.sf-preview-image {
  position: relative;
}

.sf-preview-image img {
  width: 100%;
  display: block;
}

.sf-preview-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 16px 20px;
  background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
}

.sf-preview-overlay h4 {
  color: #fff;
  margin: 0;
  font-size: 0.95rem;
}

.sf-preview-overlay p {
  color: rgba(255, 255, 255, 0.8);
  margin: 4px 0 0;
  font-size: 0.8rem;
}

.sf-preview-text {
  padding: 20px 24px;
}

.sf-preview-text h3 {
  color: #fff;
  margin: 0 0 8px;
  font-size: 1rem;
}

.sf-preview-text p {
  color: var(--text-secondary);
  margin: 0;
  font-size: 0.85rem;
  line-height: 1.5;
}

.sf-preview-grid {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px;
  gap: 8px;
  color: var(--text-muted);
  font-size: 0.85rem;
}

.sf-preview-shoppable-badge,
.sf-preview-video-badge,
.sf-preview-gallery-badge {
  position: absolute;
  top: 10px;
  right: 10px;
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 0.7rem;
  font-weight: 600;
}

.sf-preview-shoppable-badge {
  background: rgba(76, 175, 80, 0.9);
  color: #fff;
}

.sf-preview-video-badge {
  background: rgba(33, 150, 243, 0.9);
  color: #fff;
}

.sf-preview-gallery-badge {
  background: rgba(255, 153, 0, 0.9);
  color: #000;
}

/* ─── Device Toggle ─── */
.device-toggle {
  display: flex;
  background: var(--bg-tertiary);
  border-radius: var(--radius);
  padding: 3px;
  gap: 2px;
}

.device-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 34px;
  height: 30px;
  background: transparent;
  border: none;
  border-radius: calc(var(--radius) - 2px);
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.15s ease;
}

.device-btn:hover {
  color: #fff;
  background: var(--bg-secondary);
}

.device-btn.active {
  background: var(--accent);
  color: #000;
}

/* ─── Mobile Preview Frame ─── */
.sf-device-mobile {
  display: flex;
  justify-content: center;
  padding: 30px 20px;
  background: var(--bg-secondary);
}

.sf-device-mobile .sf-preview-frame {
  width: 390px;
  max-width: 390px;
  border-radius: 28px;
  border: 3px solid #555;
  box-shadow:
    0 0 0 2px #333,
    0 20px 60px rgba(0, 0, 0, 0.5);
  position: relative;
  overflow: hidden;
}

.sf-device-mobile .sf-preview-frame::before {
  content: '';
  display: block;
  width: 120px;
  height: 5px;
  background: #444;
  border-radius: 3px;
  margin: 10px auto 6px;
}

.sf-device-mobile .sf-preview-header-bar {
  border-radius: 0;
  font-size: 0.75rem;
  padding: 8px 12px;
}

.sf-device-mobile .sf-preview-nav {
  flex-wrap: wrap;
  gap: 4px;
}

.sf-device-mobile .sf-preview-nav-link {
  font-size: 0.65rem;
  padding: 3px 8px;
}

.sf-device-mobile .sf-preview-overlay h4 {
  font-size: 0.8rem;
}

.sf-device-mobile .sf-preview-overlay p {
  font-size: 0.7rem;
}

.sf-device-mobile .sf-preview-text h3 {
  font-size: 0.85rem;
}

.sf-device-mobile .sf-preview-text p {
  font-size: 0.75rem;
}

.sf-device-mobile .sf-preview-grid {
  padding: 24px;
}

.sf-device-mobile .sf-preview-grid span {
  font-size: 0.75rem;
}

.sf-device-mobile .sf-preview-shoppable-badge,
.sf-device-mobile .sf-preview-video-badge,
.sf-device-mobile .sf-preview-gallery-badge {
  font-size: 0.6rem;
  padding: 3px 7px;
}

/* ─── Desktop Preview Frame ─── */
.sf-device-desktop {
  padding: 20px;
}

.sf-device-desktop .sf-preview-frame {
  max-width: 1200px;
  margin: 0 auto;
}

/* Responsive */
@media (max-width: 768px) {
  .sf-page-tabs {
    gap: 2px;
  }

  .sf-template-dropdown {
    width: 240px;
  }

  .shoppable-tag-row {
    grid-template-columns: 30px 1fr;
  }

  .shoppable-tag-row input:last-child {
    grid-column: 2;
  }

  .sf-device-mobile .sf-preview-frame {
    width: 100%;
    max-width: 340px;
  }
}

/* ============================================
   Login Page
   ============================================ */

.login-page {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-primary);
  padding: 20px;
}

.login-container {
  width: 100%;
  max-width: 420px;
  background: var(--bg-secondary);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 40px 32px;
}

.login-header {
  text-align: center;
  margin-bottom: 28px;
}

.login-logo {
  color: var(--accent);
  margin-bottom: 12px;
}

.login-header h1 {
  font-size: 1.5rem;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.login-header p {
  color: var(--text-secondary);
  font-size: 0.9rem;
}

.login-tabs {
  display: flex;
  gap: 0;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  margin-bottom: 24px;
}

.login-tab {
  flex: 1;
  padding: 10px;
  background: transparent;
  border: none;
  color: var(--text-secondary);
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s;
}

.login-tab.active {
  background: var(--accent);
  color: white;
}

.login-form .form-group {
  margin-bottom: 16px;
}

.login-form label {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 0.85rem;
  color: var(--text-secondary);
  margin-bottom: 6px;
}

.login-form input {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg-primary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.95rem;
  transition: border-color 0.2s;
}

.login-form input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
}

.login-error {
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid rgba(239, 68, 68, 0.3);
  color: #ef4444;
  padding: 10px 12px;
  border-radius: var(--radius);
  font-size: 0.85rem;
  margin-bottom: 16px;
}

.login-submit {
  width: 100%;
  padding: 12px;
  background: var(--accent);
  color: white;
  border: none;
  border-radius: var(--radius);
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  transition: opacity 0.2s;
}

.login-submit:hover {
  opacity: 0.9;
}

.login-submit:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* ============================================
   Product Category Dropdown
   ============================================ */

.category-dropdown {
  width: 100%;
  padding: 10px 12px;
  background: var(--bg-primary);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  color: var(--text-primary);
  font-size: 0.9rem;
  cursor: pointer;
  appearance: none;
  -webkit-appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%239CA3AF' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  padding-right: 32px;
  transition: border-color 0.2s, box-shadow 0.2s;
}

.category-dropdown:hover {
  border-color: var(--accent);
}

.category-dropdown:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
}

.category-dropdown option {
  background: var(--bg-secondary);
  color: var(--text-primary);
  padding: 8px;
}

--- END OF FILE ---

--- FILE: src/constants/productCategories.js ---
export const PRODUCT_CATEGORIES = [
  'Electronics',
  'Home & Kitchen',
  'Beauty & Personal Care',
  'Sports & Outdoors',
  'Toys & Games',
  'Clothing & Apparel',
  'Food & Grocery',
  'Pet Supplies',
  'Health & Household',
  'Baby Products',
  'Automotive',
  'Tools & Home Improvement',
  'Office Products',
  'Garden & Outdoor',
  'Arts, Crafts & Sewing',
  'Industrial & Scientific',
  'Musical Instruments',
  'Books & Media',
  'Jewelry & Watches',
  'Shoes & Handbags'
]

--- END OF FILE ---

--- FILE: src/utils/export.js ---
/**
 * Export Utilities
 * Generate CSV and PDF reports for sessions and time tracking
 */

import { formatDuration } from '../services/sessionTracker'

/**
 * Export sessions to CSV
 */
export function exportSessionsToCSV(sessions, filename = 'session-report.csv') {
  const headers = [
    'Session ID',
    'Project',
    'Start Time',
    'End Time',
    'Duration (minutes)',
    'Images Generated',
    'Main Images',
    'Lifestyle Images',
    'Infographic Images',
    'Detail Images',
    'Comparison Images',
    'Status',
    'Notes'
  ]

  const rows = sessions.map(session => [
    session.id,
    session.projectName || '',
    formatDateTime(session.startTime),
    session.endTime ? formatDateTime(session.endTime) : '',
    Math.round(session.duration / 60),
    session.generationCount,
    session.imageTypes?.main || 0,
    session.imageTypes?.lifestyle || 0,
    session.imageTypes?.infographic || 0,
    session.imageTypes?.detail || 0,
    session.imageTypes?.comparison || 0,
    session.status,
    (session.notes || '').replace(/"/g, '""')
  ])

  const csvContent = [
    headers.join(','),
    ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
  ].join('\n')

  downloadFile(csvContent, filename, 'text/csv')
}

/**
 * Export images to CSV
 */
export function exportImagesToCSV(images, filename = 'images-report.csv') {
  const headers = [
    'Image ID',
    'Prompt',
    'Image Type',
    'Product Category',
    'Timestamp',
    'Session ID',
    'Is Favorite',
    'Image URL'
  ]

  const rows = images.map(image => [
    image.id,
    (image.prompt || '').replace(/"/g, '""'),
    image.imageType || '',
    image.productCategory || '',
    formatDateTime(image.timestamp),
    image.sessionId || '',
    image.isFavorite ? 'Yes' : 'No',
    image.imageUrl || ''
  ])

  const csvContent = [
    headers.join(','),
    ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
  ].join('\n')

  downloadFile(csvContent, filename, 'text/csv')
}

/**
 * Generate and export PDF report
 */
export async function exportToPDF(data, type = 'sessions') {
  // Create a printable HTML document
  const html = type === 'sessions'
    ? generateSessionsReport(data)
    : generateImagesReport(data)

  // Open in new window for printing
  const printWindow = window.open('', '_blank')
  printWindow.document.write(html)
  printWindow.document.close()

  // Wait for content to load, then print
  printWindow.onload = () => {
    printWindow.print()
  }
}

function generateSessionsReport(data) {
  const { sessions, stats } = data

  return `
<!DOCTYPE html>
<html>
<head>
  <title>Amazon Listing Generator - Session Report</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; padding: 40px; color: #333; }
    h1 { font-size: 24px; margin-bottom: 8px; }
    .subtitle { color: #666; margin-bottom: 24px; }
    .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 32px; }
    .stat-card { background: #f5f5f5; padding: 16px; border-radius: 8px; }
    .stat-value { font-size: 28px; font-weight: bold; color: #ff9900; }
    .stat-label { font-size: 12px; color: #666; text-transform: uppercase; }
    table { width: 100%; border-collapse: collapse; margin-top: 24px; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e0e0e0; }
    th { background: #f5f5f5; font-weight: 600; font-size: 12px; text-transform: uppercase; }
    td { font-size: 14px; }
    .badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; }
    .badge-completed { background: #e8f5e9; color: #2e7d32; }
    .badge-active { background: #fff3e0; color: #f57c00; }
    @media print {
      body { padding: 20px; }
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <h1>Session Report</h1>
  <p class="subtitle">Amazon Listing Image Generator - Generated ${formatDateTime(new Date().toISOString())}</p>

  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-value">${stats.sessionCount}</div>
      <div class="stat-label">Total Sessions</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">${stats.formattedTotalTime}</div>
      <div class="stat-label">Total Time</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">${stats.totalGenerations}</div>
      <div class="stat-label">Images Generated</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">${formatDuration(stats.averageSessionTime)}</div>
      <div class="stat-label">Avg Session Time</div>
    </div>
  </div>

  <h2>Sessions</h2>
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Project</th>
        <th>Duration</th>
        <th>Images</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      ${sessions.map(session => `
        <tr>
          <td>${formatDateTime(session.startTime)}</td>
          <td>${session.projectName || '-'}</td>
          <td>${formatDuration(session.duration)}</td>
          <td>${session.generationCount}</td>
          <td><span class="badge badge-${session.status}">${session.status}</span></td>
        </tr>
      `).join('')}
    </tbody>
  </table>
</body>
</html>
  `
}

function generateImagesReport(data) {
  const { images, stats } = data

  const typeCount = {}
  images.forEach(img => {
    const type = img.imageType || 'unknown'
    typeCount[type] = (typeCount[type] || 0) + 1
  })

  return `
<!DOCTYPE html>
<html>
<head>
  <title>Amazon Listing Generator - Images Report</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; padding: 40px; color: #333; }
    h1 { font-size: 24px; margin-bottom: 8px; }
    .subtitle { color: #666; margin-bottom: 24px; }
    .stats-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; margin-bottom: 32px; }
    .stat-card { background: #f5f5f5; padding: 12px; border-radius: 8px; text-align: center; }
    .stat-value { font-size: 24px; font-weight: bold; color: #ff9900; }
    .stat-label { font-size: 11px; color: #666; text-transform: uppercase; }
    table { width: 100%; border-collapse: collapse; margin-top: 24px; }
    th, td { padding: 10px; text-align: left; border-bottom: 1px solid #e0e0e0; }
    th { background: #f5f5f5; font-weight: 600; font-size: 11px; text-transform: uppercase; }
    td { font-size: 13px; }
    .prompt { max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .badge { display: inline-block; padding: 2px 6px; border-radius: 4px; font-size: 10px; background: #e3f2fd; color: #1565c0; }
    @media print {
      body { padding: 20px; }
      .stats-grid { grid-template-columns: repeat(3, 1fr); }
    }
  </style>
</head>
<body>
  <h1>Images Report</h1>
  <p class="subtitle">Amazon Listing Image Generator - Generated ${formatDateTime(new Date().toISOString())}</p>

  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-value">${images.length}</div>
      <div class="stat-label">Total Images</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">${typeCount.main || 0}</div>
      <div class="stat-label">Main Images</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">${typeCount.lifestyle || 0}</div>
      <div class="stat-label">Lifestyle</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">${typeCount.infographic || 0}</div>
      <div class="stat-label">Infographic</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">${images.filter(i => i.isFavorite).length}</div>
      <div class="stat-label">Favorites</div>
    </div>
  </div>

  <h2>Generated Images</h2>
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Type</th>
        <th>Category</th>
        <th>Prompt</th>
        <th>Favorite</th>
      </tr>
    </thead>
    <tbody>
      ${images.map(image => `
        <tr>
          <td>${formatDateTime(image.timestamp)}</td>
          <td><span class="badge">${image.imageType || '-'}</span></td>
          <td>${image.productCategory || '-'}</td>
          <td class="prompt" title="${(image.prompt || '').replace(/"/g, '&quot;')}">${image.prompt || '-'}</td>
          <td>${image.isFavorite ? '★' : '-'}</td>
        </tr>
      `).join('')}
    </tbody>
  </table>
</body>
</html>
  `
}

function formatDateTime(isoString) {
  if (!isoString) return '-'
  const date = new Date(isoString)
  return date.toLocaleString('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit'
  })
}

function downloadFile(content, filename, mimeType) {
  const blob = new Blob([content], { type: mimeType })
  const url = URL.createObjectURL(blob)
  const a = document.createElement('a')
  a.href = url
  a.download = filename
  document.body.appendChild(a)
  a.click()
  document.body.removeChild(a)
  URL.revokeObjectURL(url)
}

/**
 * Export summary statistics
 */
export function exportSummaryToJSON(data) {
  const json = JSON.stringify(data, null, 2)
  downloadFile(json, 'summary-export.json', 'application/json')
}

--- END OF FILE ---

--- FILE: src/components/PromptInput.jsx ---
import { Sparkles, Loader2, Package, Camera, LayoutGrid, Users, Zap, Box, RotateCcw, Layers, Maximize, Hand, Grid3X3 } from 'lucide-react'

// Main Image Templates for Amazon product photography
const MAIN_IMAGE_TEMPLATES = [
  {
    id: 'hero',
    label: 'Hero Shot',
    icon: Maximize,
    description: 'Front-facing, dramatic lighting',
    promptModifier: 'hero shot, front-facing view, dramatic studio lighting, product as the star, powerful presence, centered composition'
  },
  {
    id: 'angle45',
    label: '45° Angle',
    icon: RotateCcw,
    description: 'Classic 3/4 view showing depth',
    promptModifier: '45-degree angle view, three-quarter perspective, showing product depth and dimension, professional product photography angle'
  },
  {
    id: 'front',
    label: 'Front View',
    icon: Box,
    description: 'Straight-on front facing',
    promptModifier: 'straight-on front view, symmetrical composition, direct facing camera, clean frontal perspective'
  },
  {
    id: 'side',
    label: 'Side Profile',
    icon: Layers,
    description: 'Side view showing thickness',
    promptModifier: 'side profile view, showing product thickness and depth, 90-degree side angle, profile perspective'
  },
  {
    id: 'topdown',
    label: 'Top-Down',
    icon: Grid3X3,
    description: 'Bird\'s eye view from above',
    promptModifier: 'top-down view, bird\'s eye perspective, flat lay style, overhead shot, looking straight down at product'
  },
  {
    id: 'withscale',
    label: 'With Scale',
    icon: Hand,
    description: 'Shows size reference',
    promptModifier: 'product with scale reference, showing actual size, hand holding product or next to common object for size comparison'
  }
]

const IMAGE_TYPES = [
  { id: 'main', label: 'Main Image', icon: Package, description: 'White background, product only' },
  { id: 'lifestyle', label: 'Lifestyle', icon: Users, description: 'Product in use context' },
  { id: 'infographic', label: 'Infographic', icon: LayoutGrid, description: 'Features & benefits' },
  { id: 'detail', label: 'Detail Shot', icon: Camera, description: 'Close-up details' },
  { id: 'comparison', label: 'Comparison', icon: Zap, description: 'Before/after or vs competitor' }
]

const PRODUCT_CATEGORIES = [
  'Electronics',
  'Home & Kitchen',
  'Beauty',
  'Sports & Outdoors',
  'Toys & Games',
  'Clothing',
  'Food & Grocery',
  'Pet Supplies'
]

// Amazon-compliant aspect ratios
const ASPECT_RATIOS = [
  {
    id: '1:1',
    label: '1:1 Square',
    description: 'Standard for main & additional images',
    dimensions: { width: 2000, height: 2000 },
    recommended: true
  },
  {
    id: '4:3',
    label: '4:3 Portrait',
    description: 'Common for product photography',
    dimensions: { width: 2000, height: 1500 }
  },
  {
    id: '3:2',
    label: '3:2 Rectangle',
    description: 'Desktop search results (may show bars)',
    dimensions: { width: 2000, height: 1333 }
  }
]

const STYLE_MODIFIERS = [
  'Pure white background',
  'Studio lighting',
  'High contrast',
  'Soft shadows',
  '45-degree angle',
  'Eye-level shot',
  'Flat lay',
  'Hero shot'
]

function PromptInput({
  prompt,
  setPrompt,
  onGenerate,
  isLoading,
  imageType,
  setImageType,
  productCategory,
  setProductCategory,
  productName,
  setProductName,
  productAsin,
  setProductAsin,
  mainTemplate,
  setMainTemplate,
  aspectRatio,
  setAspectRatio
}) {
  const handleKeyDown = (e) => {
    if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
      e.preventDefault()
      onGenerate()
    }
  }

  const applyModifier = (modifier) => {
    setPrompt(prev => prev ? `${prev}, ${modifier.toLowerCase()}` : modifier)
  }

  const getPlaceholder = () => {
    switch (imageType) {
      case 'main':
        return 'Describe your product (e.g., "Stainless steel water bottle, 32oz, matte black finish")'
      case 'lifestyle':
        return 'Describe the scene (e.g., "Person hiking in mountains, using the water bottle")'
      case 'infographic':
        return 'List features to highlight (e.g., "Double-wall insulation, leak-proof lid, BPA-free")'
      case 'detail':
        return 'Describe the detail to focus on (e.g., "Close-up of leak-proof lid mechanism")'
      case 'comparison':
        return 'Describe comparison (e.g., "Side by side: our bottle keeps ice 24hrs vs competitor 6hrs")'
      default:
        return 'Describe your product...'
    }
  }

  const selectedType = IMAGE_TYPES.find(t => t.id === imageType)

  return (
    <div className="prompt-section">
      <div className="section-group product-identity">
        <h2>Product Identity</h2>
        <div className="product-inputs">
          <div className="input-field">
            <label htmlFor="product-name">Product Name</label>
            <input
              id="product-name"
              type="text"
              className="product-input"
              value={productName}
              onChange={(e) => setProductName(e.target.value)}
              placeholder="e.g., Stainless Steel Water Bottle 32oz"
              disabled={isLoading}
            />
          </div>
          <div className="input-field">
            <label htmlFor="product-asin">ASIN (Optional)</label>
            <input
              id="product-asin"
              type="text"
              className="product-input asin-input"
              value={productAsin}
              onChange={(e) => setProductAsin(e.target.value.toUpperCase())}
              placeholder="e.g., B08XYZ1234"
              maxLength={10}
              disabled={isLoading}
            />
          </div>
        </div>
      </div>

      <div className="section-group">
        <h2>Image Type</h2>
        <div className="image-type-grid">
          {IMAGE_TYPES.map(type => {
            const Icon = type.icon
            return (
              <button
                key={type.id}
                className={`image-type-btn ${imageType === type.id ? 'active' : ''}`}
                onClick={() => setImageType(type.id)}
                disabled={isLoading}
                title={type.description}
              >
                <Icon size={16} />
                <span>{type.label}</span>
              </button>
            )
          })}
        </div>
        {selectedType && (
          <p className="type-hint">{selectedType.description}</p>
        )}
      </div>

      {imageType === 'main' && (
        <div className="section-group main-templates-section">
          <h2>Main Image Template</h2>
          <div className="main-template-grid">
            {MAIN_IMAGE_TEMPLATES.map(template => {
              const Icon = template.icon
              return (
                <button
                  key={template.id}
                  className={`main-template-btn ${mainTemplate === template.id ? 'active' : ''}`}
                  onClick={() => setMainTemplate(template.id)}
                  disabled={isLoading}
                  title={template.description}
                >
                  <Icon size={20} />
                  <span className="template-label">{template.label}</span>
                  <span className="template-desc">{template.description}</span>
                </button>
              )
            })}
          </div>
        </div>
      )}

      <div className="section-group">
        <h2>Product Category</h2>
        <select
          className="category-select"
          value={productCategory}
          onChange={(e) => setProductCategory(e.target.value)}
          disabled={isLoading}
        >
          <option value="">Select category...</option>
          {PRODUCT_CATEGORIES.map(cat => (
            <option key={cat} value={cat}>{cat}</option>
          ))}
        </select>
      </div>

      <div className="section-group">
        <h2>Aspect Ratio</h2>
        <div className="aspect-ratio-grid">
          {ASPECT_RATIOS.map(ratio => (
            <button
              key={ratio.id}
              className={`aspect-ratio-btn ${aspectRatio === ratio.id ? 'active' : ''} ${ratio.recommended ? 'recommended' : ''}`}
              onClick={() => setAspectRatio(ratio.id)}
              disabled={isLoading}
              title={ratio.description}
            >
              <div className={`ratio-preview ratio-${ratio.id.replace(':', '-')}`}></div>
              <div className="ratio-info">
                <span className="ratio-label">{ratio.label}</span>
                {ratio.recommended && <span className="ratio-badge">Recommended</span>}
              </div>
            </button>
          ))}
        </div>
        <p className="aspect-ratio-tip">
          Min 1,000px longest side • Recommended 2,000px+ for zoom capability
        </p>
      </div>

      <div className="section-group">
        <h2>Product Description</h2>
        <textarea
          className="prompt-textarea"
          value={prompt}
          onChange={(e) => setPrompt(e.target.value)}
          onKeyDown={handleKeyDown}
          placeholder={getPlaceholder()}
          disabled={isLoading}
        />
      </div>

      <div className="section-group">
        <h2>Style Modifiers</h2>
        <div className="templates">
          {STYLE_MODIFIERS.map(modifier => (
            <button
              key={modifier}
              className="template-btn"
              onClick={() => applyModifier(modifier)}
              disabled={isLoading}
            >
              {modifier}
            </button>
          ))}
        </div>
      </div>

      <button
        className="generate-btn"
        onClick={onGenerate}
        disabled={isLoading || !prompt.trim()}
      >
        {isLoading ? (
          <>
            <Loader2 size={16} className="spin" />
            Generating...
          </>
        ) : (
          <>
            <Sparkles size={16} />
            Generate Listing Image
          </>
        )}
      </button>

      {imageType === 'main' && (
        <div className="amazon-tip">
          <strong>Amazon Main Image Requirements:</strong> Pure white background (RGB 255,255,255), product fills 85% of frame, no text/logos/watermarks
        </div>
      )}
    </div>
  )
}

export default PromptInput
export { MAIN_IMAGE_TEMPLATES, ASPECT_RATIOS }

--- END OF FILE ---

--- FILE: src/components/Layout.jsx ---
import { Outlet, Link, useLocation } from 'react-router-dom'
import {
  LayoutDashboard,
  Image,
  GalleryHorizontal,
  Lightbulb,
  FileText,
  LayoutGrid,
  BookOpen,
  Store,
  Coins,
  ChevronRight,
  Menu,
  X
} from 'lucide-react'
import { useState } from 'react'

const navigation = [
  { name: 'Dashboard', href: '/dashboard', icon: LayoutDashboard },
  { name: 'Main Image Generator', href: '/tools/main-image-generator', icon: Image },
  { name: 'Secondary Images', href: '/tools/secondary-images', icon: GalleryHorizontal },
  { name: 'A+ Content', href: '/tools/aplus-content', icon: LayoutGrid },
  { name: 'Brand Story', href: '/tools/brand-story', icon: BookOpen },
  { name: 'Storefront', href: '/tools/storefront', icon: Store },
  { name: 'Creative Campaigns', href: '/tools/creative-campaigns', icon: Lightbulb },
  { name: 'Listing Copywriter', href: '/tools/listing-copywriter', icon: FileText },
]

function Layout() {
  const location = useLocation()
  const [sidebarOpen, setSidebarOpen] = useState(false)
  const [credits] = useState(100) // Mock credits

  return (
    <div className="layout">
      {/* Mobile sidebar toggle */}
      <button
        className="mobile-menu-btn"
        onClick={() => setSidebarOpen(!sidebarOpen)}
      >
        {sidebarOpen ? <X size={24} /> : <Menu size={24} />}
      </button>

      {/* Sidebar */}
      <aside className={`sidebar-nav ${sidebarOpen ? 'open' : ''}`}>
        <div className="sidebar-header">
          <Link to="/" className="logo">
            <Image size={28} className="logo-icon" />
            <span>Amazon Listing Pro</span>
          </Link>
        </div>

        <nav className="nav-links">
          {navigation.map((item) => {
            const isActive = location.pathname === item.href ||
              (item.href !== '/dashboard' && location.pathname.startsWith(item.href))
            const Icon = item.icon
            return (
              <Link
                key={item.name}
                to={item.href}
                className={`nav-link ${isActive ? 'active' : ''}`}
                onClick={() => setSidebarOpen(false)}
              >
                <Icon size={20} />
                <span>{item.name}</span>
                {isActive && <ChevronRight size={16} className="nav-arrow" />}
              </Link>
            )
          })}
        </nav>

        <div className="sidebar-footer">
          <div className="credits-display">
            <Coins size={18} />
            <span>{credits} Credits</span>
          </div>
          <Link to="/legacy" className="legacy-link">
            Legacy Generator
          </Link>
        </div>
      </aside>

      {/* Main content */}
      <main className="main-content">
        <Outlet />
      </main>

      {/* Mobile overlay */}
      {sidebarOpen && (
        <div
          className="sidebar-overlay"
          onClick={() => setSidebarOpen(false)}
        />
      )}
    </div>
  )
}

export default Layout

--- END OF FILE ---

--- FILE: src/components/History.jsx ---
import { Clock } from 'lucide-react'

const IMAGE_TYPE_LABELS = {
  main: 'Main',
  lifestyle: 'Lifestyle',
  infographic: 'Infographic',
  detail: 'Detail',
  comparison: 'Comparison'
}

function History({ history, onSelect, onClear, currentId }) {
  const formatTime = (timestamp) => {
    const date = new Date(timestamp)
    const now = new Date()
    const diff = now - date

    if (diff < 60000) return 'Just now'
    if (diff < 3600000) return `${Math.floor(diff / 60000)}m ago`
    if (diff < 86400000) return `${Math.floor(diff / 3600000)}h ago`
    return date.toLocaleDateString()
  }

  return (
    <div className="history-section">
      <div className="history-header">
        <h2>History</h2>
        {history.length > 0 && (
          <button className="clear-btn" onClick={onClear}>
            Clear
          </button>
        )}
      </div>

      <div className="history-list">
        {history.length === 0 ? (
          <div className="history-empty">
            <Clock size={24} />
            <p>No generations yet</p>
          </div>
        ) : (
          history.map(item => (
            <div
              key={item.id}
              className={`history-item ${currentId === item.id ? 'active' : ''}`}
              onClick={() => onSelect(item)}
            >
              <img
                src={item.imageUrl}
                alt=""
                className="history-thumb"
              />
              <div className="history-info">
                <p className="history-prompt">{item.prompt}</p>
                <div className="history-meta">
                  {item.imageType && (
                    <span className="type-badge">{IMAGE_TYPE_LABELS[item.imageType] || item.imageType}</span>
                  )}
                  <span className="history-time">{formatTime(item.timestamp)}</span>
                </div>
              </div>
            </div>
          ))
        )}
      </div>
    </div>
  )
}

export default History

--- END OF FILE ---

--- FILE: src/components/SettingsPanel.jsx ---
import { useState } from 'react'
import {
  Settings,
  Download,
  FileText,
  FileSpreadsheet,
  Trash2,
  Calendar,
  Key,
  CheckCircle,
  XCircle,
  Loader2
} from 'lucide-react'
import { getProviderInfo, validateCredentials } from '../api/imageGen'
import { exportSessionsToCSV, exportImagesToCSV, exportToPDF } from '../utils/export'
import { isCalendarConfigured } from '../services/calendar'

function SettingsPanel({
  sessions,
  images,
  sessionStats,
  onClearData,
  isCalendarConnected,
  onConnectCalendar,
  onDisconnectCalendar
}) {
  const [isValidating, setIsValidating] = useState(false)
  const [validationResult, setValidationResult] = useState(null)
  const [activeExport, setActiveExport] = useState(null)

  const providerInfo = getProviderInfo()

  const handleValidate = async () => {
    setIsValidating(true)
    setValidationResult(null)
    const result = await validateCredentials()
    setValidationResult(result)
    setIsValidating(false)
  }

  const handleExportSessionsCSV = () => {
    setActiveExport('sessions-csv')
    exportSessionsToCSV(sessions)
    setTimeout(() => setActiveExport(null), 1000)
  }

  const handleExportImagesCSV = () => {
    setActiveExport('images-csv')
    exportImagesToCSV(images)
    setTimeout(() => setActiveExport(null), 1000)
  }

  const handleExportSessionsPDF = async () => {
    setActiveExport('sessions-pdf')
    await exportToPDF({ sessions, stats: sessionStats }, 'sessions')
    setTimeout(() => setActiveExport(null), 1000)
  }

  const handleExportImagesPDF = async () => {
    setActiveExport('images-pdf')
    await exportToPDF({ images, stats: {} }, 'images')
    setTimeout(() => setActiveExport(null), 1000)
  }

  return (
    <div className="settings-panel">
      <div className="settings-section">
        <h3>
          <Key size={16} />
          API Configuration
        </h3>

        <div className="api-status">
          <div className="status-row">
            <span className="status-label">Provider:</span>
            <span className="status-value">{providerInfo.provider.toUpperCase()}</span>
          </div>
          <div className="status-row">
            <span className="status-label">API Key:</span>
            <span className={`status-value ${providerInfo.hasKey ? 'connected' : 'not-connected'}`}>
              {providerInfo.hasKey ? '••••••••' : 'Not configured'}
            </span>
          </div>
          {providerInfo.isDemo && (
            <p className="demo-notice">
              Running in demo mode. Configure your API key in .env to use real image generation.
            </p>
          )}

          <button
            className="validate-btn"
            onClick={handleValidate}
            disabled={isValidating || providerInfo.isDemo}
          >
            {isValidating ? (
              <><Loader2 size={14} className="spin" /> Validating...</>
            ) : (
              <><Key size={14} /> Test Connection</>
            )}
          </button>

          {validationResult && (
            <div className={`validation-result ${validationResult.valid ? 'valid' : 'invalid'}`}>
              {validationResult.valid ? <CheckCircle size={14} /> : <XCircle size={14} />}
              {validationResult.message}
            </div>
          )}
        </div>
      </div>

      <div className="settings-section">
        <h3>
          <Calendar size={16} />
          Calendar Integration
        </h3>

        <p className="section-desc">
          Connect to Google Calendar to automatically create focus time blocks when you start sessions.
          Works with Clockwise for smart scheduling.
        </p>

        {!isCalendarConfigured() ? (
          <p className="config-notice">
            Calendar integration requires Google API credentials. Add VITE_GOOGLE_CLIENT_ID and
            VITE_GOOGLE_API_KEY to your .env file.
          </p>
        ) : isCalendarConnected ? (
          <div className="calendar-connected">
            <CheckCircle size={14} />
            <span>Connected to Google Calendar</span>
            <button className="disconnect-btn" onClick={onDisconnectCalendar}>
              Disconnect
            </button>
          </div>
        ) : (
          <button className="connect-calendar-btn" onClick={onConnectCalendar}>
            <Calendar size={14} />
            Connect Google Calendar
          </button>
        )}
      </div>

      <div className="settings-section">
        <h3>
          <Download size={16} />
          Export Data
        </h3>

        <div className="export-grid">
          <div className="export-group">
            <h4>Sessions Report</h4>
            <div className="export-buttons">
              <button
                className={`export-btn ${activeExport === 'sessions-csv' ? 'exporting' : ''}`}
                onClick={handleExportSessionsCSV}
                disabled={sessions.length === 0}
              >
                <FileSpreadsheet size={14} />
                CSV
              </button>
              <button
                className={`export-btn ${activeExport === 'sessions-pdf' ? 'exporting' : ''}`}
                onClick={handleExportSessionsPDF}
                disabled={sessions.length === 0}
              >
                <FileText size={14} />
                PDF
              </button>
            </div>
            <span className="export-count">{sessions.length} sessions</span>
          </div>

          <div className="export-group">
            <h4>Images Report</h4>
            <div className="export-buttons">
              <button
                className={`export-btn ${activeExport === 'images-csv' ? 'exporting' : ''}`}
                onClick={handleExportImagesCSV}
                disabled={images.length === 0}
              >
                <FileSpreadsheet size={14} />
                CSV
              </button>
              <button
                className={`export-btn ${activeExport === 'images-pdf' ? 'exporting' : ''}`}
                onClick={handleExportImagesPDF}
                disabled={images.length === 0}
              >
                <FileText size={14} />
                PDF
              </button>
            </div>
            <span className="export-count">{images.length} images</span>
          </div>
        </div>
      </div>

      <div className="settings-section danger-zone">
        <h3>
          <Trash2 size={16} />
          Danger Zone
        </h3>

        <button className="clear-data-btn" onClick={onClearData}>
          <Trash2 size={14} />
          Clear All Data
        </button>
        <p className="danger-warning">
          This will permanently delete all sessions, images, and history.
        </p>
      </div>
    </div>
  )
}

export default SettingsPanel

--- END OF FILE ---

--- FILE: src/components/PromptPreview.jsx ---
import { useState } from 'react'
import { Eye, EyeOff, Copy, Check } from 'lucide-react'
import { REFERENCE_TAGS } from './ReferenceImageUpload'

function PromptPreview({
  textPrompt,
  referenceImages,
  imageType,
  productCategory
}) {
  const [isExpanded, setIsExpanded] = useState(false)
  const [copied, setCopied] = useState(false)

  // Build the final prompt structure
  const buildPromptStructure = () => {
    const parts = []

    // Base prompt info
    parts.push({
      type: 'header',
      label: 'Text Prompt',
      content: textPrompt || '(No text prompt)'
    })

    // Image type context
    if (imageType) {
      const typeLabels = {
        main: 'Main Product Image (white background, 85% fill)',
        lifestyle: 'Lifestyle Shot (product in use)',
        infographic: 'Infographic (features & benefits)',
        detail: 'Detail Shot (close-up)',
        comparison: 'Comparison Image'
      }
      parts.push({
        type: 'context',
        label: 'Image Type',
        content: typeLabels[imageType] || imageType
      })
    }

    // Category context
    if (productCategory) {
      parts.push({
        type: 'context',
        label: 'Category',
        content: productCategory
      })
    }

    // Reference images
    if (referenceImages.length > 0) {
      const sortedRefs = [...referenceImages].sort((a, b) => a.order - b.order)

      sortedRefs.forEach((ref, idx) => {
        const tag = REFERENCE_TAGS.find(t => t.id === ref.tag)
        parts.push({
          type: 'reference',
          label: `Reference ${idx + 1}`,
          content: `${tag?.label || ref.tag} @ ${ref.strength}% strength`,
          tag: ref.tag,
          tagColor: tag?.color,
          imageName: ref.name
        })
      })
    }

    return parts
  }

  const promptParts = buildPromptStructure()
  const hasReferences = referenceImages.length > 0

  // Generate copyable text version
  const getCopyablePrompt = () => {
    let text = `Text Prompt: ${textPrompt || '(none)'}\n`
    if (imageType) text += `Image Type: ${imageType}\n`
    if (productCategory) text += `Category: ${productCategory}\n`

    if (hasReferences) {
      text += '\nReference Images:\n'
      referenceImages.forEach((ref, idx) => {
        const tag = REFERENCE_TAGS.find(t => t.id === ref.tag)
        text += `  ${idx + 1}. ${ref.name} - ${tag?.label} @ ${ref.strength}%\n`
      })
    }

    return text
  }

  const handleCopy = async () => {
    await navigator.clipboard.writeText(getCopyablePrompt())
    setCopied(true)
    setTimeout(() => setCopied(false), 2000)
  }

  if (!textPrompt && !hasReferences) {
    return null
  }

  return (
    <div className={`prompt-preview ${isExpanded ? 'expanded' : ''}`}>
      <div className="preview-header" onClick={() => setIsExpanded(!isExpanded)}>
        <div className="preview-title">
          {isExpanded ? <EyeOff size={14} /> : <Eye size={14} />}
          <span>Prompt Structure Preview</span>
          {hasReferences && (
            <span className="ref-badge">{referenceImages.length} refs</span>
          )}
        </div>
        <button
          className="copy-prompt-btn"
          onClick={(e) => {
            e.stopPropagation()
            handleCopy()
          }}
          title="Copy prompt structure"
        >
          {copied ? <Check size={14} /> : <Copy size={14} />}
        </button>
      </div>

      {isExpanded && (
        <div className="preview-content">
          {promptParts.map((part, idx) => (
            <div key={idx} className={`preview-part ${part.type}`}>
              <span className="part-label">{part.label}</span>
              <span
                className="part-content"
                style={part.tagColor ? { borderLeftColor: part.tagColor } : {}}
              >
                {part.type === 'reference' && (
                  <span
                    className="part-tag"
                    style={{ backgroundColor: part.tagColor }}
                  >
                    {part.tag}
                  </span>
                )}
                {part.content}
                {part.imageName && (
                  <span className="part-filename">({part.imageName})</span>
                )}
              </span>
            </div>
          ))}

          <div className="preview-note">
            This structure will be sent to the image generation API.
            Reference images are encoded and sent alongside the text prompt.
          </div>
        </div>
      )}
    </div>
  )
}

export default PromptPreview

--- END OF FILE ---

--- FILE: src/components/StylePresets.jsx ---
import { useState } from 'react'
import { Bookmark, Plus, Trash2, Check, X, FolderOpen } from 'lucide-react'

function StylePresets({
  presets,
  currentImages,
  onSavePreset,
  onLoadPreset,
  onDeletePreset,
  disabled = false
}) {
  const [isCreating, setIsCreating] = useState(false)
  const [newPresetName, setNewPresetName] = useState('')
  const [selectedPresetId, setSelectedPresetId] = useState(null)

  const handleSave = () => {
    if (!newPresetName.trim() || currentImages.length === 0) return

    onSavePreset({
      id: `preset-${Date.now()}`,
      name: newPresetName.trim(),
      images: currentImages.map(img => ({
        name: img.name,
        base64: img.base64,
        strength: img.strength,
        tag: img.tag,
        order: img.order
      })),
      createdAt: new Date().toISOString()
    })

    setNewPresetName('')
    setIsCreating(false)
  }

  const handleLoad = (preset) => {
    setSelectedPresetId(preset.id)
    onLoadPreset(preset)
  }

  const handleDelete = (e, presetId) => {
    e.stopPropagation()
    if (confirm('Delete this style preset?')) {
      onDeletePreset(presetId)
      if (selectedPresetId === presetId) {
        setSelectedPresetId(null)
      }
    }
  }

  return (
    <div className="style-presets-section">
      <div className="section-header">
        <h2>
          <Bookmark size={14} />
          Style Presets
        </h2>
        {!isCreating && currentImages.length > 0 && (
          <button
            className="save-preset-btn"
            onClick={() => setIsCreating(true)}
            disabled={disabled}
            title="Save current references as preset"
          >
            <Plus size={14} />
            Save
          </button>
        )}
      </div>

      {/* Create new preset form */}
      {isCreating && (
        <div className="create-preset-form">
          <input
            type="text"
            className="preset-name-input"
            placeholder="Preset name..."
            value={newPresetName}
            onChange={(e) => setNewPresetName(e.target.value)}
            onKeyDown={(e) => e.key === 'Enter' && handleSave()}
            autoFocus
          />
          <div className="preset-form-actions">
            <button
              className="preset-action save"
              onClick={handleSave}
              disabled={!newPresetName.trim()}
            >
              <Check size={14} />
            </button>
            <button
              className="preset-action cancel"
              onClick={() => {
                setIsCreating(false)
                setNewPresetName('')
              }}
            >
              <X size={14} />
            </button>
          </div>
        </div>
      )}

      {/* Presets list */}
      {presets.length > 0 ? (
        <div className="presets-list">
          {presets.map(preset => (
            <div
              key={preset.id}
              className={`preset-item ${selectedPresetId === preset.id ? 'active' : ''}`}
              onClick={() => !disabled && handleLoad(preset)}
            >
              <div className="preset-thumbnails">
                {preset.images.slice(0, 3).map((img, idx) => (
                  <div
                    key={idx}
                    className="preset-thumb"
                    style={{
                      backgroundImage: `url(${img.base64})`,
                      zIndex: 3 - idx
                    }}
                  />
                ))}
                {preset.images.length > 3 && (
                  <span className="preset-more">+{preset.images.length - 3}</span>
                )}
              </div>

              <div className="preset-info">
                <span className="preset-name">{preset.name}</span>
                <span className="preset-count">{preset.images.length} images</span>
              </div>

              <button
                className="preset-delete-btn"
                onClick={(e) => handleDelete(e, preset.id)}
                disabled={disabled}
                title="Delete preset"
              >
                <Trash2 size={12} />
              </button>
            </div>
          ))}
        </div>
      ) : (
        <div className="presets-empty">
          <FolderOpen size={20} />
          <p>No saved presets</p>
          <span>Add reference images and save as preset</span>
        </div>
      )}
    </div>
  )
}

export default StylePresets

--- END OF FILE ---

--- FILE: src/components/ReferenceImageUpload.jsx ---
import { useState, useRef, useCallback } from 'react'
import { Upload, X, Image, GripVertical, Sliders } from 'lucide-react'

const ACCEPTED_FORMATS = ['image/png', 'image/jpeg', 'image/webp']
const MAX_IMAGES = 4
const MAX_FILE_SIZE = 10 * 1024 * 1024 // 10MB

const REFERENCE_TAGS = [
  { id: 'style', label: 'Style Reference', color: '#8b5cf6' },
  { id: 'composition', label: 'Composition', color: '#3b82f6' },
  { id: 'color', label: 'Color Palette', color: '#10b981' },
  { id: 'subject', label: 'Subject Reference', color: '#f59e0b' }
]

function ReferenceImageUpload({
  referenceImages,
  setReferenceImages,
  disabled = false
}) {
  const [isDragging, setIsDragging] = useState(false)
  const [error, setError] = useState(null)
  const fileInputRef = useRef(null)
  const dragCounter = useRef(0)

  // Convert file to base64
  const fileToBase64 = (file) => {
    return new Promise((resolve, reject) => {
      const reader = new FileReader()
      reader.onload = () => resolve(reader.result)
      reader.onerror = reject
      reader.readAsDataURL(file)
    })
  }

  // Process uploaded files
  const processFiles = useCallback(async (files) => {
    setError(null)
    const validFiles = []

    for (const file of files) {
      // Check format
      if (!ACCEPTED_FORMATS.includes(file.type)) {
        setError(`Invalid format: ${file.name}. Use PNG, JPG, or WEBP.`)
        continue
      }

      // Check size
      if (file.size > MAX_FILE_SIZE) {
        setError(`File too large: ${file.name}. Max 10MB.`)
        continue
      }

      // Check max count
      if (referenceImages.length + validFiles.length >= MAX_IMAGES) {
        setError(`Maximum ${MAX_IMAGES} reference images allowed.`)
        break
      }

      validFiles.push(file)
    }

    // Convert valid files to base64 and add to state
    const newImages = await Promise.all(
      validFiles.map(async (file) => {
        const base64 = await fileToBase64(file)
        return {
          id: `ref-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
          file,
          name: file.name,
          base64,
          preview: URL.createObjectURL(file),
          strength: 75,
          tag: 'style',
          order: referenceImages.length + validFiles.indexOf(file)
        }
      })
    )

    setReferenceImages(prev => [...prev, ...newImages])
  }, [referenceImages, setReferenceImages])

  // Drag handlers
  const handleDragEnter = (e) => {
    e.preventDefault()
    e.stopPropagation()
    dragCounter.current++
    if (e.dataTransfer.items && e.dataTransfer.items.length > 0) {
      setIsDragging(true)
    }
  }

  const handleDragLeave = (e) => {
    e.preventDefault()
    e.stopPropagation()
    dragCounter.current--
    if (dragCounter.current === 0) {
      setIsDragging(false)
    }
  }

  const handleDragOver = (e) => {
    e.preventDefault()
    e.stopPropagation()
  }

  const handleDrop = (e) => {
    e.preventDefault()
    e.stopPropagation()
    setIsDragging(false)
    dragCounter.current = 0

    if (disabled) return

    const files = Array.from(e.dataTransfer.files)
    if (files.length > 0) {
      processFiles(files)
    }
  }

  const handleFileSelect = (e) => {
    const files = Array.from(e.target.files)
    if (files.length > 0) {
      processFiles(files)
    }
    // Reset input
    e.target.value = ''
  }

  const handleRemoveImage = (id) => {
    setReferenceImages(prev => {
      const image = prev.find(img => img.id === id)
      if (image?.preview) {
        URL.revokeObjectURL(image.preview)
      }
      return prev.filter(img => img.id !== id)
    })
  }

  const handleStrengthChange = (id, strength) => {
    setReferenceImages(prev =>
      prev.map(img => img.id === id ? { ...img, strength } : img)
    )
  }

  const handleTagChange = (id, tag) => {
    setReferenceImages(prev =>
      prev.map(img => img.id === id ? { ...img, tag } : img)
    )
  }

  const handleReorder = (dragIndex, hoverIndex) => {
    setReferenceImages(prev => {
      const newImages = [...prev]
      const draggedImage = newImages[dragIndex]
      newImages.splice(dragIndex, 1)
      newImages.splice(hoverIndex, 0, draggedImage)
      return newImages.map((img, idx) => ({ ...img, order: idx }))
    })
  }

  const moveImage = (index, direction) => {
    const newIndex = index + direction
    if (newIndex < 0 || newIndex >= referenceImages.length) return
    handleReorder(index, newIndex)
  }

  return (
    <div className="reference-upload-section">
      <div className="section-header">
        <h2>
          <Image size={14} />
          Reference Images
        </h2>
        <span className="image-count">{referenceImages.length}/{MAX_IMAGES}</span>
      </div>

      {/* Drop zone */}
      <div
        className={`drop-zone ${isDragging ? 'dragging' : ''} ${disabled ? 'disabled' : ''}`}
        onDragEnter={handleDragEnter}
        onDragLeave={handleDragLeave}
        onDragOver={handleDragOver}
        onDrop={handleDrop}
        onClick={() => !disabled && fileInputRef.current?.click()}
      >
        <Upload size={24} />
        <p>Drop images here or click to upload</p>
        <span className="drop-hint">PNG, JPG, WEBP up to 10MB</span>
        <input
          ref={fileInputRef}
          type="file"
          accept={ACCEPTED_FORMATS.join(',')}
          multiple
          onChange={handleFileSelect}
          disabled={disabled}
          style={{ display: 'none' }}
        />
      </div>

      {error && <p className="upload-error">{error}</p>}

      {/* Reference image previews */}
      {referenceImages.length > 0 && (
        <div className="reference-images-list">
          {referenceImages.map((image, index) => (
            <ReferenceImageItem
              key={image.id}
              image={image}
              index={index}
              totalCount={referenceImages.length}
              onRemove={() => handleRemoveImage(image.id)}
              onStrengthChange={(strength) => handleStrengthChange(image.id, strength)}
              onTagChange={(tag) => handleTagChange(image.id, tag)}
              onMoveUp={() => moveImage(index, -1)}
              onMoveDown={() => moveImage(index, 1)}
              disabled={disabled}
            />
          ))}
        </div>
      )}
    </div>
  )
}

function ReferenceImageItem({
  image,
  index,
  totalCount,
  onRemove,
  onStrengthChange,
  onTagChange,
  onMoveUp,
  onMoveDown,
  disabled
}) {
  const [showControls, setShowControls] = useState(false)
  const currentTag = REFERENCE_TAGS.find(t => t.id === image.tag)

  return (
    <div
      className={`reference-image-item ${showControls ? 'expanded' : ''}`}
      style={{ '--tag-color': currentTag?.color || '#6b7280' }}
    >
      <div className="ref-image-main">
        <div className="ref-image-reorder">
          <button
            className="reorder-btn"
            onClick={onMoveUp}
            disabled={disabled || index === 0}
            title="Move up"
          >
            ▲
          </button>
          <span className="ref-order">{index + 1}</span>
          <button
            className="reorder-btn"
            onClick={onMoveDown}
            disabled={disabled || index === totalCount - 1}
            title="Move down"
          >
            ▼
          </button>
        </div>

        <div className="ref-image-preview">
          <img src={image.preview} alt={image.name} />
          <div
            className="ref-tag-indicator"
            style={{ backgroundColor: currentTag?.color }}
            title={currentTag?.label}
          />
        </div>

        <div className="ref-image-info">
          <span className="ref-image-name" title={image.name}>
            {image.name.length > 15 ? image.name.substring(0, 12) + '...' : image.name}
          </span>
          <span className="ref-image-strength">{image.strength}%</span>
        </div>

        <div className="ref-image-actions">
          <button
            className="ref-action-btn"
            onClick={() => setShowControls(!showControls)}
            disabled={disabled}
            title="Settings"
          >
            <Sliders size={14} />
          </button>
          <button
            className="ref-action-btn remove"
            onClick={onRemove}
            disabled={disabled}
            title="Remove"
          >
            <X size={14} />
          </button>
        </div>
      </div>

      {showControls && (
        <div className="ref-image-controls">
          <div className="control-group">
            <label>Influence Strength</label>
            <div className="strength-slider">
              <input
                type="range"
                min="0"
                max="100"
                value={image.strength}
                onChange={(e) => onStrengthChange(parseInt(e.target.value))}
                disabled={disabled}
              />
              <span className="strength-value">{image.strength}%</span>
            </div>
          </div>

          <div className="control-group">
            <label>Reference Type</label>
            <div className="tag-buttons">
              {REFERENCE_TAGS.map(tag => (
                <button
                  key={tag.id}
                  className={`tag-btn ${image.tag === tag.id ? 'active' : ''}`}
                  style={{
                    '--tag-color': tag.color,
                    backgroundColor: image.tag === tag.id ? tag.color : 'transparent'
                  }}
                  onClick={() => onTagChange(tag.id)}
                  disabled={disabled}
                >
                  {tag.label}
                </button>
              ))}
            </div>
          </div>
        </div>
      )}
    </div>
  )
}

export default ReferenceImageUpload
export { REFERENCE_TAGS }

--- END OF FILE ---

--- FILE: src/components/SessionPanel.jsx ---
import { useState, useEffect } from 'react'
import { Play, Square, Clock, Calendar, Image, TrendingUp } from 'lucide-react'
import { formatDuration, calculateLiveDuration } from '../services/sessionTracker'

function SessionPanel({
  activeSession,
  onStartSession,
  onEndSession,
  sessionStats,
  isCalendarConnected,
  onConnectCalendar
}) {
  const [liveDuration, setLiveDuration] = useState(0)
  const [projectName, setProjectName] = useState('')

  // Update live duration every second when session is active
  useEffect(() => {
    if (!activeSession) {
      setLiveDuration(0)
      return
    }

    const interval = setInterval(() => {
      setLiveDuration(calculateLiveDuration(activeSession.startTime))
    }, 1000)

    return () => clearInterval(interval)
  }, [activeSession])

  const handleStart = () => {
    onStartSession(projectName || null)
    setProjectName('')
  }

  return (
    <div className="session-panel">
      <div className="session-header">
        <h2>Session Tracker</h2>
        {!isCalendarConnected && (
          <button className="calendar-connect-btn" onClick={onConnectCalendar}>
            <Calendar size={14} />
            Connect Calendar
          </button>
        )}
      </div>

      {activeSession ? (
        <div className="active-session">
          <div className="session-timer">
            <Clock size={20} className="timer-icon pulse" />
            <span className="timer-value">{formatDuration(liveDuration)}</span>
          </div>

          {activeSession.projectName && (
            <p className="session-project">{activeSession.projectName}</p>
          )}

          <div className="session-live-stats">
            <div className="live-stat">
              <Image size={14} />
              <span>{activeSession.generationCount} images</span>
            </div>
          </div>

          <button className="session-btn stop" onClick={onEndSession}>
            <Square size={16} />
            End Session
          </button>
        </div>
      ) : (
        <div className="start-session">
          <input
            type="text"
            className="project-input"
            placeholder="Project name (optional)"
            value={projectName}
            onChange={(e) => setProjectName(e.target.value)}
            onKeyDown={(e) => e.key === 'Enter' && handleStart()}
          />
          <button className="session-btn start" onClick={handleStart}>
            <Play size={16} />
            Start Session
          </button>
        </div>
      )}

      {sessionStats && (
        <div className="session-stats">
          <h3>
            <TrendingUp size={14} />
            Last 30 Days
          </h3>
          <div className="stats-grid">
            <div className="stat-item">
              <span className="stat-value">{sessionStats.sessionCount}</span>
              <span className="stat-label">Sessions</span>
            </div>
            <div className="stat-item">
              <span className="stat-value">{sessionStats.formattedTotalTime}</span>
              <span className="stat-label">Total Time</span>
            </div>
            <div className="stat-item">
              <span className="stat-value">{sessionStats.totalGenerations}</span>
              <span className="stat-label">Images</span>
            </div>
            <div className="stat-item">
              <span className="stat-value">{formatDuration(sessionStats.averageSessionTime)}</span>
              <span className="stat-label">Avg Session</span>
            </div>
          </div>
        </div>
      )}
    </div>
  )
}

export default SessionPanel

--- END OF FILE ---

--- FILE: src/components/ImageDisplay.jsx ---
import { Heart, Download, Package, AlertCircle } from 'lucide-react'

const IMAGE_TYPE_LABELS = {
  main: 'Main Image',
  lifestyle: 'Lifestyle',
  infographic: 'Infographic',
  detail: 'Detail Shot',
  comparison: 'Comparison'
}

function ImageDisplay({ image, isLoading, loadingProgress, error, onSave, isFavorited }) {
  const handleDownload = async () => {
    if (!image?.imageUrl) return

    try {
      const response = await fetch(image.imageUrl)
      const blob = await response.blob()
      const url = URL.createObjectURL(blob)
      const a = document.createElement('a')
      a.href = url
      const typeLabel = image.imageType ? `-${image.imageType}` : ''
      a.download = `amazon-listing${typeLabel}-${image.id}.png`
      document.body.appendChild(a)
      a.click()
      document.body.removeChild(a)
      URL.revokeObjectURL(url)
    } catch (err) {
      console.error('Download failed:', err)
    }
  }

  return (
    <div className="image-display">
      <div className="image-container">
        {isLoading ? (
          <div className="loading">
            <div className="spinner"></div>
            <p className="loading-text">
              {loadingProgress?.message || 'Generating listing image...'}
            </p>
            {loadingProgress && loadingProgress.progress > 0 && (
              <div className="progress-container">
                <div className="progress-bar">
                  <div
                    className="progress-fill"
                    style={{ width: `${loadingProgress.progress}%` }}
                  />
                </div>
                <p className="progress-message">{loadingProgress.progress}% complete</p>
              </div>
            )}
          </div>
        ) : error ? (
          <div className="error-message">
            <AlertCircle size={48} />
            <p>{error}</p>
          </div>
        ) : image ? (
          <img
            src={image.imageUrl}
            alt={image.prompt}
            className="generated-image"
          />
        ) : (
          <div className="image-placeholder">
            <Package size={64} />
            <p>Describe your product and click Generate</p>
            <span className="placeholder-hint">Select image type, category, and add product details</span>
          </div>
        )}
      </div>

      {image && !isLoading && !error && (
        <>
          <div className="image-actions">
            <button
              className={`action-btn ${isFavorited ? 'favorited' : ''}`}
              onClick={onSave}
            >
              <Heart size={16} fill={isFavorited ? 'currentColor' : 'none'} />
              {isFavorited ? 'Saved' : 'Save to Gallery'}
            </button>
            <button className="action-btn" onClick={handleDownload}>
              <Download size={16} />
              Download
            </button>
          </div>
          <div className="image-info">
            {image.imageType && (
              <span className="type-badge">{IMAGE_TYPE_LABELS[image.imageType]}</span>
            )}
            {image.productCategory && (
              <span className="category-badge">{image.productCategory}</span>
            )}
            {image.provider && image.provider !== 'demo' && (
              <span className="provider-badge">{image.provider}</span>
            )}
          </div>
          <p className="image-prompt">"{image.prompt}"</p>
        </>
      )}
    </div>
  )
}

export default ImageDisplay

--- END OF FILE ---

--- FILE: src/components/Gallery.jsx ---
import { Heart, Trash2, Package } from 'lucide-react'

const IMAGE_TYPE_LABELS = {
  main: 'Main Image',
  lifestyle: 'Lifestyle',
  infographic: 'Infographic',
  detail: 'Detail Shot',
  comparison: 'Comparison'
}

function Gallery({ favorites, onRemove, onSelect }) {
  const formatDate = (timestamp) => {
    return new Date(timestamp).toLocaleDateString('en-US', {
      month: 'short',
      day: 'numeric',
      year: 'numeric'
    })
  }

  if (favorites.length === 0) {
    return (
      <div className="gallery">
        <h2>Saved Listing Images</h2>
        <div className="gallery-empty">
          <Package size={48} />
          <p>No saved images yet. Generate Amazon listing images and save your favorites!</p>
        </div>
      </div>
    )
  }

  return (
    <div className="gallery">
      <h2>Saved Listing Images ({favorites.length})</h2>
      <div className="gallery-grid">
        {favorites.map(item => (
          <div key={item.id} className="gallery-card">
            <img
              src={item.imageUrl}
              alt={item.prompt}
              className="gallery-image"
              onClick={() => onSelect(item)}
            />
            <div className="gallery-card-info">
              {item.imageType && (
                <span className="type-badge">{IMAGE_TYPE_LABELS[item.imageType] || item.imageType}</span>
              )}
              <p className="gallery-card-prompt">{item.prompt}</p>
              <div className="gallery-card-footer">
                <span className="gallery-card-time">
                  {item.productCategory && `${item.productCategory} • `}
                  {formatDate(item.timestamp)}
                </span>
                <button
                  className="remove-btn"
                  onClick={() => onRemove(item.id)}
                >
                  <Trash2 size={14} />
                  Remove
                </button>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  )
}

export default Gallery

--- END OF FILE ---

--- FILE: src/hooks/useAuth.jsx ---
import { createContext, useContext, useState, useEffect } from 'react'
import { getMe, login as apiLogin, register as apiRegister, logout as apiLogout } from '../api/auth'
import { isAuthenticated as checkAuth } from '../api/client'

const AuthContext = createContext(null)

export function AuthProvider({ children }) {
  const [user, setUser] = useState(null)
  const [loading, setLoading] = useState(true)

  useEffect(() => {
    // Check if there's a stored token on mount
    if (checkAuth()) {
      getMe()
        .then((data) => {
          if (data) setUser(data)
        })
        .catch(() => {
          // Token expired or invalid
          setUser(null)
        })
        .finally(() => setLoading(false))
    } else {
      setLoading(false)
    }
  }, [])

  const login = async (email, password) => {
    const data = await apiLogin(email, password)
    setUser(data.user)
    return data
  }

  const register = async (email, password, displayName) => {
    const data = await apiRegister(email, password, displayName)
    setUser(data.user)
    return data
  }

  const logout = () => {
    setUser(null)
    apiLogout()
  }

  return (
    <AuthContext.Provider
      value={{
        user,
        loading,
        isAuthenticated: !!user,
        login,
        register,
        logout,
      }}
    >
      {children}
    </AuthContext.Provider>
  )
}

export function useAuth() {
  const context = useContext(AuthContext)
  if (!context) {
    throw new Error('useAuth must be used within an AuthProvider')
  }
  return context
}

--- END OF FILE ---

--- FILE: src/api/client.js ---
/**
 * Shared HTTP client with JWT auth header injection.
 * All API calls go through this to ensure auth is attached.
 */

function getAuthToken() {
  return localStorage.getItem('auth_token')
}

export function setAuthToken(token) {
  localStorage.setItem('auth_token', token)
}

export function clearAuthToken() {
  localStorage.removeItem('auth_token')
}

export function isAuthenticated() {
  return !!getAuthToken()
}

export async function fetchAPI(path, options = {}) {
  const token = getAuthToken()
  const headers = {
    'Content-Type': 'application/json',
    ...(token ? { 'Authorization': `Bearer ${token}` } : {}),
    ...options.headers,
  }

  const response = await fetch(path, { ...options, headers })

  if (response.status === 401) {
    clearAuthToken()
    window.location.href = '/login'
    throw new Error('Session expired')
  }

  return response
}

--- END OF FILE ---

--- FILE: src/api/auth.js ---
/**
 * Auth API layer — login, register, logout, profile.
 */

import { fetchAPI, setAuthToken, clearAuthToken } from './client'

export async function register(email, password, displayName = '') {
  const res = await fetch('/api/auth/register', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ email, password, display_name: displayName }),
  })

  if (!res.ok) {
    const err = await res.json()
    throw new Error(err.detail || 'Registration failed')
  }

  const data = await res.json()
  setAuthToken(data.access_token)
  return data
}

export async function login(email, password) {
  const res = await fetch('/api/auth/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ email, password }),
  })

  if (!res.ok) {
    const err = await res.json()
    throw new Error(err.detail || 'Login failed')
  }

  const data = await res.json()
  setAuthToken(data.access_token)
  return data
}

export async function getMe() {
  const res = await fetchAPI('/api/auth/me')
  if (!res.ok) return null
  return res.json()
}

export function logout() {
  clearAuthToken()
  window.location.href = '/login'
}

--- END OF FILE ---

--- FILE: src/api/imageGen.js ---
/**
 * Image Generation API Layer — Backend Proxy
 *
 * All AI provider calls go through the backend.
 * No API keys are exposed in the frontend.
 */

import { fetchAPI } from './client'

// Reference image type definitions (kept for UI components)
export const REFERENCE_TYPES = {
  style: { weight: 0.8, description: 'Copy artistic style and rendering' },
  composition: { weight: 0.7, description: 'Match layout and arrangement' },
  color: { weight: 0.6, description: 'Use color palette' },
  subject: { weight: 0.9, description: 'Reference subject/product appearance' }
}

// Available models — fetched from backend, but kept as fallback for UI
export const AVAILABLE_MODELS = {
  replicate: [
    { id: 'black-forest-labs/flux-schnell', name: 'Flux Schnell', description: 'Fast, high quality', supportsImg2Img: false },
    { id: 'black-forest-labs/flux-1.1-pro', name: 'Flux 1.1 Pro', description: 'Best quality, slower', supportsImg2Img: true },
    { id: 'stability-ai/sdxl', name: 'SDXL', description: 'Stable Diffusion XL', supportsImg2Img: true }
  ],
  openai: [
    { id: 'dall-e-3', name: 'DALL-E 3', description: 'Latest model', supportsImg2Img: false },
    { id: 'dall-e-2', name: 'DALL-E 2', description: 'Supports variations', supportsImg2Img: true }
  ],
  gemini: [
    { id: 'gemini-2.0-flash-exp', name: 'Gemini 2.0 Flash', description: 'Native image generation', supportsImg2Img: false },
    { id: 'imagen-3.0-generate-002', name: 'Imagen 3', description: 'High quality Google model', supportsImg2Img: false }
  ]
}

/**
 * Main image generation function — calls backend proxy.
 * Preserves the same signature as before for backward compatibility.
 *
 * @param {string} prompt - The image generation prompt
 * @param {object} options - Generation options
 * @param {function} onProgress - Progress callback
 * @returns {Promise<object>} - Generated image data
 */
export async function generateImage(prompt, options = {}, onProgress = null) {
  onProgress?.({ status: 'starting', progress: 0, message: 'Sending to server...' })

  const body = {
    prompt,
    provider: options.provider || undefined,
    model: options.model || undefined,
    aspect_ratio: options.aspectRatio || '1:1',
    width: options.width || 1024,
    height: options.height || 1024,
    style: options.style || undefined,
    failover: true,
  }

  onProgress?.({ status: 'processing', progress: 20, message: 'Generating image...' })

  try {
    const response = await fetchAPI('/api/generate/', {
      method: 'POST',
      body: JSON.stringify(body),
    })

    if (response.status === 429) {
      const err = await response.json()
      throw new Error(err.detail?.message || 'Rate limit exceeded. Try again later.')
    }

    if (!response.ok) {
      const err = await response.json()
      throw new Error(err.detail || 'Image generation failed')
    }

    onProgress?.({ status: 'completed', progress: 100, message: 'Image ready!' })

    const data = await response.json()
    return {
      url: data.image_url,
      provider: data.provider,
      model: data.model,
      generationId: data.generation_id,
      costEstimate: data.cost_estimate,
      usedReferences: 0,
    }
  } catch (error) {
    onProgress?.({ status: 'error', message: error.message })
    throw error
  }
}

/**
 * Generate image with reference images (convenience wrapper).
 */
export async function generateImageWithReferences(prompt, referenceImages, options = {}, onProgress = null) {
  return generateImage(prompt, { ...options, referenceImages }, onProgress)
}

/**
 * Legacy function for backward compatibility.
 */
export async function generateImageLegacy(prompt) {
  const result = await generateImage(prompt)
  return result.url
}

/**
 * Check if a provider/model supports img2img.
 */
export function supportsImg2Img(provider = 'replicate', modelId = null) {
  const providerModels = AVAILABLE_MODELS[provider?.toLowerCase()]
  if (!providerModels) return false

  if (modelId) {
    const model = providerModels.find(m => m.id === modelId)
    return model?.supportsImg2Img || false
  }

  return providerModels.some(m => m.supportsImg2Img)
}

/**
 * Get provider info from backend.
 */
export async function getProviderInfo() {
  try {
    const res = await fetchAPI('/api/generate/providers')
    if (!res.ok) return { provider: 'unknown', isDemo: true, hasKey: false, availableModels: [] }
    const data = await res.json()
    return {
      provider: data.default_provider,
      isDemo: data.providers.length === 0,
      hasKey: data.providers.length > 0,
      availableModels: data.providers,
    }
  } catch {
    return { provider: 'unknown', isDemo: true, hasKey: false, availableModels: [] }
  }
}

/**
 * Validate backend connection.
 */
export async function validateCredentials() {
  try {
    const res = await fetchAPI('/api/generate/providers')
    return {
      valid: res.ok,
      message: res.ok ? 'Backend connected' : 'Backend unavailable',
    }
  } catch {
    return { valid: false, message: 'Cannot reach backend' }
  }
}

--- END OF FILE ---

--- FILE: src/pages/MainImageGenerator.jsx ---
import { useState, useCallback } from 'react'
import {
  Upload,
  Search,
  Sliders,
  Image,
  Download,
  RefreshCw,
  Save,
  Check,
  X,
  Loader2,
  ChevronDown,
  Package
} from 'lucide-react'
import { generateImage } from '../api/imageGen'
import { PRODUCT_CATEGORIES } from '../constants/productCategories'

// Template categories and items
const TEMPLATE_CATEGORIES = ['All', 'Basic', 'Packaging', 'Elements', 'Tags', 'Lifestyle', 'Advanced']

const TEMPLATES = [
  // Basic
  { id: 'white-bg', name: 'Plain White Background', category: 'Basic', thumbnail: '⬜' },
  { id: 'shadow', name: 'Product with Shadow', category: 'Basic', thumbnail: '🌓' },
  { id: 'platform', name: 'On Platform', category: 'Basic', thumbnail: '📦' },
  { id: 'angles', name: 'Different Angles', category: 'Basic', thumbnail: '🔄' },
  { id: 'floating', name: 'Floating', category: 'Basic', thumbnail: '🎈' },
  // Packaging
  { id: 'pack-left', name: 'Product + Packaging Left', category: 'Packaging', thumbnail: '📦' },
  { id: 'pack-right', name: 'Product + Packaging Right', category: 'Packaging', thumbnail: '📦' },
  { id: 'pack-front', name: 'Packaging Front', category: 'Packaging', thumbnail: '🎁' },
  { id: 'pack-emerging', name: 'Emerging from Box', category: 'Packaging', thumbnail: '📤' },
  { id: 'pack-open', name: 'Open Display', category: 'Packaging', thumbnail: '📬' },
  // Elements
  { id: 'ingredients', name: 'Product + Ingredients', category: 'Elements', thumbnail: '🧪' },
  { id: 'accessories', name: 'With Accessories', category: 'Elements', thumbnail: '🔧' },
  { id: 'element-tag', name: 'Element + Tag', category: 'Elements', thumbnail: '🏷️' },
  { id: 'before-after', name: 'Before/After', category: 'Elements', thumbnail: '↔️' },
  { id: 'size-compare', name: 'Size Comparison', category: 'Elements', thumbnail: '📏' },
  // Tags
  { id: 'corner-tag', name: 'Corner Tag', category: 'Tags', thumbnail: '📐' },
  { id: 'ribbon', name: 'Ribbon Badge', category: 'Tags', thumbnail: '🎀' },
  { id: 'quantity', name: 'Quantity Indicator', category: 'Tags', thumbnail: '🔢' },
  { id: 'quality-cert', name: 'Quality Certification', category: 'Tags', thumbnail: '✅' },
  { id: 'feature-callout', name: 'Feature Callout', category: 'Tags', thumbnail: '💬' },
  { id: 'award', name: 'Award Badge', category: 'Tags', thumbnail: '🏆' },
  { id: 'sale-tag', name: 'Sale Tag', category: 'Tags', thumbnail: '💰' },
  // Lifestyle
  { id: 'with-hand', name: 'With Hand/Avatar', category: 'Lifestyle', thumbnail: '🤚' },
  { id: 'in-use', name: 'In Use', category: 'Lifestyle', thumbnail: '👤' },
  { id: 'complementary', name: 'With Complementary Items', category: 'Lifestyle', thumbnail: '🎯' },
  { id: 'splash', name: 'Splash Effect', category: 'Lifestyle', thumbnail: '💦' },
  { id: 'premium-lighting', name: 'Premium Lighting', category: 'Lifestyle', thumbnail: '✨' },
  // Advanced
  { id: 'multi-angle', name: 'Multi-angle Composite', category: 'Advanced', thumbnail: '🔲' },
  { id: 'bundle', name: 'Bundle Display', category: 'Advanced', thumbnail: '📦' },
  { id: 'exploded', name: 'Exploded View', category: 'Advanced', thumbnail: '💥' },
  { id: 'infographic', name: 'Infographic Style', category: 'Advanced', thumbnail: '📊' },
  { id: 'comparison', name: 'Comparison Layout', category: 'Advanced', thumbnail: '⚖️' },
]

const AI_MODELS = [
  { id: 'combined', name: 'GPT & Gemini (Combined)', description: 'Balanced results', badge: 'Recommended' },
  { id: 'gemini', name: 'Gemini 2.0 Flash', description: 'Fast generation', badge: 'Fast' },
  { id: 'replicate', name: 'Flux Pro', description: 'Photorealism', badge: 'Quality' },
  { id: 'openai', name: 'DALL-E 3', description: 'Artistic style', badge: null },
  { id: 'stability', name: 'SDXL', description: 'High quality', badge: null },
]

const MARKETPLACES = [
  { code: 'US', flag: '🇺🇸', name: 'United States' },
  { code: 'UK', flag: '🇬🇧', name: 'United Kingdom' },
  { code: 'DE', flag: '🇩🇪', name: 'Germany' },
  { code: 'FR', flag: '🇫🇷', name: 'France' },
  { code: 'JP', flag: '🇯🇵', name: 'Japan' },
  { code: 'CA', flag: '🇨🇦', name: 'Canada' },
  { code: 'CN', flag: '🇨🇳', name: 'China' },
  { code: 'IT', flag: '🇮🇹', name: 'Italy' },
  { code: 'ES', flag: '🇪🇸', name: 'Spain' },
  { code: 'MX', flag: '🇲🇽', name: 'Mexico' },
  { code: 'AU', flag: '🇦🇺', name: 'Australia' },
  { code: 'IN', flag: '🇮🇳', name: 'India' },
]

// Amazon-compliant aspect ratios only
const ASPECT_RATIOS = [
  { id: '1:1', name: 'Square', width: 2000, height: 2000, icon: '⬜', description: 'Standard for main & additional images', recommended: true },
  { id: '4:3', name: 'Portrait', width: 2000, height: 1500, icon: '🖼️', description: 'Common for product photography' },
  { id: '3:2', name: 'Rectangle', width: 2000, height: 1333, icon: '📷', description: 'Desktop search results' },
]

function MainImageGenerator() {
  // Input state
  const [inputMode, setInputMode] = useState('asin') // 'asin' | 'upload'
  const [asinValue, setAsinValue] = useState('')
  const [uploadedImage, setUploadedImage] = useState(null)
  const [dragActive, setDragActive] = useState(false)

  // Configuration state
  const [quantity, setQuantity] = useState(3)
  const [selectedModel, setSelectedModel] = useState('combined')
  const [marketplace, setMarketplace] = useState('US')
  const [aspectRatio, setAspectRatio] = useState('1:1')
  const [selectedTemplates, setSelectedTemplates] = useState([])
  const [categoryFilter, setCategoryFilter] = useState('All')
  const [productCategory, setProductCategory] = useState('')

  // Generation state
  const [isGenerating, setIsGenerating] = useState(false)
  const [progress, setProgress] = useState(null)
  const [generatedImages, setGeneratedImages] = useState([])
  const [selectedImages, setSelectedImages] = useState([])
  const [error, setError] = useState(null)

  // ASIN validation
  const isValidASIN = (asin) => /^[A-Z0-9]{10}$/i.test(asin)

  // Handle file upload
  const handleDrop = useCallback((e) => {
    e.preventDefault()
    setDragActive(false)

    const file = e.dataTransfer?.files?.[0] || e.target?.files?.[0]
    if (file && file.type.startsWith('image/')) {
      if (file.size > 10 * 1024 * 1024) {
        setError('File size must be less than 10MB')
        return
      }
      const reader = new FileReader()
      reader.onload = (e) => {
        setUploadedImage({
          file,
          preview: e.target.result,
          name: file.name
        })
      }
      reader.readAsDataURL(file)
    }
  }, [])

  // Toggle template selection (limited by quantity)
  const toggleTemplate = (templateId) => {
    setSelectedTemplates(prev => {
      if (prev.includes(templateId)) {
        // Always allow deselection
        return prev.filter(id => id !== templateId)
      } else {
        // Only allow selection if under the quantity limit
        if (prev.length >= quantity) {
          return prev // Don't add more if at limit
        }
        return [...prev, templateId]
      }
    })
  }

  // Filter templates by category
  const filteredTemplates = categoryFilter === 'All'
    ? TEMPLATES
    : TEMPLATES.filter(t => t.category === categoryFilter)

  // Toggle image selection for batch operations
  const toggleImageSelection = (imageId) => {
    setSelectedImages(prev =>
      prev.includes(imageId)
        ? prev.filter(id => id !== imageId)
        : [...prev, imageId]
    )
  }

  // Select/deselect all images
  const toggleSelectAll = () => {
    if (selectedImages.length === generatedImages.length) {
      setSelectedImages([])
    } else {
      setSelectedImages(generatedImages.map(img => img.id))
    }
  }

  // Download single image
  const downloadImage = async (img) => {
    try {
      const response = await fetch(img.url)
      const blob = await response.blob()
      const url = URL.createObjectURL(blob)
      const a = document.createElement('a')
      a.href = url
      a.download = `${img.template.replace(/\s+/g, '-').toLowerCase()}-${img.id}.png`
      document.body.appendChild(a)
      a.click()
      document.body.removeChild(a)
      URL.revokeObjectURL(url)
    } catch (err) {
      console.error('Download failed:', err)
    }
  }

  // Download selected images
  const downloadSelected = async () => {
    const imagesToDownload = generatedImages.filter(img => selectedImages.includes(img.id))
    for (const img of imagesToDownload) {
      await downloadImage(img)
      await new Promise(resolve => setTimeout(resolve, 500)) // Small delay between downloads
    }
  }

  // Generate images
  const handleGenerate = async () => {
    if (selectedTemplates.length === 0) {
      setError('Please select at least one template')
      return
    }

    if (inputMode === 'asin' && !isValidASIN(asinValue)) {
      setError('Please enter a valid ASIN (10 alphanumeric characters)')
      return
    }

    if (inputMode === 'upload' && !uploadedImage) {
      setError('Please upload an image')
      return
    }

    setIsGenerating(true)
    setError(null)
    setGeneratedImages([])
    setSelectedImages([])

    try {
      const results = []
      const totalImages = selectedTemplates.length

      for (let i = 0; i < totalImages; i++) {
        const templateId = selectedTemplates[i]
        const template = TEMPLATES.find(t => t.id === templateId)

        setProgress({
          current: i + 1,
          total: totalImages,
          percentage: Math.round(((i + 1) / totalImages) * 100),
          message: `Generating ${template.name}...`,
          template: template.name
        })

        const prompt = `Amazon product listing image, ${template.name} style, professional photography, pure white background RGB(255,255,255), high quality commercial product shot, sharp focus, studio lighting, product fills 85% of frame`

        const selectedRatio = ASPECT_RATIOS.find(r => r.id === aspectRatio)
        const result = await generateImage(prompt, {
          provider: selectedModel === 'combined' ? 'gemini' : selectedModel,
          width: selectedRatio?.width || 2000,
          height: selectedRatio?.height || 2000,
          aspectRatio: aspectRatio
        }, (p) => {
          setProgress(prev => ({ ...prev, ...p }))
        })

        const newImage = {
          id: Date.now() + i,
          url: result.url,
          template: template.name,
          templateId: template.id,
          model: result.model,
          provider: result.provider,
          aspectRatio,
          timestamp: new Date().toISOString()
        }

        results.push(newImage)

        // Update results in real-time so user can see progress
        setGeneratedImages([...results])
      }

      setGeneratedImages(results)
    } catch (err) {
      setError(err.message || 'Failed to generate images')
    } finally {
      setIsGenerating(false)
      setProgress(null)
    }
  }

  const canGenerate = (inputMode === 'asin' ? isValidASIN(asinValue) : !!uploadedImage) &&
    selectedTemplates.length > 0 && !isGenerating

  return (
    <div className="main-image-generator">
      <header className="page-header">
        <div>
          <h1>Main Image Generator</h1>
          <p>Generate professional Amazon product images with AI</p>
        </div>
      </header>

      <div className="generator-layout">
        {/* Left Panel - Input & Configuration */}
        <div className="generator-sidebar">
          {/* Input Mode Tabs */}
          <div className="input-section">
            <div className="input-tabs">
              <button
                className={`input-tab ${inputMode === 'asin' ? 'active' : ''}`}
                onClick={() => setInputMode('asin')}
              >
                <Search size={18} />
                By ASIN
              </button>
              <button
                className={`input-tab ${inputMode === 'upload' ? 'active' : ''}`}
                onClick={() => setInputMode('upload')}
              >
                <Upload size={18} />
                Upload Image
              </button>
            </div>

            {inputMode === 'asin' ? (
              <div className="asin-input">
                <input
                  type="text"
                  placeholder="Enter ASIN (e.g., B08N5WRWNW)"
                  value={asinValue}
                  onChange={(e) => setAsinValue(e.target.value.toUpperCase())}
                  maxLength={10}
                  className={asinValue && !isValidASIN(asinValue) ? 'invalid' : ''}
                />
                {asinValue && (
                  <span className={`asin-status ${isValidASIN(asinValue) ? 'valid' : 'invalid'}`}>
                    {isValidASIN(asinValue) ? <Check size={16} /> : <X size={16} />}
                  </span>
                )}
              </div>
            ) : (
              <div
                className={`upload-zone ${dragActive ? 'drag-active' : ''} ${uploadedImage ? 'has-image' : ''}`}
                onDragOver={(e) => { e.preventDefault(); setDragActive(true) }}
                onDragLeave={() => setDragActive(false)}
                onDrop={handleDrop}
                onClick={() => document.getElementById('file-input').click()}
              >
                <input
                  id="file-input"
                  type="file"
                  accept="image/*"
                  onChange={handleDrop}
                  style={{ display: 'none' }}
                />
                {uploadedImage ? (
                  <div className="uploaded-preview">
                    <img src={uploadedImage.preview} alt="Uploaded" />
                    <span>{uploadedImage.name}</span>
                    <button
                      className="remove-upload"
                      onClick={(e) => { e.stopPropagation(); setUploadedImage(null) }}
                    >
                      <X size={16} />
                    </button>
                  </div>
                ) : (
                  <>
                    <Upload size={32} />
                    <p>Drag & drop or click to upload</p>
                    <span>JPG, PNG, WebP (Max 10MB)</span>
                  </>
                )}
              </div>
            )}
          </div>

          {/* Configuration Panel */}
          <div className="config-section">
            <h3><Sliders size={18} /> Configuration</h3>

            {/* Product Category */}
            <div className="config-group">
              <label>Product Category</label>
              <select
                className="category-dropdown"
                value={productCategory}
                onChange={(e) => setProductCategory(e.target.value)}
              >
                <option value="">-- Select Category --</option>
                {PRODUCT_CATEGORIES.map((cat) => (
                  <option key={cat} value={cat}>{cat}</option>
                ))}
              </select>
            </div>

            {/* Quantity Control */}
            <div className="config-group batch-controls">
              <label className="batch-label">
                <span>Number of Images</span>
                <span className="batch-total">{quantity}</span>
              </label>

              <input
                type="range"
                min="1"
                max="10"
                value={quantity}
                onChange={(e) => {
                  const newQty = Number(e.target.value)
                  setQuantity(newQty)
                  // Trim selected templates if over new limit
                  if (selectedTemplates.length > newQty) {
                    setSelectedTemplates(prev => prev.slice(0, newQty))
                  }
                }}
              />

              <p className="batch-hint">
                {selectedTemplates.length} of {quantity} templates selected
                {selectedTemplates.length < quantity && (
                  <span className="hint-warning"> — select {quantity - selectedTemplates.length} more</span>
                )}
              </p>
            </div>

            {/* Aspect Ratio Selector */}
            <div className="config-group">
              <label>Aspect Ratio</label>
              <div className="aspect-ratio-grid-amazon">
                {ASPECT_RATIOS.map((ratio) => (
                  <button
                    key={ratio.id}
                    className={`aspect-ratio-btn-amazon ${aspectRatio === ratio.id ? 'selected' : ''} ${ratio.recommended ? 'recommended' : ''}`}
                    onClick={() => setAspectRatio(ratio.id)}
                    title={ratio.description}
                  >
                    <span className="ratio-icon">{ratio.icon}</span>
                    <div className="ratio-details">
                      <span className="ratio-label">{ratio.id} {ratio.name}</span>
                      {ratio.recommended && <span className="ratio-badge">Recommended</span>}
                    </div>
                  </button>
                ))}
              </div>
              <p className="ratio-tip">Min 1,000px • Recommended 2,000px+ for zoom</p>
            </div>

            {/* AI Model Selector */}
            <div className="config-group">
              <label>AI Model</label>
              <select
                className="config-select"
                value={selectedModel}
                onChange={(e) => setSelectedModel(e.target.value)}
              >
                {AI_MODELS.map((model) => (
                  <option key={model.id} value={model.id}>
                    {model.name} — {model.description} {model.badge ? `(${model.badge})` : ''}
                  </option>
                ))}
              </select>
            </div>

            {/* Marketplace Selector */}
            <div className="config-group">
              <label>Marketplace</label>
              <select
                className="config-select"
                value={marketplace}
                onChange={(e) => setMarketplace(e.target.value)}
              >
                {MARKETPLACES.map((mp) => (
                  <option key={mp.code} value={mp.code}>
                    {mp.flag} {mp.name} ({mp.code})
                  </option>
                ))}
              </select>
            </div>
          </div>
        </div>

        {/* Center Panel - Templates */}
        <div className="templates-section">
          <div className="templates-header">
            <h3>
              <Package size={18} />
              Select Templates
              <span className="template-count">{selectedTemplates.length} selected</span>
            </h3>
            <div className="category-filters">
              {TEMPLATE_CATEGORIES.map((cat) => (
                <button
                  key={cat}
                  className={`category-btn ${categoryFilter === cat ? 'active' : ''}`}
                  onClick={() => setCategoryFilter(cat)}
                >
                  {cat}
                </button>
              ))}
            </div>
          </div>

          <div className="templates-grid">
            {filteredTemplates.map((template) => (
              <div
                key={template.id}
                className={`template-card ${selectedTemplates.includes(template.id) ? 'selected' : ''}`}
                onClick={() => toggleTemplate(template.id)}
              >
                <div className="template-thumbnail">{template.thumbnail}</div>
                <span className="template-name">{template.name}</span>
                <div className="template-check">
                  {selectedTemplates.includes(template.id) && <Check size={16} />}
                </div>
              </div>
            ))}
          </div>

          {/* Generate Button */}
          <div className="generate-action">
            {error && <div className="error-message">{error}</div>}
            <button
              className="btn btn-primary btn-large"
              onClick={handleGenerate}
              disabled={!canGenerate}
            >
              {isGenerating ? (
                <>
                  <Loader2 size={20} className="spin" />
                  Generating {progress?.current}/{progress?.total}...
                </>
              ) : (
                <>
                  <Image size={20} />
                  Generate {selectedTemplates.length} Image{selectedTemplates.length !== 1 ? 's' : ''}
                </>
              )}
            </button>
          </div>
        </div>

        {/* Right Panel - Results */}
        <div className="results-section">
          <div className="results-header">
            <h3>
              Generated Images
              {generatedImages.length > 0 && (
                <span className="results-count">({generatedImages.length})</span>
              )}
            </h3>
            {generatedImages.length > 0 && (
              <div className="results-actions">
                <button
                  className={`btn btn-sm ${selectedImages.length === generatedImages.length ? 'btn-secondary' : 'btn-ghost'}`}
                  onClick={toggleSelectAll}
                >
                  <Check size={16} />
                  {selectedImages.length === generatedImages.length ? 'Deselect All' : 'Select All'}
                </button>
                <button
                  className="btn btn-primary btn-sm"
                  onClick={downloadSelected}
                  disabled={selectedImages.length === 0}
                >
                  <Download size={16} />
                  Download {selectedImages.length > 0 ? `(${selectedImages.length})` : 'Selected'}
                </button>
              </div>
            )}
          </div>

          {/* Progress Bar */}
          {isGenerating && progress && (
            <div className="generation-progress">
              <div className="progress-bar">
                <div
                  className="progress-fill"
                  style={{ width: `${progress.percentage || 0}%` }}
                />
              </div>
              <div className="progress-info">
                <span className="progress-text">{progress.message}</span>
                <span className="progress-count">{progress.current} / {progress.total}</span>
              </div>
            </div>
          )}

          {generatedImages.length === 0 && !isGenerating ? (
            <div className="results-empty">
              <Image size={48} />
              <p>Your generated images will appear here</p>
              <span>Select templates and click Generate to start</span>
            </div>
          ) : (
            <div className="results-grid">
              {generatedImages.map((img) => (
                <div
                  key={img.id}
                  className={`result-card ${selectedImages.includes(img.id) ? 'selected' : ''}`}
                  onClick={() => toggleImageSelection(img.id)}
                >
                  <div className="result-checkbox">
                    <input
                      type="checkbox"
                      checked={selectedImages.includes(img.id)}
                      onChange={() => toggleImageSelection(img.id)}
                      onClick={(e) => e.stopPropagation()}
                    />
                  </div>
                  <img src={img.url} alt={img.template} />
                  <div className="result-info">
                    <span className="result-template">{img.template}</span>
                    <span className="result-model">{img.provider}</span>
                  </div>
                  <div className="result-actions">
                    <button
                      className="action-btn"
                      title="Download"
                      onClick={(e) => { e.stopPropagation(); downloadImage(img) }}
                    >
                      <Download size={16} />
                    </button>
                    <button className="action-btn" title="Regenerate" onClick={(e) => e.stopPropagation()}>
                      <RefreshCw size={16} />
                    </button>
                    <button className="action-btn" title="Save to Project" onClick={(e) => e.stopPropagation()}>
                      <Save size={16} />
                    </button>
                  </div>
                </div>
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  )
}

export default MainImageGenerator

--- END OF FILE ---

--- FILE: src/pages/CreativeCampaigns.jsx ---
import { useState } from 'react'
import {
  Search,
  FileText,
  TrendingUp,
  Users,
  AlertTriangle,
  Lightbulb,
  BarChart3,
  Target,
  Zap,
  Download,
  ChevronDown,
  ChevronRight,
  MessageSquare,
  Image,
  Loader2,
  Check,
  Star,
  ThumbsUp,
  ThumbsDown
} from 'lucide-react'
import { PieChart, Pie, Cell, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts'

// Mock data for demonstration
const MOCK_MARKET_INTEL = {
  overview: {
    reviewsAnalyzed: 2847,
    competitorsStudied: 12,
    customerAvatars: 4,
    dataPoints: 15420
  },
  sentiment: [
    { name: 'Positive', value: 68, color: '#22C55E' },
    { name: 'Pain Points', value: 22, color: '#EF4444' },
    { name: 'Feature Requests', value: 10, color: '#3B82F6' }
  ],
  demographics: [
    { age: '18-25', male: 15, female: 12 },
    { age: '26-35', male: 28, female: 32 },
    { age: '36-45', male: 22, female: 25 },
    { age: '46-55', male: 18, female: 15 },
    { age: '56-65', male: 8, female: 10 },
    { age: '65+', male: 5, female: 6 }
  ],
  positiveThemes: [
    { theme: 'Easy to use', count: 847 },
    { theme: 'Great value', count: 632 },
    { theme: 'High quality', count: 521 },
    { theme: 'Fast shipping', count: 445 },
    { theme: 'Durable', count: 389 }
  ],
  painPoints: [
    { point: 'Battery life concerns', count: 234, impact: 12 },
    { point: 'Confusing instructions', count: 187, impact: 8 },
    { point: 'Size smaller than expected', count: 156, impact: 7 },
    { point: 'Limited color options', count: 134, impact: 5 }
  ],
  featureRequests: [
    { request: 'More color options', count: 189 },
    { request: 'Longer warranty', count: 145 },
    { request: 'USB-C charging', count: 123 },
    { request: 'Travel case included', count: 98 }
  ],
  customerAvatars: [
    {
      name: 'Busy Professional',
      segment: 'Primary',
      percentage: 35,
      demographics: { age: '28-42', gender: 'Mixed', location: 'Urban', income: '$75K-150K' },
      psychographics: { lifestyle: 'Fast-paced', values: 'Efficiency', interests: 'Tech, Fitness' },
      behaviors: ['Research before buying', 'Values reviews', 'Brand conscious'],
      motivations: ['Save time', 'Quality', 'Professional image']
    },
    {
      name: 'Health-Conscious Parent',
      segment: 'Secondary',
      percentage: 28,
      demographics: { age: '32-48', gender: '65% Female', location: 'Suburban', income: '$60K-120K' },
      psychographics: { lifestyle: 'Family-focused', values: 'Safety', interests: 'Health, Family' },
      behaviors: ['Comparison shops', 'Reads all details', 'Asks questions'],
      motivations: ['Family safety', 'Value', 'Convenience']
    }
  ],
  competitors: [
    { brand: 'CompetitorA', rating: 4.3, reviews: 12450, share: 28 },
    { brand: 'CompetitorB', rating: 4.1, reviews: 8320, share: 22 },
    { brand: 'CompetitorC', rating: 4.5, reviews: 5670, share: 18 },
    { brand: 'Your Product', rating: 4.4, reviews: 2847, share: 15 }
  ],
  recommendations: {
    pricing: ['Position in mid-premium range', 'Bundle options for value'],
    product: ['Improve battery life', 'Add more color variants'],
    marketing: ['Emphasize ease of use', 'Target busy professionals'],
    operations: ['Improve instruction clarity', 'Consider size labeling']
  }
}

const MARKETPLACES = [
  { code: 'US', flag: '🇺🇸' }, { code: 'UK', flag: '🇬🇧' }, { code: 'DE', flag: '🇩🇪' },
  { code: 'FR', flag: '🇫🇷' }, { code: 'JP', flag: '🇯🇵' }, { code: 'CA', flag: '🇨🇦' }
]

function CreativeCampaigns() {
  // Input state
  const [inputMode, setInputMode] = useState('asin')
  const [asinValue, setAsinValue] = useState('')
  const [keyword, setKeyword] = useState('')
  const [marketplace, setMarketplace] = useState('US')
  const [processingMode, setProcessingMode] = useState('fast')

  // Processing state
  const [isProcessing, setIsProcessing] = useState(false)
  const [progress, setProgress] = useState(null)

  // Results state
  const [hasResults, setHasResults] = useState(false)
  const [activeTab, setActiveTab] = useState('intel')
  const [expandedSections, setExpandedSections] = useState(['overview', 'sentiment'])

  // Chat state
  const [chatOpen, setChatOpen] = useState(false)
  const [chatMessages, setChatMessages] = useState([])
  const [chatInput, setChatInput] = useState('')

  const toggleSection = (section) => {
    setExpandedSections(prev =>
      prev.includes(section)
        ? prev.filter(s => s !== section)
        : [...prev, section]
    )
  }

  const handleGenerate = async () => {
    setIsProcessing(true)
    setProgress({ step: 1, total: 5, message: 'Fetching product data...' })

    // Simulate processing
    const steps = [
      'Fetching product data...',
      'Analyzing reviews...',
      'Studying competitors...',
      'Building customer avatars...',
      'Generating insights...'
    ]

    for (let i = 0; i < steps.length; i++) {
      setProgress({ step: i + 1, total: steps.length, message: steps[i] })
      await new Promise(r => setTimeout(r, 1000))
    }

    setIsProcessing(false)
    setHasResults(true)
    setProgress(null)
  }

  const sendChatMessage = () => {
    if (!chatInput.trim()) return

    setChatMessages(prev => [...prev, { role: 'user', content: chatInput }])

    // Simulate AI response
    setTimeout(() => {
      setChatMessages(prev => [...prev, {
        role: 'assistant',
        content: `Based on the market intelligence, I can see that "${chatInput}" relates to your competitive positioning. The data shows strong opportunities in the health-conscious parent segment.`
      }])
    }, 1000)

    setChatInput('')
  }

  return (
    <div className="creative-campaigns">
      <header className="page-header">
        <div>
          <h1>Creative Campaigns</h1>
          <p>AI-powered market intelligence and creative brief generation</p>
        </div>
      </header>

      {!hasResults ? (
        /* Input Section */
        <div className="campaign-input">
          <div className="input-card">
            {/* Input Mode Tabs */}
            <div className="input-tabs">
              <button
                className={`input-tab ${inputMode === 'asin' ? 'active' : ''}`}
                onClick={() => setInputMode('asin')}
              >
                <Search size={18} />
                Generate by ASIN
              </button>
              <button
                className={`input-tab ${inputMode === 'keyword' ? 'active' : ''}`}
                onClick={() => setInputMode('keyword')}
              >
                <FileText size={18} />
                Generate by Keyword
              </button>
            </div>

            <div className="input-form">
              {inputMode === 'asin' ? (
                <div className="form-group">
                  <label>ASIN</label>
                  <input
                    type="text"
                    placeholder="Enter ASIN (e.g., B08N5WRWNW)"
                    value={asinValue}
                    onChange={(e) => setAsinValue(e.target.value.toUpperCase())}
                    maxLength={10}
                  />
                </div>
              ) : (
                <div className="form-group">
                  <label>Primary Keyword</label>
                  <input
                    type="text"
                    placeholder="Enter primary keyword"
                    value={keyword}
                    onChange={(e) => setKeyword(e.target.value)}
                  />
                </div>
              )}

              <div className="form-group">
                <label>Marketplace</label>
                <div className="marketplace-select">
                  {MARKETPLACES.map((mp) => (
                    <button
                      key={mp.code}
                      className={`mp-btn ${marketplace === mp.code ? 'selected' : ''}`}
                      onClick={() => setMarketplace(mp.code)}
                    >
                      {mp.flag} {mp.code}
                    </button>
                  ))}
                </div>
              </div>

              <div className="form-group">
                <label>Processing Mode</label>
                <div className="mode-toggle">
                  <button
                    className={`mode-btn ${processingMode === 'fast' ? 'active' : ''}`}
                    onClick={() => setProcessingMode('fast')}
                  >
                    <Zap size={18} />
                    Fast Mode
                    <span>Auto-generate brief (~2-3 min)</span>
                  </button>
                  <button
                    className={`mode-btn ${processingMode === 'deep' ? 'active' : ''}`}
                    onClick={() => setProcessingMode('deep')}
                  >
                    <Target size={18} />
                    Deep Mode
                    <span>Detailed analysis (~5-7 min)</span>
                  </button>
                </div>
              </div>

              <button
                className="btn btn-primary btn-large"
                onClick={handleGenerate}
                disabled={isProcessing || (inputMode === 'asin' ? !asinValue : !keyword)}
              >
                {isProcessing ? (
                  <>
                    <Loader2 size={20} className="spin" />
                    {progress?.message}
                  </>
                ) : (
                  <>
                    <TrendingUp size={20} />
                    Generate Market Intelligence
                  </>
                )}
              </button>

              {isProcessing && progress && (
                <div className="progress-bar">
                  <div
                    className="progress-fill"
                    style={{ width: `${(progress.step / progress.total) * 100}%` }}
                  />
                </div>
              )}
            </div>
          </div>
        </div>
      ) : (
        /* Results Section */
        <div className="campaign-results">
          {/* Results Tabs */}
          <div className="results-tabs">
            <button
              className={`results-tab ${activeTab === 'intel' ? 'active' : ''}`}
              onClick={() => setActiveTab('intel')}
            >
              <BarChart3 size={18} />
              View Market Intel
            </button>
            <button
              className={`results-tab ${activeTab === 'brief' ? 'active' : ''}`}
              onClick={() => setActiveTab('brief')}
            >
              <Image size={18} />
              View Brief
            </button>
            <button className="btn btn-secondary btn-sm export-btn">
              <Download size={16} />
              Export PDF
            </button>
          </div>

          {activeTab === 'intel' ? (
            <div className="market-intel">
              {/* Overview Stats */}
              <section className="intel-section">
                <div className="stats-row">
                  <div className="stat-box">
                    <FileText size={24} />
                    <div>
                      <span className="stat-number">{MOCK_MARKET_INTEL.overview.reviewsAnalyzed.toLocaleString()}</span>
                      <span className="stat-label">Reviews Analyzed</span>
                    </div>
                  </div>
                  <div className="stat-box">
                    <Users size={24} />
                    <div>
                      <span className="stat-number">{MOCK_MARKET_INTEL.overview.competitorsStudied}</span>
                      <span className="stat-label">Competitors Studied</span>
                    </div>
                  </div>
                  <div className="stat-box">
                    <Target size={24} />
                    <div>
                      <span className="stat-number">{MOCK_MARKET_INTEL.overview.customerAvatars}</span>
                      <span className="stat-label">Customer Avatars</span>
                    </div>
                  </div>
                  <div className="stat-box">
                    <TrendingUp size={24} />
                    <div>
                      <span className="stat-number">{MOCK_MARKET_INTEL.overview.dataPoints.toLocaleString()}</span>
                      <span className="stat-label">Data Points</span>
                    </div>
                  </div>
                </div>
              </section>

              {/* Sentiment & Demographics */}
              <section className="intel-section">
                <h3>Review Analysis</h3>
                <div className="charts-row">
                  <div className="chart-box">
                    <h4>Sentiment Distribution</h4>
                    <ResponsiveContainer width="100%" height={200}>
                      <PieChart>
                        <Pie
                          data={MOCK_MARKET_INTEL.sentiment}
                          dataKey="value"
                          nameKey="name"
                          cx="50%"
                          cy="50%"
                          outerRadius={70}
                          label={({ name, value }) => `${name}: ${value}%`}
                        >
                          {MOCK_MARKET_INTEL.sentiment.map((entry, index) => (
                            <Cell key={index} fill={entry.color} />
                          ))}
                        </Pie>
                        <Tooltip />
                      </PieChart>
                    </ResponsiveContainer>
                  </div>
                  <div className="chart-box">
                    <h4>Customer Demographics</h4>
                    <ResponsiveContainer width="100%" height={200}>
                      <BarChart data={MOCK_MARKET_INTEL.demographics}>
                        <CartesianGrid strokeDasharray="3 3" />
                        <XAxis dataKey="age" />
                        <YAxis />
                        <Tooltip />
                        <Bar dataKey="male" fill="#3B82F6" name="Male" />
                        <Bar dataKey="female" fill="#EC4899" name="Female" />
                      </BarChart>
                    </ResponsiveContainer>
                  </div>
                </div>
              </section>

              {/* Themes Grid */}
              <section className="intel-section">
                <div className="themes-grid">
                  <div className="theme-column positive">
                    <h4><ThumbsUp size={18} /> Top Positive Themes</h4>
                    <ul>
                      {MOCK_MARKET_INTEL.positiveThemes.map((item) => (
                        <li key={item.theme}>
                          <Check size={16} />
                          {item.theme}
                          <span className="count">({item.count})</span>
                        </li>
                      ))}
                    </ul>
                  </div>
                  <div className="theme-column pain">
                    <h4><AlertTriangle size={18} /> Pain Points</h4>
                    <ul>
                      {MOCK_MARKET_INTEL.painPoints.map((item) => (
                        <li key={item.point}>
                          <ThumbsDown size={16} />
                          {item.point}
                          <span className="count">({item.count})</span>
                        </li>
                      ))}
                    </ul>
                  </div>
                  <div className="theme-column requests">
                    <h4><Lightbulb size={18} /> Feature Requests</h4>
                    <ul>
                      {MOCK_MARKET_INTEL.featureRequests.map((item) => (
                        <li key={item.request}>
                          <Star size={16} />
                          {item.request}
                          <span className="count">({item.count})</span>
                        </li>
                      ))}
                    </ul>
                  </div>
                </div>
              </section>

              {/* Customer Avatars */}
              <section className="intel-section">
                <h3>Customer Avatars</h3>
                <div className="avatars-grid">
                  {MOCK_MARKET_INTEL.customerAvatars.map((avatar) => (
                    <div key={avatar.name} className="avatar-card">
                      <div className="avatar-header">
                        <div className="avatar-icon">
                          <Users size={24} />
                        </div>
                        <div>
                          <h4>{avatar.name}</h4>
                          <span className={`segment-badge ${avatar.segment.toLowerCase()}`}>
                            {avatar.segment} - {avatar.percentage}%
                          </span>
                        </div>
                      </div>
                      <div className="avatar-details">
                        <div className="detail-group">
                          <h5>Demographics</h5>
                          <p>Age: {avatar.demographics.age}</p>
                          <p>Gender: {avatar.demographics.gender}</p>
                          <p>Location: {avatar.demographics.location}</p>
                          <p>Income: {avatar.demographics.income}</p>
                        </div>
                        <div className="detail-group">
                          <h5>Motivations</h5>
                          <ul>
                            {avatar.motivations.map((m) => (
                              <li key={m}>{m}</li>
                            ))}
                          </ul>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              </section>

              {/* Strategic Recommendations */}
              <section className="intel-section">
                <h3>Strategic Recommendations</h3>
                <div className="recommendations-grid">
                  {Object.entries(MOCK_MARKET_INTEL.recommendations).map(([key, items]) => (
                    <div key={key} className="recommendation-card">
                      <h4>{key.charAt(0).toUpperCase() + key.slice(1)} Strategy</h4>
                      <ul>
                        {items.map((item, i) => (
                          <li key={i}>{item}</li>
                        ))}
                      </ul>
                    </div>
                  ))}
                </div>
              </section>
            </div>
          ) : (
            <div className="creative-brief">
              <p>Creative brief generation coming soon...</p>
            </div>
          )}

          {/* AI Chat Panel */}
          <button
            className="chat-toggle"
            onClick={() => setChatOpen(!chatOpen)}
          >
            <MessageSquare size={20} />
          </button>

          {chatOpen && (
            <div className="chat-panel">
              <div className="chat-header">
                <h4>AI Assistant</h4>
                <button onClick={() => setChatOpen(false)}>&times;</button>
              </div>
              <div className="chat-messages">
                {chatMessages.map((msg, i) => (
                  <div key={i} className={`chat-message ${msg.role}`}>
                    {msg.content}
                  </div>
                ))}
              </div>
              <div className="chat-suggestions">
                <button onClick={() => setChatInput('Top 3 competitor weaknesses?')}>
                  Top 3 competitor weaknesses?
                </button>
                <button onClick={() => setChatInput('Best headlines for main image?')}>
                  Best headlines for main image?
                </button>
              </div>
              <div className="chat-input">
                <input
                  type="text"
                  value={chatInput}
                  onChange={(e) => setChatInput(e.target.value)}
                  placeholder="Ask about market insights..."
                  onKeyPress={(e) => e.key === 'Enter' && sendChatMessage()}
                />
                <button onClick={sendChatMessage}>Send</button>
              </div>
            </div>
          )}
        </div>
      )}
    </div>
  )
}

export default CreativeCampaigns

--- END OF FILE ---

--- FILE: src/pages/APlusContent.jsx ---
import { useState, useCallback, useEffect } from 'react'
import { PRODUCT_CATEGORIES } from '../constants/productCategories'
import {
  Upload,
  Search,
  Image,
  Type,
  LayoutGrid,
  Plus,
  Trash2,
  GripVertical,
  Eye,
  EyeOff,
  ChevronDown,
  ChevronUp,
  Check,
  X,
  AlertCircle,
  Info,
  Loader2,
  Download,
  Save,
  Sparkles,
  Wand2,
  RefreshCw,
  FileText
} from 'lucide-react'

// Standard A+ Content Module Definitions
const STANDARD_MODULES = [
  {
    id: 'image-header',
    name: 'Standard Image Header',
    description: 'Full-width hero image for brand impact',
    dimensions: '970 x 600 px',
    width: 970,
    height: 600,
    hasText: false,
    category: 'header',
    preview: '🖼️'
  },
  {
    id: 'company-logo',
    name: 'Standard Company Logo',
    description: 'Brand logo for consistent branding',
    dimensions: '600 x 180 px',
    width: 600,
    height: 180,
    hasText: false,
    category: 'header',
    preview: '🏢'
  },
  {
    id: 'image-light-overlay',
    name: 'Image & Light Text Overlay',
    description: 'Image with light-colored text overlay',
    dimensions: '970 x 300 px',
    width: 970,
    height: 300,
    hasText: true,
    textPosition: 'overlay-light',
    category: 'banner',
    preview: '☀️'
  },
  {
    id: 'image-dark-overlay',
    name: 'Image & Dark Text Overlay',
    description: 'Image with dark-colored text overlay',
    dimensions: '970 x 300 px',
    width: 970,
    height: 300,
    hasText: true,
    textPosition: 'overlay-dark',
    category: 'banner',
    preview: '🌙'
  },
  {
    id: 'single-image-highlights',
    name: 'Single Image & Highlights',
    description: 'Square image with bullet point highlights',
    dimensions: '300 x 300 px',
    width: 300,
    height: 300,
    hasText: true,
    textType: 'highlights',
    category: 'feature',
    preview: '✨'
  },
  {
    id: 'single-image-sidebar',
    name: 'Single Image & Sidebar',
    description: 'Main image with sidebar text',
    dimensions: '300 x 400 px',
    width: 300,
    height: 400,
    hasText: true,
    textPosition: 'sidebar',
    category: 'feature',
    preview: '📐'
  },
  {
    id: 'multiple-image-a',
    name: 'Multiple Image Module A',
    description: 'Up to 4 images in a row',
    dimensions: '220 x 220 px each',
    width: 220,
    height: 220,
    imageCount: 4,
    hasText: false,
    category: 'gallery',
    preview: '🔲'
  },
  {
    id: 'four-image-text',
    name: 'Four Image & Text',
    description: '4 images with text below each',
    dimensions: '220 x 220 px each',
    width: 220,
    height: 220,
    imageCount: 4,
    hasText: true,
    textPosition: 'below',
    category: 'gallery',
    preview: '📊'
  },
  {
    id: 'single-image-specs',
    name: 'Single Image & Specs Detail',
    description: 'Image with detailed specifications',
    dimensions: '300 x 300 px',
    width: 300,
    height: 300,
    hasText: true,
    textType: 'specs',
    category: 'feature',
    preview: '📋'
  },
  {
    id: 'single-left-image',
    name: 'Single Left Image',
    description: 'Image on left, text on right',
    dimensions: '300 x 300 px',
    width: 300,
    height: 300,
    hasText: true,
    textPosition: 'right',
    category: 'feature',
    preview: '◀️'
  },
  {
    id: 'single-right-image',
    name: 'Single Right Image',
    description: 'Text on left, image on right',
    dimensions: '300 x 300 px',
    width: 300,
    height: 300,
    hasText: true,
    textPosition: 'left',
    category: 'feature',
    preview: '▶️'
  },
  {
    id: 'description-text',
    name: 'Product Description Text',
    description: 'Text-only module for detailed descriptions',
    dimensions: 'Text only',
    width: 0,
    height: 0,
    hasText: true,
    textOnly: true,
    category: 'text',
    preview: '📝'
  },
  {
    id: 'comparison-chart',
    name: 'Comparison Chart',
    description: 'Compare up to 5 products side by side',
    dimensions: '150 x 300 px per product',
    width: 150,
    height: 300,
    imageCount: 5,
    hasText: true,
    textType: 'comparison',
    category: 'comparison',
    preview: '⚖️'
  },
  {
    id: 'three-images-text',
    name: 'Three Images & Text',
    description: '3 images with accompanying text',
    dimensions: '300 x 300 px each',
    width: 300,
    height: 300,
    imageCount: 3,
    hasText: true,
    textPosition: 'below',
    category: 'gallery',
    preview: '🎯'
  }
]

// Premium A+ Content Module Definitions (1464px wide - full width immersive)
const PREMIUM_MODULES = [
  {
    id: 'premium-header',
    name: 'Premium Header Image',
    description: 'Full-width premium hero image',
    dimensions: '1464 x 600 px',
    width: 1464,
    height: 600,
    hasText: false,
    category: 'header',
    preview: '🌟',
    isPremium: true
  },
  {
    id: 'premium-full-bg-text',
    name: 'Full Background with Text',
    description: 'Immersive background image with text overlay',
    dimensions: '1464 x 625 px',
    width: 1464,
    height: 625,
    hasText: true,
    textPosition: 'overlay',
    category: 'header',
    preview: '🎨',
    isPremium: true
  },
  {
    id: 'premium-light-overlay',
    name: 'Premium Light Text Overlay',
    description: 'Premium banner with light text overlay',
    dimensions: '1464 x 350 px',
    width: 1464,
    height: 350,
    hasText: true,
    textPosition: 'overlay-light',
    category: 'banner',
    preview: '☀️',
    isPremium: true
  },
  {
    id: 'premium-dark-overlay',
    name: 'Premium Dark Text Overlay',
    description: 'Premium banner with dark text overlay',
    dimensions: '1464 x 350 px',
    width: 1464,
    height: 350,
    hasText: true,
    textPosition: 'overlay-dark',
    category: 'banner',
    preview: '🌙',
    isPremium: true
  },
  {
    id: 'premium-single-image',
    name: 'Premium Single Image',
    description: 'Large full-width single image',
    dimensions: '1464 x 600 px',
    width: 1464,
    height: 600,
    hasText: false,
    category: 'feature',
    preview: '🖼️',
    isPremium: true
  },
  {
    id: 'premium-two-image-text',
    name: 'Premium Two Image & Text',
    description: '2 images with text descriptions',
    dimensions: '362 x 453 px each',
    width: 362,
    height: 453,
    imageCount: 2,
    hasText: true,
    textPosition: 'below',
    category: 'gallery',
    preview: '📊',
    isPremium: true
  },
  {
    id: 'premium-three-image-text',
    name: 'Premium Three Image & Text',
    description: '3 images with text descriptions',
    dimensions: '362 x 453 px each',
    width: 362,
    height: 453,
    imageCount: 3,
    hasText: true,
    textPosition: 'below',
    category: 'gallery',
    preview: '🎯',
    isPremium: true
  },
  {
    id: 'premium-four-image-text',
    name: 'Premium Four Image & Text',
    description: '4 images with text below each',
    dimensions: '362 x 453 px each',
    width: 362,
    height: 453,
    imageCount: 4,
    hasText: true,
    textPosition: 'below',
    category: 'gallery',
    preview: '📋',
    isPremium: true
  },
  {
    id: 'premium-four-image-highlight',
    name: 'Premium Four Image Highlight',
    description: '4 square highlight images',
    dimensions: '362 x 362 px each',
    width: 362,
    height: 362,
    imageCount: 4,
    hasText: false,
    category: 'gallery',
    preview: '✨',
    isPremium: true
  },
  {
    id: 'premium-comparison-chart',
    name: 'Premium Comparison Chart',
    description: 'Compare up to 6 products side by side',
    dimensions: '150 x 300 px per product',
    width: 150,
    height: 300,
    imageCount: 6,
    hasText: true,
    textType: 'comparison',
    category: 'comparison',
    preview: '⚖️',
    isPremium: true
  },
  {
    id: 'premium-hotspot',
    name: 'Premium Hotspot Module',
    description: 'Interactive image with clickable hotspots',
    dimensions: '1464 x 600 px',
    width: 1464,
    height: 600,
    hasText: true,
    textType: 'hotspots',
    category: 'interactive',
    preview: '🎯',
    isPremium: true,
    isInteractive: true
  },
  {
    id: 'premium-carousel',
    name: 'Premium Image Carousel',
    description: 'Scrollable image gallery',
    dimensions: '362 x 453 px per image',
    width: 362,
    height: 453,
    imageCount: 5,
    hasText: true,
    category: 'interactive',
    preview: '🎠',
    isPremium: true,
    isInteractive: true
  },
  {
    id: 'premium-video',
    name: 'Premium Video Module',
    description: 'HD video content (1280x720 min)',
    dimensions: '1280 x 720 px (HD)',
    width: 1280,
    height: 720,
    hasText: true,
    textPosition: 'below',
    category: 'interactive',
    preview: '🎬',
    isPremium: true,
    isInteractive: true,
    isVideo: true
  },
  {
    id: 'premium-nav-carousel',
    name: 'Premium Navigation Carousel',
    description: 'Interactive navigation with thumbnails',
    dimensions: 'Variable',
    width: 362,
    height: 362,
    imageCount: 6,
    hasText: true,
    category: 'interactive',
    preview: '🧭',
    isPremium: true,
    isInteractive: true
  },
  {
    id: 'premium-qa',
    name: 'Premium Q&A Module',
    description: 'Interactive FAQ section',
    dimensions: 'Text only',
    width: 0,
    height: 0,
    hasText: true,
    textOnly: true,
    textType: 'qa',
    category: 'interactive',
    preview: '❓',
    isPremium: true,
    isInteractive: true
  }
]

const MODULE_CATEGORIES = [
  { id: 'all', name: 'All Modules' },
  { id: 'header', name: 'Headers' },
  { id: 'banner', name: 'Banners' },
  { id: 'feature', name: 'Features' },
  { id: 'gallery', name: 'Galleries' },
  { id: 'text', name: 'Text' },
  { id: 'comparison', name: 'Comparison' },
  { id: 'interactive', name: 'Interactive', premiumOnly: true }
]

const GUIDELINES = [
  { icon: '✓', text: 'Use high-resolution, professional images (min 72 DPI)' },
  { icon: '✓', text: 'Focus on brand story and product benefits' },
  { icon: '✓', text: 'Keep text concise and scannable' },
  { icon: '✗', text: 'No pricing or promotional information' },
  { icon: '✗', text: 'No contact info or external links' },
  { icon: '✗', text: 'No unverified claims like "best" or "#1"' },
  { icon: '✗', text: 'No customer reviews or testimonials' }
]

// Mock Creative Campaign Data (would come from Creative Campaigns tool)
const CREATIVE_CAMPAIGN_DATA = {
  productName: 'Premium Wireless Headphones',
  brandName: 'AudioPro',
  targetAudience: 'Tech-savvy professionals aged 25-45',
  keyBenefits: [
    'Active noise cancellation',
    '40-hour battery life',
    'Premium comfort memory foam',
    'Crystal clear audio quality'
  ],
  painPoints: [
    'Uncomfortable headphones during long use',
    'Poor battery life interrupting work',
    'Distracting background noise'
  ],
  emotionalTriggers: [
    'Focus and productivity',
    'Premium quality and status',
    'Comfort and relaxation'
  ],
  competitiveAdvantages: [
    'Industry-leading battery life',
    'Superior noise cancellation',
    'Lightweight premium design'
  ],
  toneOfVoice: 'Professional, confident, premium',
  keywords: ['wireless', 'noise-cancelling', 'premium', 'comfort', 'professional']
}

// Generate prompt templates based on module type and campaign data
const generateModulePrompt = (moduleType, campaignData = CREATIVE_CAMPAIGN_DATA) => {
  const prompts = {
    'image-header': `Create a stunning hero image for ${campaignData.productName} by ${campaignData.brandName}.
Target audience: ${campaignData.targetAudience}
Style: Professional, premium, aspirational
Key message: Showcase the product as a premium lifestyle choice
Include: Product prominently displayed, clean background, subtle brand elements
Mood: ${campaignData.emotionalTriggers.join(', ')}
Dimensions: 970x600 pixels, full-width banner`,

    'company-logo': `Create a professional company logo display for ${campaignData.brandName}.
Style: Clean, professional, brand-consistent
Background: Pure white or transparent
Requirements:
- High resolution logo centered
- Adequate padding around logo
- No taglines or additional text unless part of official logo
- Consistent with brand identity guidelines
Tone: ${campaignData.toneOfVoice}
Dimensions: 600x180 pixels (horizontal/landscape format)`,

    'image-light-overlay': `Design a banner image with light text overlay for ${campaignData.productName}.
Highlight: ${campaignData.keyBenefits[0]}
Background: Bright, airy lifestyle setting
Text area: Left or right side for headline overlay
Target: ${campaignData.targetAudience}
Tone: ${campaignData.toneOfVoice}
Dimensions: 970x300 pixels`,

    'image-dark-overlay': `Design a banner image with dark text overlay for ${campaignData.productName}.
Highlight: ${campaignData.keyBenefits[1] || campaignData.keyBenefits[0]}
Background: Rich, dramatic setting that conveys premium quality
Text area: Contrasting area for dark text overlay
Emotional appeal: ${campaignData.emotionalTriggers[0]}
Dimensions: 970x300 pixels`,

    'single-image-highlights': `Create a feature image showcasing ${campaignData.productName} with highlight points.
Key features to visualize:
${campaignData.keyBenefits.map((b, i) => `${i + 1}. ${b}`).join('\n')}
Style: Clean product shot on white/neutral background
Focus: Clear detail visibility for feature callouts
Dimensions: 300x300 pixels`,

    'single-image-sidebar': `Create a product image for sidebar layout featuring ${campaignData.productName}.
Solving pain point: ${campaignData.painPoints[0]}
Show: Product in use or lifestyle context
Complement: Space for descriptive text on the side
Appeal to: ${campaignData.targetAudience}
Dimensions: 300x400 pixels`,

    'multiple-image-a': `Create a series of 4 complementary images for ${campaignData.productName}.
Image 1: Product front view - professional studio shot
Image 2: Product angle view - showing design details
Image 3: Product in use - lifestyle context
Image 4: Key feature close-up - ${campaignData.keyBenefits[0]}
Style: Consistent lighting and background across all images
Dimensions: 220x220 pixels each`,

    'four-image-text': `Create 4 feature images with text space for ${campaignData.productName}.
${campaignData.keyBenefits.slice(0, 4).map((benefit, i) => `Image ${i + 1}: Visualize "${benefit}"`).join('\n')}
Style: Icon-style or focused product shots
Background: Clean, consistent across all
Leave space below for feature descriptions
Dimensions: 220x220 pixels each`,

    'single-image-specs': `Create a technical specification image for ${campaignData.productName}.
Show: Product with clear visibility of key components
Style: Technical/informative but still premium
Highlight areas for spec callouts
Include: Clean angles showing dimensions and features
Keywords: ${campaignData.keywords.join(', ')}
Dimensions: 300x300 pixels`,

    'single-left-image': `Create a left-aligned product image for ${campaignData.productName}.
Context: ${campaignData.emotionalTriggers[1] || 'Premium lifestyle'}
Show: Product in aspirational setting
Solving: ${campaignData.painPoints[1] || campaignData.painPoints[0]}
Right side: Space for benefit-focused copy
Dimensions: 300x300 pixels`,

    'single-right-image': `Create a right-aligned product image for ${campaignData.productName}.
Advantage: ${campaignData.competitiveAdvantages[0]}
Show: Product demonstrating this competitive edge
Left side: Space for compelling headline and body text
Target emotion: ${campaignData.emotionalTriggers[2] || campaignData.emotionalTriggers[0]}
Dimensions: 300x300 pixels`,

    'description-text': `Write compelling A+ Content copy for ${campaignData.productName}.
Brand: ${campaignData.brandName}
Tone: ${campaignData.toneOfVoice}
Target: ${campaignData.targetAudience}

Key benefits to convey:
${campaignData.keyBenefits.map(b => `• ${b}`).join('\n')}

Pain points to address:
${campaignData.painPoints.map(p => `• ${p}`).join('\n')}

Competitive advantages:
${campaignData.competitiveAdvantages.map(a => `• ${a}`).join('\n')}

Note: No pricing, no superlatives like "best", no competitor mentions`,

    'comparison-chart': `Create comparison chart images for ${campaignData.productName} vs alternatives.
Our product advantages:
${campaignData.competitiveAdvantages.map(a => `✓ ${a}`).join('\n')}
Style: Professional product shots on white background
Show: Our product as the premium choice
Include: Up to 5 product slots
Dimensions: 150x300 pixels per product`,

    'three-images-text': `Create 3 storytelling images for ${campaignData.productName}.
Image 1 - The Problem: Visualize "${campaignData.painPoints[0]}"
Image 2 - The Solution: Show ${campaignData.productName} in action
Image 3 - The Result: ${campaignData.emotionalTriggers[0]} achieved
Flow: Problem → Solution → Benefit narrative
Style: Consistent, premium, relatable to ${campaignData.targetAudience}
Dimensions: 300x300 pixels each`,

    // Premium A+ Content Prompts (1464px wide - immersive full-width)
    'premium-header': `Create a stunning PREMIUM hero image for ${campaignData.productName} by ${campaignData.brandName}.
Format: Premium A+ Content (1464px wide - full immersive width)
Target audience: ${campaignData.targetAudience}
Style: Ultra-premium, cinematic, aspirational
Key message: Position the product as a luxury lifestyle choice
Include: Product as hero, dramatic lighting, high-end aesthetic
Mood: ${campaignData.emotionalTriggers.join(', ')}
Dimensions: 1464x600 pixels (Premium full-width)`,

    'premium-full-bg-text': `Create an immersive full-background image for ${campaignData.productName}.
Format: Premium A+ Content - Full Background with Text
Style: Cinematic, lifestyle-focused, premium atmosphere
Background: Rich, detailed scene that tells a story
Text overlay area: Leave space for compelling headline
Brand essence: ${campaignData.toneOfVoice}
Key benefit: ${campaignData.keyBenefits[0]}
Dimensions: 1464x625 pixels`,

    'premium-light-overlay': `Design a premium banner with light text overlay for ${campaignData.productName}.
Format: Premium A+ Content (1464px wide)
Highlight: ${campaignData.keyBenefits[0]}
Background: Bright, premium lifestyle setting
Text area: Generous space for light-colored headline overlay
Target: ${campaignData.targetAudience}
Dimensions: 1464x350 pixels`,

    'premium-dark-overlay': `Design a premium banner with dark text overlay for ${campaignData.productName}.
Format: Premium A+ Content (1464px wide)
Highlight: ${campaignData.keyBenefits[1] || campaignData.keyBenefits[0]}
Background: Rich, dramatic setting conveying luxury
Text area: Contrasting area for dark text overlay
Emotional appeal: ${campaignData.emotionalTriggers[0]}
Dimensions: 1464x350 pixels`,

    'premium-single-image': `Create a large premium single image for ${campaignData.productName}.
Format: Premium A+ Content - Full Width Single Image
Style: Studio quality, dramatic lighting, ultra-high resolution
Focus: Product detail and craftsmanship
Showcase: ${campaignData.competitiveAdvantages[0]}
Background: Clean, premium gradient or contextual
Dimensions: 1464x600 pixels`,

    'premium-two-image-text': `Create 2 premium feature images for ${campaignData.productName}.
Image 1: ${campaignData.keyBenefits[0]} - visualize the benefit
Image 2: ${campaignData.keyBenefits[1] || 'Product in premium context'}
Style: Consistent premium aesthetic, lifestyle-oriented
Space below each for feature descriptions
Target: ${campaignData.targetAudience}
Dimensions: 362x453 pixels each`,

    'premium-three-image-text': `Create 3 premium storytelling images for ${campaignData.productName}.
Image 1: The Challenge - ${campaignData.painPoints[0]}
Image 2: The Solution - ${campaignData.productName} in action
Image 3: The Transformation - ${campaignData.emotionalTriggers[0]}
Flow: Problem → Solution → Success narrative
Style: Premium, cinematic, emotionally engaging
Dimensions: 362x453 pixels each`,

    'premium-four-image-text': `Create 4 premium feature images for ${campaignData.productName}.
${campaignData.keyBenefits.slice(0, 4).map((benefit, i) => `Image ${i + 1}: "${benefit}"`).join('\n')}
Style: Premium, consistent lighting and treatment
Each image should have space below for text
Target audience: ${campaignData.targetAudience}
Dimensions: 362x453 pixels each`,

    'premium-four-image-highlight': `Create 4 premium square highlight images for ${campaignData.productName}.
Image 1: Product hero shot - premium angle
Image 2: Key feature close-up - ${campaignData.keyBenefits[0]}
Image 3: Lifestyle context - product in use
Image 4: Detail/texture shot - quality craftsmanship
Style: Ultra-premium, gallery-worthy
Dimensions: 362x362 pixels each`,

    'premium-comparison-chart': `Create premium comparison chart images for ${campaignData.productName}.
Our product advantages:
${campaignData.competitiveAdvantages.map(a => `✓ ${a}`).join('\n')}
Style: Premium product photography, white background
Show: Our product as the clear premium choice
Include: Up to 6 product comparison slots
Visual hierarchy: Our product prominently featured
Dimensions: 150x300 pixels per product`,

    'premium-hotspot': `Create an interactive hotspot image for ${campaignData.productName}.
Format: Premium A+ Content - Interactive Hotspot Module
Main image: Full product shot with clear feature areas
Hotspot areas to highlight:
${campaignData.keyBenefits.map((b, i) => `${i + 1}. ${b}`).join('\n')}
Style: Clean, detailed product photography
Purpose: Users click areas to learn about features
Dimensions: 1464x600 pixels`,

    'premium-carousel': `Create a premium scrollable image carousel for ${campaignData.productName}.
5 carousel slides:
Slide 1: Hero product shot
Slide 2: Feature highlight - ${campaignData.keyBenefits[0]}
Slide 3: Lifestyle usage context
Slide 4: Detail close-up
Slide 5: Brand story/packaging
Style: Premium, consistent, scroll-worthy
Dimensions: 362x453 pixels per image`,

    'premium-video': `Create a video thumbnail/cover for ${campaignData.productName}.
Format: Premium A+ Content - Video Module
Video content suggestions:
- Product demonstration
- Feature showcase
- Brand story
- Customer transformation
Thumbnail: Compelling frame that encourages play
Style: Cinematic, professional
Minimum: 1280x720 pixels (HD)`,

    'premium-nav-carousel': `Create navigation carousel thumbnails for ${campaignData.productName}.
6 navigation items showcasing:
1. Product overview
2. Key features
3. Benefits
4. How to use
5. Specifications
6. Brand story
Style: Consistent, clickable thumbnails
Each should clearly represent its section
Dimensions: 362x362 pixels per thumbnail`,

    'premium-qa': `Write Premium Q&A content for ${campaignData.productName}.
Format: Interactive FAQ Module
Brand: ${campaignData.brandName}
Tone: ${campaignData.toneOfVoice}

Suggested Q&A pairs addressing:
${campaignData.painPoints.map(p => `Q: How does this solve "${p}"?`).join('\n')}
${campaignData.keyBenefits.map(b => `Q: Tell me about "${b}"`).join('\n')}

Style: Helpful, authoritative, brand-consistent
Note: No pricing, no superlatives, no competitor mentions`
  }

  return prompts[moduleType] || `Create a professional Amazon A+ Content image for ${campaignData.productName}.
Brand: ${campaignData.brandName}
Target: ${campaignData.targetAudience}
Key benefit: ${campaignData.keyBenefits[0]}
Style: Premium, professional, Amazon-compliant`
}

function APlusContent() {
  // Content type selection
  const [contentType, setContentType] = useState('standard') // 'standard' | 'premium'

  // ASIN input
  const [asinValue, setAsinValue] = useState('')
  const [productCategory, setProductCategory] = useState('')

  // Module management
  const [selectedModules, setSelectedModules] = useState([])
  const [categoryFilter, setCategoryFilter] = useState('all')
  const [draggedIndex, setDraggedIndex] = useState(null)

  // Module data (images and text for each added module)
  const [moduleData, setModuleData] = useState({})

  // UI state
  const [previewMode, setPreviewMode] = useState(false)
  const [expandedModule, setExpandedModule] = useState(null)
  const [isGenerating, setIsGenerating] = useState(false)
  const [showGuidelines, setShowGuidelines] = useState(true)

  // Validation
  const isValidASIN = (asin) => /^[A-Z0-9]{10}$/i.test(asin)
  const canAddModule = selectedModules.length < 7
  const hasMinModules = selectedModules.length >= 1

  // Get current modules based on content type
  const currentModules = contentType === 'premium' ? PREMIUM_MODULES : STANDARD_MODULES

  // Get available categories based on content type
  const availableCategories = contentType === 'premium'
    ? MODULE_CATEGORIES
    : MODULE_CATEGORIES.filter(c => !c.premiumOnly)

  // Filter modules by category
  const filteredModules = categoryFilter === 'all'
    ? currentModules
    : currentModules.filter(m => m.category === categoryFilter)

  // Clear modules when switching content type
  const handleContentTypeChange = (newType) => {
    if (newType !== contentType) {
      setContentType(newType)
      setSelectedModules([])
      setModuleData({})
      setCategoryFilter('all')
      setExpandedModule(null)
    }
  }

  // Add module to content
  const addModule = (moduleType) => {
    if (!canAddModule) return

    const moduleDefinition = currentModules.find(m => m.id === moduleType)
    if (!moduleDefinition) return

    const newModule = {
      instanceId: `${moduleType}-${Date.now()}`,
      type: moduleType,
      ...moduleDefinition
    }

    setSelectedModules(prev => [...prev, newModule])
    setModuleData(prev => ({
      ...prev,
      [newModule.instanceId]: {
        referenceImage: null,
        aiPrompt: generateModulePrompt(moduleType),
        images: [],
        headline: '',
        body: '',
        highlights: [],
        specs: [],
        hotspots: [],
        qaItems: []
      }
    }))
    setExpandedModule(newModule.instanceId)
  }

  // Remove module from content
  const removeModule = (instanceId) => {
    setSelectedModules(prev => prev.filter(m => m.instanceId !== instanceId))
    setModuleData(prev => {
      const updated = { ...prev }
      delete updated[instanceId]
      return updated
    })
    if (expandedModule === instanceId) {
      setExpandedModule(null)
    }
  }

  // Reorder modules via drag and drop
  const handleDragStart = (index) => {
    setDraggedIndex(index)
  }

  const handleDragOver = (e, index) => {
    e.preventDefault()
    if (draggedIndex === null || draggedIndex === index) return

    const newModules = [...selectedModules]
    const draggedModule = newModules[draggedIndex]
    newModules.splice(draggedIndex, 1)
    newModules.splice(index, 0, draggedModule)

    setSelectedModules(newModules)
    setDraggedIndex(index)
  }

  const handleDragEnd = () => {
    setDraggedIndex(null)
  }

  // Move module up/down
  const moveModule = (index, direction) => {
    const newIndex = direction === 'up' ? index - 1 : index + 1
    if (newIndex < 0 || newIndex >= selectedModules.length) return

    const newModules = [...selectedModules]
    const temp = newModules[index]
    newModules[index] = newModules[newIndex]
    newModules[newIndex] = temp
    setSelectedModules(newModules)
  }

  // Update module data
  const updateModuleData = (instanceId, field, value) => {
    setModuleData(prev => ({
      ...prev,
      [instanceId]: {
        ...prev[instanceId],
        [field]: value
      }
    }))
  }

  // Handle reference image upload for module
  const handleReferenceImageUpload = useCallback((instanceId, e) => {
    const file = e.target?.files?.[0]
    if (!file || !file.type.startsWith('image/')) return

    if (file.size > 10 * 1024 * 1024) {
      alert('Reference image must be less than 10MB')
      return
    }

    const reader = new FileReader()
    reader.onload = (e) => {
      setModuleData(prev => ({
        ...prev,
        [instanceId]: {
          ...prev[instanceId],
          referenceImage: {
            file,
            preview: e.target.result,
            name: file.name
          }
        }
      }))
    }
    reader.readAsDataURL(file)
  }, [])

  // Handle image upload for module
  const handleModuleImageUpload = useCallback((instanceId, imageIndex, e) => {
    const file = e.target?.files?.[0]
    if (!file || !file.type.startsWith('image/')) return

    if (file.size > 2 * 1024 * 1024) {
      alert('Image must be less than 2MB')
      return
    }

    const reader = new FileReader()
    reader.onload = (e) => {
      setModuleData(prev => {
        const currentImages = prev[instanceId]?.images || []
        const newImages = [...currentImages]
        newImages[imageIndex] = {
          file,
          preview: e.target.result,
          name: file.name
        }
        return {
          ...prev,
          [instanceId]: {
            ...prev[instanceId],
            images: newImages
          }
        }
      })
    }
    reader.readAsDataURL(file)
  }, [])

  // Generate AI content for module
  const generateModuleContent = async (instanceId) => {
    setIsGenerating(true)
    // Simulated AI generation - in production, this would call the AI API
    await new Promise(resolve => setTimeout(resolve, 1500))

    const module = selectedModules.find(m => m.instanceId === instanceId)

    // Generate sample content based on module type
    const sampleContent = {
      headline: `Premium Quality ${module?.name || 'Product'} Feature`,
      body: 'Discover the exceptional craftsmanship and attention to detail that sets our product apart. Made with premium materials for lasting durability and performance.',
      highlights: [
        'Premium quality materials',
        'Ergonomic design for comfort',
        'Built to last with durability',
        'Satisfaction guaranteed'
      ],
      specs: [
        { label: 'Material', value: 'Premium Grade' },
        { label: 'Dimensions', value: 'Standard Size' },
        { label: 'Weight', value: 'Lightweight' },
        { label: 'Warranty', value: '1 Year' }
      ]
    }

    updateModuleData(instanceId, 'headline', sampleContent.headline)
    updateModuleData(instanceId, 'body', sampleContent.body)
    if (module?.textType === 'highlights') {
      updateModuleData(instanceId, 'highlights', sampleContent.highlights)
    }
    if (module?.textType === 'specs') {
      updateModuleData(instanceId, 'specs', sampleContent.specs)
    }

    setIsGenerating(false)
  }

  // Regenerate AI prompt for module
  const regeneratePrompt = (instanceId, moduleType) => {
    const newPrompt = generateModulePrompt(moduleType)
    updateModuleData(instanceId, 'aiPrompt', newPrompt)
  }

  // Render module editor based on type
  const renderModuleEditor = (module) => {
    const data = moduleData[module.instanceId] || {}
    const imageCount = module.imageCount || 1

    return (
      <div className="module-editor">
        {/* Reference Image Upload Section */}
        <div className="reference-image-section">
          <label className="module-label">
            <Image size={16} />
            Reference Image
            <span className="label-hint">(Your product photo for AI to use)</span>
          </label>
          <div className="reference-image-upload-area">
            {data.referenceImage ? (
              <div className="reference-image-preview">
                <img src={data.referenceImage.preview} alt="Reference" />
                <div className="reference-image-info">
                  <span className="reference-image-name">{data.referenceImage.name}</span>
                  <button
                    className="btn btn-sm btn-ghost"
                    onClick={() => updateModuleData(module.instanceId, 'referenceImage', null)}
                  >
                    <X size={14} />
                    Remove
                  </button>
                </div>
              </div>
            ) : (
              <label className="reference-image-dropzone">
                <input
                  type="file"
                  accept="image/*"
                  onChange={(e) => handleReferenceImageUpload(module.instanceId, e)}
                  style={{ display: 'none' }}
                />
                <Upload size={24} />
                <span className="dropzone-title">Upload Reference Image</span>
                <span className="dropzone-hint">JPG, PNG, WebP (Max 10MB)</span>
                <span className="dropzone-hint">This image will be used by AI to generate module content</span>
              </label>
            )}
          </div>
        </div>

        {/* AI Prompt Section */}
        <div className="ai-prompt-section">
          <div className="ai-prompt-header">
            <label className="module-label">
              <Wand2 size={16} />
              AI Generation Prompt
              <span className="label-hint">(Auto-generated from Creative Campaign)</span>
            </label>
            <div className="ai-prompt-actions">
              <button
                className="btn btn-sm btn-ghost"
                onClick={() => regeneratePrompt(module.instanceId, module.id)}
                title="Regenerate prompt from campaign data"
              >
                <RefreshCw size={14} />
                Reset
              </button>
            </div>
          </div>
          <div className="ai-prompt-textarea-wrapper">
            <textarea
              className="ai-prompt-textarea"
              value={data.aiPrompt || ''}
              onChange={(e) => updateModuleData(module.instanceId, 'aiPrompt', e.target.value)}
              placeholder="Enter your AI generation prompt here..."
              rows={8}
            />
            <div className="ai-prompt-footer">
              <span className="char-count">{(data.aiPrompt || '').length} characters</span>
              <div className="ai-prompt-tags">
                <span className="prompt-tag">
                  <FileText size={12} />
                  Based on Campaign Data
                </span>
              </div>
            </div>
          </div>
          <button
            className="btn btn-primary btn-generate-images"
            disabled={isGenerating || !data.referenceImage}
            onClick={() => generateModuleContent(module.instanceId)}
          >
            {isGenerating ? (
              <>
                <Loader2 size={16} className="spin" />
                Generating...
              </>
            ) : (
              <>
                <Sparkles size={16} />
                Generate with AI
              </>
            )}
          </button>
          {!data.referenceImage && (
            <p className="ai-prompt-hint">Upload a reference image first to enable AI generation</p>
          )}
        </div>

        {/* Generated/Output Image Upload Section */}
        {!module.textOnly && (
          <div className="module-images">
            <label className="module-label">
              Output Images <span className="dim">({module.dimensions})</span>
              <span className="label-hint">— AI generated or manually upload</span>
            </label>
            <div className={`module-image-grid images-${imageCount}`}>
              {Array.from({ length: imageCount }).map((_, idx) => (
                <div
                  key={idx}
                  className="module-image-slot"
                  style={{
                    aspectRatio: `${module.width}/${module.height}`
                  }}
                >
                  {data.images?.[idx] ? (
                    <div className="module-image-preview">
                      <img src={data.images[idx].preview} alt={`Image ${idx + 1}`} />
                      <button
                        className="remove-image-btn"
                        onClick={() => {
                          const newImages = [...(data.images || [])]
                          newImages[idx] = null
                          updateModuleData(module.instanceId, 'images', newImages)
                        }}
                      >
                        <X size={14} />
                      </button>
                    </div>
                  ) : (
                    <label className="module-image-upload">
                      <input
                        type="file"
                        accept="image/*"
                        onChange={(e) => handleModuleImageUpload(module.instanceId, idx, e)}
                        style={{ display: 'none' }}
                      />
                      <Upload size={20} />
                      <span>{module.width}x{module.height}</span>
                    </label>
                  )}
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Text Fields */}
        {module.hasText && (
          <div className="module-text-fields">
            <div className="module-field">
              <label className="module-label">Headline</label>
              <input
                type="text"
                placeholder="Enter headline..."
                value={data.headline || ''}
                onChange={(e) => updateModuleData(module.instanceId, 'headline', e.target.value)}
                maxLength={150}
              />
              <span className="char-count">{(data.headline || '').length}/150</span>
            </div>

            {module.textType === 'highlights' ? (
              <div className="module-field">
                <label className="module-label">Highlights (up to 4)</label>
                {Array.from({ length: 4 }).map((_, idx) => (
                  <input
                    key={idx}
                    type="text"
                    placeholder={`Highlight ${idx + 1}`}
                    value={data.highlights?.[idx] || ''}
                    onChange={(e) => {
                      const newHighlights = [...(data.highlights || [])]
                      newHighlights[idx] = e.target.value
                      updateModuleData(module.instanceId, 'highlights', newHighlights)
                    }}
                    maxLength={100}
                  />
                ))}
              </div>
            ) : module.textType === 'specs' ? (
              <div className="module-field">
                <label className="module-label">Specifications</label>
                {Array.from({ length: 4 }).map((_, idx) => (
                  <div key={idx} className="spec-row">
                    <input
                      type="text"
                      placeholder="Label"
                      value={data.specs?.[idx]?.label || ''}
                      onChange={(e) => {
                        const newSpecs = [...(data.specs || [])]
                        newSpecs[idx] = { ...newSpecs[idx], label: e.target.value }
                        updateModuleData(module.instanceId, 'specs', newSpecs)
                      }}
                    />
                    <input
                      type="text"
                      placeholder="Value"
                      value={data.specs?.[idx]?.value || ''}
                      onChange={(e) => {
                        const newSpecs = [...(data.specs || [])]
                        newSpecs[idx] = { ...newSpecs[idx], value: e.target.value }
                        updateModuleData(module.instanceId, 'specs', newSpecs)
                      }}
                    />
                  </div>
                ))}
              </div>
            ) : module.textType === 'comparison' ? (
              <div className="module-field">
                <label className="module-label">Comparison Products (up to 5)</label>
                <p className="field-hint">Add product names and features to compare</p>
                {Array.from({ length: 5 }).map((_, idx) => (
                  <input
                    key={idx}
                    type="text"
                    placeholder={`Product ${idx + 1} name`}
                    value={data.products?.[idx] || ''}
                    onChange={(e) => {
                      const newProducts = [...(data.products || [])]
                      newProducts[idx] = e.target.value
                      updateModuleData(module.instanceId, 'products', newProducts)
                    }}
                  />
                ))}
              </div>
            ) : (
              <div className="module-field">
                <label className="module-label">Body Text</label>
                <textarea
                  placeholder="Enter body text..."
                  value={data.body || ''}
                  onChange={(e) => updateModuleData(module.instanceId, 'body', e.target.value)}
                  maxLength={500}
                  rows={4}
                />
                <span className="char-count">{(data.body || '').length}/500</span>
              </div>
            )}

            <button
              className="btn btn-secondary btn-sm ai-generate-btn"
              onClick={() => generateModuleContent(module.instanceId)}
              disabled={isGenerating}
            >
              {isGenerating ? <Loader2 size={16} className="spin" /> : <Sparkles size={16} />}
              AI Generate Content
            </button>
          </div>
        )}
      </div>
    )
  }

  // Render module preview
  const renderModulePreview = (module) => {
    const data = moduleData[module.instanceId] || {}

    return (
      <div className={`module-preview preview-${module.id}`}>
        {module.textOnly ? (
          <div className="preview-text-only">
            <h4>{data.headline || 'Headline'}</h4>
            <p>{data.body || 'Body text will appear here...'}</p>
          </div>
        ) : (
          <div className="preview-with-image">
            {data.images?.[0] ? (
              <img src={data.images[0].preview} alt="Preview" />
            ) : (
              <div className="preview-placeholder">
                <Image size={24} />
                <span>{module.dimensions}</span>
              </div>
            )}
            {module.hasText && (
              <div className="preview-text">
                <h4>{data.headline || 'Headline'}</h4>
              </div>
            )}
          </div>
        )}
      </div>
    )
  }

  return (
    <div className="aplus-content-page aplus-layout-vertical">
      {/* Top Toolbar */}
      <div className="aplus-toolbar">
        <div className="toolbar-row toolbar-main">
          <div className="toolbar-left">
            <h1>A+ Content Creator</h1>
            <div className="content-type-switcher">
              <button
                className={`type-btn ${contentType === 'standard' ? 'active' : ''}`}
                onClick={() => handleContentTypeChange('standard')}
              >
                Standard
                <span className="type-width">970px</span>
              </button>
              <button
                className={`type-btn ${contentType === 'premium' ? 'active' : ''}`}
                onClick={() => handleContentTypeChange('premium')}
              >
                Premium
                <span className="type-width">1464px</span>
              </button>
            </div>
          </div>
          <div className="toolbar-center">
            <select
              className="category-dropdown"
              value={productCategory}
              onChange={(e) => setProductCategory(e.target.value)}
            >
              <option value="">Product Category</option>
              {PRODUCT_CATEGORIES.map(cat => (
                <option key={cat} value={cat}>{cat}</option>
              ))}
            </select>
            <div className="asin-input-compact">
              <Search size={16} />
              <input
                type="text"
                placeholder="Enter ASIN"
                value={asinValue}
                onChange={(e) => setAsinValue(e.target.value.toUpperCase())}
                maxLength={10}
              />
              {asinValue && (
                <span className={`asin-status ${isValidASIN(asinValue) ? 'valid' : 'invalid'}`}>
                  {isValidASIN(asinValue) ? <Check size={14} /> : <X size={14} />}
                </span>
              )}
            </div>
            <span className="module-counter-badge">
              {selectedModules.length}/7 modules
            </span>
          </div>
          <div className="toolbar-right">
            <button
              className={`btn btn-sm ${previewMode ? 'btn-primary' : 'btn-secondary'}`}
              onClick={() => setPreviewMode(!previewMode)}
            >
              {previewMode ? <EyeOff size={16} /> : <Eye size={16} />}
              {previewMode ? 'Edit' : 'Preview'}
            </button>
            <button className="btn btn-sm btn-secondary" disabled={selectedModules.length === 0}>
              <Save size={16} />
              Save
            </button>
            <button className="btn btn-sm btn-primary" disabled={!hasMinModules}>
              <Download size={16} />
              Export
            </button>
            {/* Guidelines Info Icon with Popup */}
            <div className="guidelines-dropdown">
              <button
                className={`btn-icon-circle ${showGuidelines ? 'active' : ''}`}
                onClick={() => setShowGuidelines(!showGuidelines)}
                title="A+ Content Guidelines"
              >
                <Info size={18} />
              </button>
              {showGuidelines && (
                <div className="guidelines-popup">
                  <div className="guidelines-popup-header">
                    <h4>A+ Content Guidelines</h4>
                    <button className="popup-close" onClick={() => setShowGuidelines(false)}>
                      <X size={16} />
                    </button>
                  </div>
                  <div className="guidelines-popup-content">
                    {GUIDELINES.map((guideline, idx) => (
                      <div
                        key={idx}
                        className={`guideline-row ${guideline.icon === '✓' ? 'do' : 'dont'}`}
                      >
                        <span className="guideline-icon">{guideline.icon}</span>
                        <span>{guideline.text}</span>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>
          </div>
        </div>

        {/* Module Library Row */}
        <div className="toolbar-row toolbar-modules">
          <div className="category-tabs">
            {availableCategories.map(cat => (
              <button
                key={cat.id}
                className={`category-tab ${categoryFilter === cat.id ? 'active' : ''} ${cat.premiumOnly ? 'premium-only' : ''}`}
                onClick={() => setCategoryFilter(cat.id)}
              >
                {cat.name}
                {cat.premiumOnly && <span className="premium-badge">✨</span>}
              </button>
            ))}
          </div>
          <div className="modules-scroll">
            {filteredModules.map(module => (
              <button
                key={module.id}
                className={`module-chip ${!canAddModule ? 'disabled' : ''}`}
                onClick={() => canAddModule && addModule(module.id)}
                disabled={!canAddModule}
                title={`${module.name} (${module.dimensions})`}
              >
                <span className="chip-icon">{module.preview}</span>
                <span className="chip-name">{module.name}</span>
                <span className="chip-size">{module.dimensions}</span>
                <Plus size={14} className="chip-add" />
              </button>
            ))}
          </div>
        </div>
      </div>

      {/* Content Builder - Full Width */}
      <div className="aplus-content-area">
        {selectedModules.length === 0 ? (
          <div className="builder-empty-full">
            <LayoutGrid size={56} />
            <h3>Start Building Your A+ Content</h3>
            <p>Click on modules above to add them to your content</p>
            <span className="hint">Minimum 1 module • Maximum 7 modules</span>
          </div>
        ) : previewMode ? (
          <div className="preview-container-full">
            <div className="preview-frame">
              {selectedModules.map(module => (
                <div key={module.instanceId} className="preview-module">
                  {renderModulePreview(module)}
                </div>
              ))}
            </div>
          </div>
        ) : (
          <div className="modules-container-full">
            {selectedModules.map((module, index) => (
              <div
                key={module.instanceId}
                className={`module-item-full ${draggedIndex === index ? 'dragging' : ''} ${expandedModule === module.instanceId ? 'expanded' : ''}`}
                draggable
                onDragStart={() => handleDragStart(index)}
                onDragOver={(e) => handleDragOver(e, index)}
                onDragEnd={handleDragEnd}
              >
                <div className="module-header-full">
                  <div className="module-drag-handle">
                    <GripVertical size={18} />
                  </div>
                  <span className="module-number">{index + 1}</span>
                  <span className="module-icon-lg">{module.preview}</span>
                  <div className="module-title-info">
                    <span className="module-name-lg">{module.name}</span>
                    <span className="module-dims">{module.dimensions}</span>
                  </div>
                  <div className="module-actions-full">
                    <button
                      className="btn-icon-sm"
                      onClick={() => moveModule(index, 'up')}
                      disabled={index === 0}
                      title="Move up"
                    >
                      <ChevronUp size={18} />
                    </button>
                    <button
                      className="btn-icon-sm"
                      onClick={() => moveModule(index, 'down')}
                      disabled={index === selectedModules.length - 1}
                      title="Move down"
                    >
                      <ChevronDown size={18} />
                    </button>
                    <button
                      className="btn-icon-sm expand-btn"
                      onClick={() => setExpandedModule(
                        expandedModule === module.instanceId ? null : module.instanceId
                      )}
                      title={expandedModule === module.instanceId ? 'Collapse' : 'Expand'}
                    >
                      {expandedModule === module.instanceId ? (
                        <ChevronUp size={18} />
                      ) : (
                        <ChevronDown size={18} />
                      )}
                    </button>
                    <button
                      className="btn-icon-sm delete-btn"
                      onClick={() => removeModule(module.instanceId)}
                      title="Remove module"
                    >
                      <Trash2 size={18} />
                    </button>
                  </div>
                </div>

                {expandedModule === module.instanceId && (
                  <div className="module-content-full">
                    {renderModuleEditor(module)}
                  </div>
                )}
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  )
}

export default APlusContent

--- END OF FILE ---

--- FILE: src/pages/ListingCopywriter.jsx ---
import { useState } from 'react'
import {
  FileText,
  Search,
  Upload,
  Globe,
  MessageSquare,
  Copy,
  Check,
  RefreshCw,
  Download,
  ChevronDown,
  Loader2,
  GripVertical,
  AlertCircle
} from 'lucide-react'

const MARKETPLACES = [
  { code: 'US', flag: '🇺🇸' }, { code: 'UK', flag: '🇬🇧' }, { code: 'DE', flag: '🇩🇪' },
  { code: 'FR', flag: '🇫🇷' }, { code: 'JP', flag: '🇯🇵' }, { code: 'CA', flag: '🇨🇦' },
  { code: 'CN', flag: '🇨🇳' }, { code: 'IT', flag: '🇮🇹' }, { code: 'ES', flag: '🇪🇸' },
  { code: 'MX', flag: '🇲🇽' }, { code: 'AU', flag: '🇦🇺' }, { code: 'IN', flag: '🇮🇳' }
]

const LANGUAGES = [
  'English', 'French', 'Spanish', 'Portuguese', 'German', 'Italian',
  'Dutch', 'Swedish', 'Polish', 'Turkish', 'Arabic', 'Hindi',
  'Chinese', 'Japanese', 'Korean', 'Russian', 'Vietnamese', 'Thai',
  'Indonesian', 'Malay'
]

const TONES = [
  { id: 'professional', name: 'Professional', desc: 'Corporate, authoritative, trustworthy' },
  { id: 'witty', name: 'Witty', desc: 'Clever, playful, memorable' },
  { id: 'friendly', name: 'Friendly', desc: 'Warm, approachable, conversational' },
  { id: 'persuasive', name: 'Persuasive', desc: 'Compelling, action-oriented, urgent' },
  { id: 'informative', name: 'Informative', desc: 'Educational, detailed, factual' },
  { id: 'empathetic', name: 'Empathetic', desc: 'Understanding, supportive, caring' },
  { id: 'casual', name: 'Casual', desc: 'Relaxed, everyday, relatable' },
  { id: 'formal', name: 'Formal', desc: 'Proper, respectful, traditional' },
  { id: 'confident', name: 'Confident', desc: 'Bold, assured, strong' },
  { id: 'direct', name: 'Direct', desc: 'Straightforward, no-nonsense, clear' },
  { id: 'encouraging', name: 'Encouraging', desc: 'Motivating, positive, uplifting' },
  { id: 'neutral', name: 'Neutral', desc: 'Balanced, objective, unbiased' },
  { id: 'luxurious', name: 'Luxurious', desc: 'Premium, exclusive, sophisticated' },
  { id: 'eco-conscious', name: 'Eco-conscious', desc: 'Sustainable, green, responsible' }
]

// Mock generated content
const MOCK_RESULTS = {
  titles: [
    "Premium Wireless Earbuds with Active Noise Cancellation - 40H Battery Life, IPX7 Waterproof, Touch Control - Perfect for Sports & Work",
    "Pro Wireless Earbuds - Crystal Clear Sound, 40 Hour Playtime, Water Resistant IPX7 - Bluetooth 5.3 with Charging Case",
    "Ultra Wireless Earbuds ANC - Premium Sound Quality, 40H Battery, Waterproof IPX7 - Sports & Office Ready with Touch Controls"
  ],
  bullets: [
    "SUPERIOR SOUND QUALITY - Experience rich, immersive audio with 10mm drivers and active noise cancellation that blocks out 95% of ambient noise, perfect for commuting, working out, or focusing on work",
    "40-HOUR BATTERY LIFE - Never run out of power with 8 hours of playtime per charge plus 32 additional hours from the compact charging case. Quick charge gives you 2 hours of listening in just 10 minutes",
    "IPX7 WATERPROOF RATING - Workout without worry. These earbuds can withstand sweat, rain, and even accidental submersion, making them ideal for intense gym sessions or outdoor activities",
    "ERGONOMIC COMFORT FIT - Designed with 3 sizes of silicone ear tips for a secure, comfortable fit that stays in place during any activity. Lightweight at just 5g per earbud for all-day wear",
    "INTUITIVE TOUCH CONTROLS - Easily manage music, calls, and voice assistant with simple tap gestures. Seamless Bluetooth 5.3 connectivity for stable connection up to 33ft range"
  ],
  description: `Introducing our Premium Wireless Earbuds - the perfect companion for your active lifestyle. Whether you're commuting to work, hitting the gym, or simply relaxing at home, these earbuds deliver an exceptional audio experience that adapts to your environment.

Engineered with advanced 10mm drivers and active noise cancellation technology, you'll enjoy crystal-clear sound quality with deep bass and crisp highs. The ANC feature reduces ambient noise by up to 95%, allowing you to fully immerse yourself in your music or focus on important calls.

With an impressive 40-hour total battery life and convenient quick-charge capability, you'll never miss a beat. The sleek charging case fits easily in your pocket and provides multiple full charges on the go.

Built to withstand your toughest workouts, the IPX7 waterproof rating ensures these earbuds can handle sweat, rain, and even accidental drops in water. The ergonomic design with multiple ear tip sizes guarantees a secure, comfortable fit for any ear shape.`,
  searchTerms: "wireless earbuds, bluetooth earbuds, noise cancelling earphones, waterproof earbuds, sports earbuds, workout earphones, true wireless earbuds, anc earbuds, long battery earbuds, touch control earbuds"
}

function ListingCopywriter() {
  // Mode state
  const [mode, setMode] = useState('single') // 'single' | 'bulk'

  // Input state
  const [asinValue, setAsinValue] = useState('')
  const [marketplace, setMarketplace] = useState('US')
  const [language, setLanguage] = useState('English')
  const [tone, setTone] = useState('professional')
  const [additionalKeywords, setAdditionalKeywords] = useState('')

  // Generation state
  const [isGenerating, setIsGenerating] = useState(false)
  const [hasResults, setHasResults] = useState(false)

  // Results state
  const [titles, setTitles] = useState([])
  const [bullets, setBullets] = useState([])
  const [description, setDescription] = useState('')
  const [searchTerms, setSearchTerms] = useState('')

  // UI state
  const [activeTitle, setActiveTitle] = useState(0)
  const [copiedField, setCopiedField] = useState(null)

  const handleGenerate = async () => {
    setIsGenerating(true)
    await new Promise(r => setTimeout(r, 2000))

    setTitles(MOCK_RESULTS.titles)
    setBullets(MOCK_RESULTS.bullets)
    setDescription(MOCK_RESULTS.description)
    setSearchTerms(MOCK_RESULTS.searchTerms)

    setIsGenerating(false)
    setHasResults(true)
  }

  const copyToClipboard = async (text, field) => {
    await navigator.clipboard.writeText(text)
    setCopiedField(field)
    setTimeout(() => setCopiedField(null), 2000)
  }

  const copyAll = async () => {
    const allContent = `TITLE:\n${titles[activeTitle]}\n\nBULLET POINTS:\n${bullets.map((b, i) => `${i + 1}. ${b}`).join('\n')}\n\nDESCRIPTION:\n${description}\n\nSEARCH TERMS:\n${searchTerms}`
    await navigator.clipboard.writeText(allContent)
    setCopiedField('all')
    setTimeout(() => setCopiedField(null), 2000)
  }

  return (
    <div className="listing-copywriter">
      <header className="page-header">
        <div>
          <h1>Listing Copywriter</h1>
          <p>Generate optimized titles, bullets, and descriptions with AI</p>
        </div>
      </header>

      {/* Mode Tabs */}
      <div className="mode-tabs">
        <button
          className={`mode-tab ${mode === 'single' ? 'active' : ''}`}
          onClick={() => setMode('single')}
        >
          <FileText size={18} />
          Single ASIN
        </button>
        <button
          className={`mode-tab ${mode === 'bulk' ? 'active' : ''}`}
          onClick={() => setMode('bulk')}
        >
          <Upload size={18} />
          Bulk Mode
        </button>
      </div>

      {mode === 'single' ? (
        <div className="copywriter-layout">
          {/* Input Panel */}
          <div className="input-panel">
            <div className="input-card">
              <h3><Search size={18} /> Product Input</h3>

              <div className="form-group">
                <label>ASIN</label>
                <input
                  type="text"
                  placeholder="Enter ASIN (e.g., B08N5WRWNW)"
                  value={asinValue}
                  onChange={(e) => setAsinValue(e.target.value.toUpperCase())}
                  maxLength={10}
                />
              </div>

              <div className="form-group">
                <label>Marketplace</label>
                <div className="marketplace-grid-small">
                  {MARKETPLACES.map((mp) => (
                    <button
                      key={mp.code}
                      className={`mp-btn ${marketplace === mp.code ? 'selected' : ''}`}
                      onClick={() => setMarketplace(mp.code)}
                    >
                      {mp.flag}
                    </button>
                  ))}
                </div>
              </div>

              <div className="form-group">
                <label><Globe size={16} /> Target Language</label>
                <select
                  value={language}
                  onChange={(e) => setLanguage(e.target.value)}
                >
                  {LANGUAGES.map((lang) => (
                    <option key={lang} value={lang}>{lang}</option>
                  ))}
                </select>
              </div>

              <div className="form-group">
                <label><MessageSquare size={16} /> Tone</label>
                <select
                  value={tone}
                  onChange={(e) => setTone(e.target.value)}
                >
                  {TONES.map((t) => (
                    <option key={t.id} value={t.id}>{t.name} - {t.desc}</option>
                  ))}
                </select>
              </div>

              <div className="form-group">
                <label>Additional Keywords (comma-separated)</label>
                <textarea
                  placeholder="premium, best seller, gift idea..."
                  value={additionalKeywords}
                  onChange={(e) => setAdditionalKeywords(e.target.value)}
                  rows={3}
                />
                <span className="char-count">
                  {additionalKeywords.split(',').filter(k => k.trim()).length} keywords
                </span>
              </div>

              <button
                className="btn btn-primary btn-large"
                onClick={handleGenerate}
                disabled={isGenerating || !asinValue}
              >
                {isGenerating ? (
                  <>
                    <Loader2 size={20} className="spin" />
                    Generating...
                  </>
                ) : (
                  <>
                    <FileText size={20} />
                    Generate Listing Copy
                  </>
                )}
              </button>
            </div>
          </div>

          {/* Results Panel */}
          <div className="results-panel">
            {!hasResults ? (
              <div className="results-empty">
                <FileText size={48} />
                <p>Enter an ASIN and click Generate to create optimized listing copy</p>
              </div>
            ) : (
              <div className="results-content">
                {/* Export Actions */}
                <div className="results-actions">
                  <button
                    className="btn btn-secondary btn-sm"
                    onClick={copyAll}
                  >
                    {copiedField === 'all' ? <Check size={16} /> : <Copy size={16} />}
                    Copy All
                  </button>
                  <button className="btn btn-secondary btn-sm">
                    <Download size={16} />
                    Export
                  </button>
                </div>

                {/* Titles Section */}
                <div className="result-section">
                  <div className="section-header">
                    <h3>Product Title</h3>
                    <div className="title-tabs">
                      {titles.map((_, i) => (
                        <button
                          key={i}
                          className={`title-tab ${activeTitle === i ? 'active' : ''}`}
                          onClick={() => setActiveTitle(i)}
                        >
                          V{i + 1}
                        </button>
                      ))}
                    </div>
                  </div>
                  <div className="title-content">
                    <textarea
                      value={titles[activeTitle]}
                      onChange={(e) => {
                        const newTitles = [...titles]
                        newTitles[activeTitle] = e.target.value
                        setTitles(newTitles)
                      }}
                      rows={3}
                    />
                    <div className="field-footer">
                      <span className={`char-count ${titles[activeTitle]?.length > 200 ? 'warning' : ''}`}>
                        {titles[activeTitle]?.length}/200
                      </span>
                      <div className="field-actions">
                        <button
                          className="icon-btn"
                          onClick={() => copyToClipboard(titles[activeTitle], 'title')}
                        >
                          {copiedField === 'title' ? <Check size={16} /> : <Copy size={16} />}
                        </button>
                        <button className="icon-btn">
                          <RefreshCw size={16} />
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Bullets Section */}
                <div className="result-section">
                  <div className="section-header">
                    <h3>Bullet Points</h3>
                    <button className="btn btn-ghost btn-sm">
                      <RefreshCw size={14} />
                      Regenerate All
                    </button>
                  </div>
                  <div className="bullets-list">
                    {bullets.map((bullet, i) => (
                      <div key={i} className="bullet-item">
                        <div className="bullet-drag">
                          <GripVertical size={16} />
                        </div>
                        <div className="bullet-number">{i + 1}</div>
                        <div className="bullet-content">
                          <textarea
                            value={bullet}
                            onChange={(e) => {
                              const newBullets = [...bullets]
                              newBullets[i] = e.target.value
                              setBullets(newBullets)
                            }}
                            rows={2}
                          />
                          <div className="field-footer">
                            <span className={`char-count ${bullet.length > 500 ? 'warning' : ''}`}>
                              {bullet.length}/500
                            </span>
                            <div className="field-actions">
                              <button
                                className="icon-btn"
                                onClick={() => copyToClipboard(bullet, `bullet-${i}`)}
                              >
                                {copiedField === `bullet-${i}` ? <Check size={16} /> : <Copy size={16} />}
                              </button>
                              <button className="icon-btn">
                                <RefreshCw size={16} />
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>

                {/* Description Section */}
                <div className="result-section">
                  <div className="section-header">
                    <h3>Product Description</h3>
                    <button className="btn btn-ghost btn-sm">
                      <RefreshCw size={14} />
                      Regenerate
                    </button>
                  </div>
                  <div className="description-content">
                    <textarea
                      value={description}
                      onChange={(e) => setDescription(e.target.value)}
                      rows={8}
                    />
                    <div className="field-footer">
                      <span className={`char-count ${description.length > 2000 ? 'warning' : ''}`}>
                        {description.length}/2000
                      </span>
                      <div className="field-actions">
                        <button
                          className="icon-btn"
                          onClick={() => copyToClipboard(description, 'description')}
                        >
                          {copiedField === 'description' ? <Check size={16} /> : <Copy size={16} />}
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Search Terms Section */}
                <div className="result-section">
                  <div className="section-header">
                    <h3>Search Terms</h3>
                    <button className="btn btn-ghost btn-sm">
                      Optimize
                    </button>
                  </div>
                  <div className="search-terms-content">
                    <textarea
                      value={searchTerms}
                      onChange={(e) => setSearchTerms(e.target.value)}
                      rows={3}
                    />
                    <div className="field-footer">
                      <span className={`char-count ${new Blob([searchTerms]).size > 250 ? 'warning' : ''}`}>
                        <AlertCircle size={14} />
                        {new Blob([searchTerms]).size}/250 bytes
                      </span>
                      <div className="field-actions">
                        <button
                          className="icon-btn"
                          onClick={() => copyToClipboard(searchTerms, 'search')}
                        >
                          {copiedField === 'search' ? <Check size={16} /> : <Copy size={16} />}
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      ) : (
        /* Bulk Mode */
        <div className="bulk-mode">
          <div className="bulk-upload">
            <div className="upload-zone">
              <Upload size={48} />
              <h3>Upload CSV File</h3>
              <p>Drag and drop your CSV file or click to browse</p>
              <button className="btn btn-secondary">
                Download Template
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  )
}

export default ListingCopywriter

--- END OF FILE ---

--- FILE: src/pages/BrandStory.jsx ---
import { useState, useCallback, useEffect } from 'react'
import { PRODUCT_CATEGORIES } from '../constants/productCategories'
import {
  Upload,
  Search,
  Image,
  LayoutGrid,
  Plus,
  Trash2,
  GripVertical,
  Eye,
  EyeOff,
  ChevronDown,
  ChevronUp,
  Check,
  X,
  Info,
  Loader2,
  Download,
  Save,
  Sparkles,
  Wand2,
  RefreshCw,
  FileText,
  ShoppingBag,
  Lock
} from 'lucide-react'

// Brand Story Module Definitions
const BRAND_STORY_MODULES = [
  {
    id: 'carousel-background',
    name: 'Brand Carousel Background',
    description: 'Mandatory background image with headline and body text',
    dimensions: '1464 x 625 px',
    width: 1464,
    height: 625,
    hasText: true,
    textFields: ['headline', 'body'],
    headlineLimit: 30,
    bodyLimit: 135,
    category: 'background',
    preview: '🎠',
    isMandatory: true
  },
  {
    id: 'focus-image',
    name: 'Brand Focus Image',
    description: 'Visual image showcasing brand creator or product line',
    dimensions: '362 x 453 px',
    width: 362,
    height: 453,
    hasText: true,
    textFields: ['headline'],
    headlineLimit: 30,
    category: 'visual',
    preview: '📸'
  },
  {
    id: 'logo-description',
    name: 'Brand Logo & Description',
    description: 'Brand logo with detailed description text',
    dimensions: '315 x 145 px',
    width: 315,
    height: 145,
    hasText: true,
    textFields: ['body'],
    bodyLimit: 450,
    category: 'branding',
    preview: '🏷️'
  },
  {
    id: 'asin-showcase',
    name: 'Brand ASIN & Store Showcase',
    description: 'Showcase up to 4 products with ASINs',
    dimensions: '166 x 182 px each',
    width: 166,
    height: 182,
    imageCount: 4,
    hasText: true,
    textFields: ['headline'],
    headlineLimit: 30,
    category: 'products',
    preview: '🛍️',
    isAsinShowcase: true
  },
  {
    id: 'brand-qa',
    name: 'Brand Q&A',
    description: 'Interactive FAQ section with 3 Q&A pairs',
    dimensions: 'Text only',
    width: 0,
    height: 0,
    hasText: true,
    textOnly: true,
    textFields: ['qa'],
    qaLimit: 750,
    qaCount: 3,
    category: 'text',
    preview: '❓',
    isQA: true
  }
]

const BRAND_STORY_GUIDELINES = [
  { icon: '✓', text: 'Use high-resolution brand images (min 72 DPI)' },
  { icon: '✓', text: 'Tell your brand\'s origin story authentically' },
  { icon: '✓', text: 'Highlight brand values and mission' },
  { icon: '✓', text: 'Use consistent brand colors and fonts' },
  { icon: '✓', text: 'Include your brand logo in the Logo module' },
  { icon: '✓', text: 'Showcase best-selling products in ASIN module' },
  { icon: '✓', text: 'Keep text concise — customers scan, not read' },
  { icon: '✓', text: 'Use 3-5 cards for maximum impact (up to 19 allowed)' },
  { icon: '✗', text: 'No pricing or promotional claims' },
  { icon: '✗', text: 'No time-sensitive information (sales, limited offers)' },
  { icon: '✗', text: 'No external URLs or contact information' },
  { icon: '✗', text: 'No competitor references or comparisons' },
  { icon: '✗', text: 'No unverified superlatives ("best", "#1")' },
  { icon: '✗', text: 'No customer reviews or testimonials' }
]

// Mock Creative Campaign Data
const CREATIVE_CAMPAIGN_DATA = {
  productName: 'Premium Wireless Headphones',
  brandName: 'AudioPro',
  brandStory: 'Founded in 2018 by audio engineers passionate about perfect sound',
  brandMission: 'Making premium audio accessible to everyone',
  brandValues: ['Innovation', 'Quality', 'Sustainability', 'Customer First'],
  targetAudience: 'Tech-savvy professionals aged 25-45',
  keyBenefits: [
    'Active noise cancellation',
    '40-hour battery life',
    'Premium comfort memory foam',
    'Crystal clear audio quality'
  ],
  topProducts: [
    'Pro X1 Over-Ear',
    'Sport Buds Elite',
    'Studio Monitor Pro',
    'Travel Companion'
  ],
  emotionalTriggers: [
    'Focus and productivity',
    'Premium quality and status',
    'Comfort and relaxation'
  ],
  toneOfVoice: 'Professional, confident, premium',
  keywords: ['wireless', 'noise-cancelling', 'premium', 'comfort', 'professional']
}

// Generate AI prompt templates for Brand Story modules
const generateBrandStoryPrompt = (moduleType, campaignData = CREATIVE_CAMPAIGN_DATA) => {
  const prompts = {
    'carousel-background': `Create a stunning brand story carousel background for ${campaignData.brandName}.
Brand Story: ${campaignData.brandStory}
Mission: ${campaignData.brandMission}
Style: Cinematic, premium, brand-defining
Mood: Aspirational, trustworthy, authentic
Include: Brand essence imagery, lifestyle context, subtle product presence
Target: ${campaignData.targetAudience}
Tone: ${campaignData.toneOfVoice}
Note: This is the hero background image — must be visually striking
Dimensions: 1464x625 pixels (full-width carousel background)`,

    'focus-image': `Create a brand focus image for ${campaignData.brandName}.
Purpose: Showcase the brand creator, team, or defining product line
Brand Story: ${campaignData.brandStory}
Values: ${campaignData.brandValues.join(', ')}
Style: Authentic, personal, premium quality
Show: The people or craftsmanship behind the brand
Emotional appeal: ${campaignData.emotionalTriggers[0]}
Target: ${campaignData.targetAudience}
Dimensions: 362x453 pixels (portrait format)`,

    'logo-description': `Create a professional brand logo display for ${campaignData.brandName}.
Style: Clean, professional, brand-consistent
Background: White or transparent
Requirements:
- High resolution logo centered
- Adequate padding around logo
- Horizontal/landscape format
- Consistent with brand identity
Brand values: ${campaignData.brandValues.join(', ')}
Dimensions: 315x145 pixels (landscape logo format)`,

    'asin-showcase': `Create 4 product showcase images for ${campaignData.brandName}'s top products:
${campaignData.topProducts.map((p, i) => `Product ${i + 1}: ${p}`).join('\n')}
Style: Clean product photography, white background
Purpose: Cross-sell and drive traffic to other listings
Each image: Professional, consistent lighting, product-focused
Target: ${campaignData.targetAudience}
Dimensions: 166x182 pixels each (small product thumbnails)`,

    'brand-qa': `Write Brand Q&A content for ${campaignData.brandName}.
Brand: ${campaignData.brandName}
Tone: ${campaignData.toneOfVoice}

Suggested Q&A pairs:
Q1: "What makes ${campaignData.brandName} different?"
A1: Focus on ${campaignData.brandValues[0]} and ${campaignData.brandValues[1]}

Q2: "What is ${campaignData.brandName}'s mission?"
A2: ${campaignData.brandMission}

Q3: "Who are ${campaignData.brandName} products designed for?"
A3: ${campaignData.targetAudience}

Style: Helpful, authoritative, brand-consistent
Total character limit: 750 characters for all Q&A combined
Note: No pricing, no superlatives, no competitor mentions`
  }

  return prompts[moduleType] || `Create professional brand story content for ${campaignData.brandName}.
Brand: ${campaignData.brandName}
Target: ${campaignData.targetAudience}
Style: Premium, authentic, brand-consistent`
}

function BrandStory() {
  // Module management
  const [selectedModules, setSelectedModules] = useState([])
  const [moduleData, setModuleData] = useState({})
  const [draggedIndex, setDraggedIndex] = useState(null)

  // UI state
  const [expandedModule, setExpandedModule] = useState(null)
  const [previewMode, setPreviewMode] = useState(false)
  const [showGuidelines, setShowGuidelines] = useState(false)
  const [isGenerating, setIsGenerating] = useState(false)
  const [asinValue, setAsinValue] = useState('')
  const [productCategory, setProductCategory] = useState('')

  // Validation
  const isValidASIN = (asin) => /^[A-Z0-9]{10}$/i.test(asin)
  const maxModules = 19
  const canAddModule = selectedModules.length < maxModules
  const hasMinModules = selectedModules.length >= 1

  // Auto-add mandatory Carousel Background on mount
  useEffect(() => {
    if (selectedModules.length === 0) {
      const bgModule = BRAND_STORY_MODULES.find(m => m.id === 'carousel-background')
      const newModule = {
        instanceId: `carousel-background-${Date.now()}`,
        type: 'carousel-background',
        ...bgModule
      }
      setSelectedModules([newModule])
      setModuleData({
        [newModule.instanceId]: {
          referenceImage: null,
          aiPrompt: generateBrandStoryPrompt('carousel-background'),
          images: [],
          headline: '',
          body: '',
          qaItems: [
            { question: '', answer: '' },
            { question: '', answer: '' },
            { question: '', answer: '' }
          ],
          asins: ['', '', '', '']
        }
      })
      setExpandedModule(newModule.instanceId)
    }
  }, [])

  // Add module
  const addModule = (moduleType) => {
    if (!canAddModule) return

    const moduleDefinition = BRAND_STORY_MODULES.find(m => m.id === moduleType)
    if (!moduleDefinition) return

    const newModule = {
      instanceId: `${moduleType}-${Date.now()}`,
      type: moduleType,
      ...moduleDefinition
    }

    setSelectedModules(prev => [...prev, newModule])
    setModuleData(prev => ({
      ...prev,
      [newModule.instanceId]: {
        referenceImage: null,
        aiPrompt: generateBrandStoryPrompt(moduleType),
        images: [],
        headline: '',
        body: '',
        qaItems: [
          { question: '', answer: '' },
          { question: '', answer: '' },
          { question: '', answer: '' }
        ],
        asins: ['', '', '', '']
      }
    }))
    setExpandedModule(newModule.instanceId)
  }

  // Remove module (prevent removing mandatory carousel background if it's the only one)
  const removeModule = (instanceId) => {
    const module = selectedModules.find(m => m.instanceId === instanceId)
    if (module?.isMandatory && selectedModules.filter(m => m.type === 'carousel-background').length <= 1) {
      return // Cannot remove the only carousel background
    }

    setSelectedModules(prev => prev.filter(m => m.instanceId !== instanceId))
    setModuleData(prev => {
      const updated = { ...prev }
      delete updated[instanceId]
      return updated
    })
    if (expandedModule === instanceId) {
      setExpandedModule(null)
    }
  }

  // Drag and drop
  const handleDragStart = (index) => setDraggedIndex(index)

  const handleDragOver = (e, index) => {
    e.preventDefault()
    if (draggedIndex === null || draggedIndex === index) return

    const newModules = [...selectedModules]
    const draggedModule = newModules[draggedIndex]
    newModules.splice(draggedIndex, 1)
    newModules.splice(index, 0, draggedModule)

    setSelectedModules(newModules)
    setDraggedIndex(index)
  }

  const handleDragEnd = () => setDraggedIndex(null)

  // Move module
  const moveModule = (index, direction) => {
    const newIndex = direction === 'up' ? index - 1 : index + 1
    if (newIndex < 0 || newIndex >= selectedModules.length) return

    const newModules = [...selectedModules]
    const temp = newModules[index]
    newModules[index] = newModules[newIndex]
    newModules[newIndex] = temp
    setSelectedModules(newModules)
  }

  // Update module data
  const updateModuleData = (instanceId, field, value) => {
    setModuleData(prev => ({
      ...prev,
      [instanceId]: {
        ...prev[instanceId],
        [field]: value
      }
    }))
  }

  // Handle reference image upload
  const handleReferenceImageUpload = useCallback((instanceId, e) => {
    const file = e.target?.files?.[0]
    if (!file || !file.type.startsWith('image/')) return

    if (file.size > 10 * 1024 * 1024) {
      alert('Reference image must be less than 10MB')
      return
    }

    const reader = new FileReader()
    reader.onload = (e) => {
      setModuleData(prev => ({
        ...prev,
        [instanceId]: {
          ...prev[instanceId],
          referenceImage: {
            file,
            preview: e.target.result,
            name: file.name
          }
        }
      }))
    }
    reader.readAsDataURL(file)
  }, [])

  // Handle output image upload
  const handleModuleImageUpload = useCallback((instanceId, imageIndex, e) => {
    const file = e.target?.files?.[0]
    if (!file || !file.type.startsWith('image/')) return

    if (file.size > 2 * 1024 * 1024) {
      alert('Image must be less than 2MB')
      return
    }

    const reader = new FileReader()
    reader.onload = (e) => {
      setModuleData(prev => {
        const currentImages = prev[instanceId]?.images || []
        const newImages = [...currentImages]
        newImages[imageIndex] = {
          file,
          preview: e.target.result,
          name: file.name
        }
        return {
          ...prev,
          [instanceId]: {
            ...prev[instanceId],
            images: newImages
          }
        }
      })
    }
    reader.readAsDataURL(file)
  }, [])

  // Generate AI content
  const generateModuleContent = async (instanceId) => {
    setIsGenerating(true)
    await new Promise(resolve => setTimeout(resolve, 1500))

    const module = selectedModules.find(m => m.instanceId === instanceId)

    if (module?.type === 'brand-qa') {
      updateModuleData(instanceId, 'qaItems', [
        { question: `What makes ${CREATIVE_CAMPAIGN_DATA.brandName} different?`, answer: `We combine ${CREATIVE_CAMPAIGN_DATA.brandValues[0].toLowerCase()} with ${CREATIVE_CAMPAIGN_DATA.brandValues[1].toLowerCase()} to deliver exceptional products.` },
        { question: `What is ${CREATIVE_CAMPAIGN_DATA.brandName}'s mission?`, answer: CREATIVE_CAMPAIGN_DATA.brandMission },
        { question: `Who are ${CREATIVE_CAMPAIGN_DATA.brandName} products for?`, answer: CREATIVE_CAMPAIGN_DATA.targetAudience }
      ])
    } else {
      updateModuleData(instanceId, 'headline', `${CREATIVE_CAMPAIGN_DATA.brandName} — ${CREATIVE_CAMPAIGN_DATA.brandValues[0]}`)
      updateModuleData(instanceId, 'body', CREATIVE_CAMPAIGN_DATA.brandStory)
    }

    setIsGenerating(false)
  }

  // Regenerate prompt
  const regeneratePrompt = (instanceId, moduleType) => {
    updateModuleData(instanceId, 'aiPrompt', generateBrandStoryPrompt(moduleType))
  }

  // Get total Q&A characters
  const getQACharCount = (qaItems) => {
    if (!qaItems) return 0
    return qaItems.reduce((total, item) => total + (item.question?.length || 0) + (item.answer?.length || 0), 0)
  }

  // Render module editor
  const renderModuleEditor = (module) => {
    const data = moduleData[module.instanceId] || {}
    const imageCount = module.imageCount || 1

    return (
      <div className="module-editor">
        {/* Reference Image Upload */}
        <div className="reference-image-section">
          <label className="module-label">
            <Image size={16} />
            Reference Image
            <span className="label-hint">(Your brand photo for AI to use)</span>
          </label>
          <div className="reference-image-upload-area">
            {data.referenceImage ? (
              <div className="reference-image-preview">
                <img src={data.referenceImage.preview} alt="Reference" />
                <div className="reference-image-info">
                  <span className="reference-image-name">{data.referenceImage.name}</span>
                  <button
                    className="btn btn-sm btn-ghost"
                    onClick={() => updateModuleData(module.instanceId, 'referenceImage', null)}
                  >
                    <X size={14} />
                    Remove
                  </button>
                </div>
              </div>
            ) : (
              <label className="reference-image-dropzone">
                <input
                  type="file"
                  accept="image/*"
                  onChange={(e) => handleReferenceImageUpload(module.instanceId, e)}
                  style={{ display: 'none' }}
                />
                <Upload size={24} />
                <span className="dropzone-title">Upload Reference Image</span>
                <span className="dropzone-hint">JPG, PNG, WebP (Max 10MB)</span>
              </label>
            )}
          </div>
        </div>

        {/* AI Prompt Section */}
        <div className="ai-prompt-section">
          <div className="ai-prompt-header">
            <label className="module-label">
              <Wand2 size={16} />
              AI Generation Prompt
              <span className="label-hint">(Auto-generated from Creative Campaign)</span>
            </label>
            <div className="ai-prompt-actions">
              <button
                className="btn btn-sm btn-ghost"
                onClick={() => regeneratePrompt(module.instanceId, module.id)}
                title="Regenerate prompt from campaign data"
              >
                <RefreshCw size={14} />
                Reset
              </button>
            </div>
          </div>
          <div className="ai-prompt-textarea-wrapper">
            <textarea
              className="ai-prompt-textarea"
              value={data.aiPrompt || ''}
              onChange={(e) => updateModuleData(module.instanceId, 'aiPrompt', e.target.value)}
              placeholder="Enter your AI generation prompt here..."
              rows={8}
            />
            <div className="ai-prompt-footer">
              <span className="char-count">{(data.aiPrompt || '').length} characters</span>
              <div className="ai-prompt-tags">
                <span className="prompt-tag">
                  <FileText size={12} />
                  Based on Campaign Data
                </span>
              </div>
            </div>
          </div>
          <button
            className="btn btn-primary btn-generate-images"
            disabled={isGenerating || !data.referenceImage}
            onClick={() => generateModuleContent(module.instanceId)}
          >
            {isGenerating ? (
              <>
                <Loader2 size={16} className="spin" />
                Generating...
              </>
            ) : (
              <>
                <Sparkles size={16} />
                Generate with AI
              </>
            )}
          </button>
          {!data.referenceImage && (
            <p className="ai-prompt-hint">Upload a reference image first to enable AI generation</p>
          )}
        </div>

        {/* Output Images (not for text-only modules) */}
        {!module.textOnly && !module.isAsinShowcase && (
          <div className="module-images">
            <label className="module-label">
              Output Images <span className="dim">({module.dimensions})</span>
              <span className="label-hint">— AI generated or manually upload</span>
            </label>
            <div className={`module-image-grid images-${imageCount}`}>
              {Array.from({ length: imageCount }).map((_, idx) => (
                <div
                  key={idx}
                  className="module-image-slot"
                  style={{ aspectRatio: `${module.width}/${module.height}` }}
                >
                  {data.images?.[idx] ? (
                    <div className="module-image-preview">
                      <img src={data.images[idx].preview} alt={`Image ${idx + 1}`} />
                      <button
                        className="remove-image-btn"
                        onClick={() => {
                          const newImages = [...(data.images || [])]
                          newImages[idx] = null
                          updateModuleData(module.instanceId, 'images', newImages)
                        }}
                      >
                        <X size={14} />
                      </button>
                    </div>
                  ) : (
                    <label className="module-image-upload">
                      <input
                        type="file"
                        accept="image/*"
                        onChange={(e) => handleModuleImageUpload(module.instanceId, idx, e)}
                        style={{ display: 'none' }}
                      />
                      <Upload size={20} />
                      <span>{module.width}x{module.height}</span>
                    </label>
                  )}
                </div>
              ))}
            </div>
          </div>
        )}

        {/* ASIN Showcase Special Editor */}
        {module.isAsinShowcase && (
          <div className="asin-showcase-editor">
            <label className="module-label">
              <ShoppingBag size={16} />
              Product Showcase (up to 4 ASINs)
            </label>
            <div className="asin-showcase-grid">
              {Array.from({ length: 4 }).map((_, idx) => (
                <div key={idx} className="asin-showcase-item">
                  <div
                    className="asin-showcase-image"
                    style={{ aspectRatio: `${module.width}/${module.height}` }}
                  >
                    {data.images?.[idx] ? (
                      <div className="module-image-preview">
                        <img src={data.images[idx].preview} alt={`Product ${idx + 1}`} />
                        <button
                          className="remove-image-btn"
                          onClick={() => {
                            const newImages = [...(data.images || [])]
                            newImages[idx] = null
                            updateModuleData(module.instanceId, 'images', newImages)
                          }}
                        >
                          <X size={14} />
                        </button>
                      </div>
                    ) : (
                      <label className="module-image-upload">
                        <input
                          type="file"
                          accept="image/*"
                          onChange={(e) => handleModuleImageUpload(module.instanceId, idx, e)}
                          style={{ display: 'none' }}
                        />
                        <Upload size={16} />
                        <span className="upload-size-sm">166x182</span>
                      </label>
                    )}
                  </div>
                  <input
                    type="text"
                    className="asin-input-field"
                    placeholder={`ASIN ${idx + 1} (e.g., B09XYZ1234)`}
                    value={data.asins?.[idx] || ''}
                    onChange={(e) => {
                      const newAsins = [...(data.asins || ['', '', '', ''])]
                      newAsins[idx] = e.target.value.toUpperCase()
                      updateModuleData(module.instanceId, 'asins', newAsins)
                    }}
                    maxLength={10}
                  />
                  {data.asins?.[idx] && (
                    <span className={`asin-validation ${isValidASIN(data.asins[idx]) ? 'valid' : 'invalid'}`}>
                      {isValidASIN(data.asins[idx]) ? <Check size={12} /> : <X size={12} />}
                      {isValidASIN(data.asins[idx]) ? 'Valid' : 'Invalid'}
                    </span>
                  )}
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Q&A Module Special Editor */}
        {module.isQA && (
          <div className="qa-editor">
            <label className="module-label">
              Q&A Pairs (3 questions)
              <span className="label-hint">— Total limit: 750 characters</span>
            </label>
            <div className="qa-pairs">
              {(data.qaItems || []).map((item, idx) => (
                <div key={idx} className="qa-pair">
                  <div className="qa-pair-header">
                    <span className="qa-number">Q{idx + 1}</span>
                  </div>
                  <input
                    type="text"
                    className="qa-question-input"
                    placeholder={`Question ${idx + 1}...`}
                    value={item.question || ''}
                    onChange={(e) => {
                      const newQA = [...(data.qaItems || [])]
                      newQA[idx] = { ...newQA[idx], question: e.target.value }
                      updateModuleData(module.instanceId, 'qaItems', newQA)
                    }}
                  />
                  <textarea
                    className="qa-answer-input"
                    placeholder={`Answer ${idx + 1}...`}
                    value={item.answer || ''}
                    onChange={(e) => {
                      const newQA = [...(data.qaItems || [])]
                      newQA[idx] = { ...newQA[idx], answer: e.target.value }
                      updateModuleData(module.instanceId, 'qaItems', newQA)
                    }}
                    rows={3}
                  />
                </div>
              ))}
            </div>
            <div className="qa-char-counter">
              <span className={`char-count ${getQACharCount(data.qaItems) > 750 ? 'over-limit' : ''}`}>
                {getQACharCount(data.qaItems)}/750 characters
              </span>
              {getQACharCount(data.qaItems) > 750 && (
                <span className="char-warning">Over character limit!</span>
              )}
            </div>
            <button
              className="btn btn-secondary btn-sm ai-generate-btn"
              onClick={() => generateModuleContent(module.instanceId)}
              disabled={isGenerating}
            >
              {isGenerating ? <Loader2 size={16} className="spin" /> : <Sparkles size={16} />}
              AI Generate Q&A
            </button>
          </div>
        )}

        {/* Standard Text Fields (headline/body) */}
        {module.hasText && !module.isQA && !module.isAsinShowcase && (
          <div className="module-text-fields">
            {module.textFields?.includes('headline') && (
              <div className="module-field">
                <label className="module-label">Headline</label>
                <input
                  type="text"
                  placeholder="Enter headline..."
                  value={data.headline || ''}
                  onChange={(e) => updateModuleData(module.instanceId, 'headline', e.target.value)}
                  maxLength={module.headlineLimit || 30}
                />
                <span className="char-count">{(data.headline || '').length}/{module.headlineLimit || 30}</span>
              </div>
            )}

            {module.textFields?.includes('body') && (
              <div className="module-field">
                <label className="module-label">Body Text</label>
                <textarea
                  placeholder="Enter body text..."
                  value={data.body || ''}
                  onChange={(e) => updateModuleData(module.instanceId, 'body', e.target.value)}
                  maxLength={module.bodyLimit || 135}
                  rows={module.bodyLimit > 200 ? 6 : 3}
                />
                <span className="char-count">{(data.body || '').length}/{module.bodyLimit || 135}</span>
              </div>
            )}

            {/* ASIN Showcase headline */}
            {module.isAsinShowcase && module.textFields?.includes('headline') && (
              <div className="module-field">
                <label className="module-label">Showcase Headline</label>
                <input
                  type="text"
                  placeholder="e.g., Our Best Sellers"
                  value={data.headline || ''}
                  onChange={(e) => updateModuleData(module.instanceId, 'headline', e.target.value)}
                  maxLength={30}
                />
                <span className="char-count">{(data.headline || '').length}/30</span>
              </div>
            )}

            <button
              className="btn btn-secondary btn-sm ai-generate-btn"
              onClick={() => generateModuleContent(module.instanceId)}
              disabled={isGenerating}
            >
              {isGenerating ? <Loader2 size={16} className="spin" /> : <Sparkles size={16} />}
              AI Generate Content
            </button>
          </div>
        )}

        {/* ASIN Showcase Headline (separate since it has isAsinShowcase flag) */}
        {module.isAsinShowcase && (
          <div className="module-text-fields">
            <div className="module-field">
              <label className="module-label">Showcase Headline</label>
              <input
                type="text"
                placeholder="e.g., Our Best Sellers"
                value={data.headline || ''}
                onChange={(e) => updateModuleData(module.instanceId, 'headline', e.target.value)}
                maxLength={30}
              />
              <span className="char-count">{(data.headline || '').length}/30</span>
            </div>
          </div>
        )}
      </div>
    )
  }

  // Render module preview
  const renderModulePreview = (module) => {
    const data = moduleData[module.instanceId] || {}

    if (module.isQA) {
      return (
        <div className="brand-preview-card brand-preview-qa">
          <h4 className="preview-card-title">Q&A</h4>
          {(data.qaItems || []).map((item, idx) => (
            item.question && (
              <div key={idx} className="preview-qa-item">
                <strong>Q: {item.question}</strong>
                <p>A: {item.answer || '...'}</p>
              </div>
            )
          ))}
        </div>
      )
    }

    if (module.isAsinShowcase) {
      return (
        <div className="brand-preview-card brand-preview-asin">
          {data.headline && <h4 className="preview-card-title">{data.headline}</h4>}
          <div className="preview-asin-grid">
            {Array.from({ length: 4 }).map((_, idx) => (
              <div key={idx} className="preview-asin-item">
                {data.images?.[idx] ? (
                  <img src={data.images[idx].preview} alt={`Product ${idx + 1}`} />
                ) : (
                  <div className="preview-placeholder-sm">
                    <ShoppingBag size={16} />
                  </div>
                )}
                {data.asins?.[idx] && <span className="preview-asin-label">{data.asins[idx]}</span>}
              </div>
            ))}
          </div>
        </div>
      )
    }

    if (module.type === 'carousel-background') {
      return (
        <div className="brand-preview-card brand-preview-bg">
          {data.images?.[0] ? (
            <img src={data.images[0].preview} alt="Background" className="preview-bg-image" />
          ) : (
            <div className="preview-bg-placeholder">
              <Image size={32} />
              <span>1464 x 625</span>
            </div>
          )}
          <div className="preview-bg-overlay">
            <h3>{data.headline || 'Brand Headline'}</h3>
            <p>{data.body || 'Brand story text...'}</p>
          </div>
        </div>
      )
    }

    return (
      <div className="brand-preview-card">
        {data.images?.[0] ? (
          <img src={data.images[0].preview} alt="Preview" />
        ) : (
          <div className="preview-placeholder">
            <Image size={24} />
            <span>{module.dimensions}</span>
          </div>
        )}
        {module.hasText && (
          <div className="preview-text">
            {data.headline && <h4>{data.headline}</h4>}
            {data.body && <p>{data.body}</p>}
          </div>
        )}
      </div>
    )
  }

  return (
    <div className="aplus-content-page aplus-layout-vertical brand-story-page">
      {/* Top Toolbar */}
      <div className="aplus-toolbar">
        <div className="toolbar-row toolbar-main">
          <div className="toolbar-left">
            <h1>Brand Story Creator</h1>
            <span className="brand-story-badge">Carousel Format</span>
          </div>
          <div className="toolbar-center">
            <select
              className="category-dropdown"
              value={productCategory}
              onChange={(e) => setProductCategory(e.target.value)}
            >
              <option value="">Product Category</option>
              {PRODUCT_CATEGORIES.map(cat => (
                <option key={cat} value={cat}>{cat}</option>
              ))}
            </select>
            <div className="asin-input-compact">
              <Search size={16} />
              <input
                type="text"
                placeholder="Enter ASIN"
                value={asinValue}
                onChange={(e) => setAsinValue(e.target.value.toUpperCase())}
                maxLength={10}
              />
              {asinValue && (
                <span className={`asin-status ${isValidASIN(asinValue) ? 'valid' : 'invalid'}`}>
                  {isValidASIN(asinValue) ? <Check size={14} /> : <X size={14} />}
                </span>
              )}
            </div>
            <span className="module-counter-badge">
              {selectedModules.length}/{maxModules} modules
            </span>
          </div>
          <div className="toolbar-right">
            <button
              className={`btn btn-sm ${previewMode ? 'btn-primary' : 'btn-secondary'}`}
              onClick={() => setPreviewMode(!previewMode)}
            >
              {previewMode ? <EyeOff size={16} /> : <Eye size={16} />}
              {previewMode ? 'Edit' : 'Preview'}
            </button>
            <button className="btn btn-sm btn-secondary" disabled={selectedModules.length === 0}>
              <Save size={16} />
              Save
            </button>
            <button className="btn btn-sm btn-primary" disabled={!hasMinModules}>
              <Download size={16} />
              Export
            </button>
            {/* Guidelines */}
            <div className="guidelines-dropdown">
              <button
                className={`btn-icon-circle ${showGuidelines ? 'active' : ''}`}
                onClick={() => setShowGuidelines(!showGuidelines)}
                title="Brand Story Guidelines"
              >
                <Info size={18} />
              </button>
              {showGuidelines && (
                <div className="guidelines-popup">
                  <div className="guidelines-popup-header">
                    <h4>Brand Story Guidelines</h4>
                    <button className="popup-close" onClick={() => setShowGuidelines(false)}>
                      <X size={16} />
                    </button>
                  </div>
                  <div className="guidelines-popup-content">
                    {BRAND_STORY_GUIDELINES.map((guideline, idx) => (
                      <div
                        key={idx}
                        className={`guideline-row ${guideline.icon === '✓' ? 'do' : 'dont'}`}
                      >
                        <span className="guideline-icon">{guideline.icon}</span>
                        <span>{guideline.text}</span>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>
          </div>
        </div>

        {/* Module Library Row */}
        <div className="toolbar-row toolbar-modules">
          <div className="modules-scroll">
            {BRAND_STORY_MODULES.map(module => (
              <button
                key={module.id}
                className={`module-chip ${!canAddModule ? 'disabled' : ''} ${module.isMandatory ? 'mandatory' : ''}`}
                onClick={() => canAddModule && addModule(module.id)}
                disabled={!canAddModule}
                title={`${module.name} (${module.dimensions})${module.isMandatory ? ' — Mandatory' : ''}`}
              >
                <span className="chip-icon">{module.preview}</span>
                <span className="chip-name">{module.name}</span>
                <span className="chip-size">{module.dimensions}</span>
                {module.isMandatory ? (
                  <Lock size={14} className="chip-lock" />
                ) : (
                  <Plus size={14} className="chip-add" />
                )}
              </button>
            ))}
          </div>
        </div>
      </div>

      {/* Content Builder */}
      <div className="aplus-content-area">
        {previewMode ? (
          <div className="brand-story-preview">
            <div className="brand-story-preview-header">
              <h3>Brand Story Preview</h3>
              <p>Scroll horizontally to see all cards as they appear on Amazon</p>
            </div>
            <div className="brand-story-carousel">
              {selectedModules.map(module => (
                <div key={module.instanceId} className={`brand-carousel-card card-${module.type}`}>
                  {renderModulePreview(module)}
                </div>
              ))}
            </div>
          </div>
        ) : (
          <div className="modules-container-full">
            {selectedModules.map((module, index) => (
              <div
                key={module.instanceId}
                className={`module-item-full ${draggedIndex === index ? 'dragging' : ''} ${expandedModule === module.instanceId ? 'expanded' : ''}`}
                draggable
                onDragStart={() => handleDragStart(index)}
                onDragOver={(e) => handleDragOver(e, index)}
                onDragEnd={handleDragEnd}
              >
                <div className="module-header-full">
                  <div className="module-drag-handle">
                    <GripVertical size={18} />
                  </div>
                  <span className="module-number">{index + 1}</span>
                  <span className="module-icon-lg">{module.preview}</span>
                  <div className="module-title-info">
                    <span className="module-name-lg">
                      {module.name}
                      {module.isMandatory && <span className="mandatory-tag">Required</span>}
                    </span>
                    <span className="module-dims">{module.dimensions}</span>
                  </div>
                  <div className="module-actions-full">
                    <button
                      className="btn-icon-sm"
                      onClick={() => moveModule(index, 'up')}
                      disabled={index === 0}
                      title="Move up"
                    >
                      <ChevronUp size={18} />
                    </button>
                    <button
                      className="btn-icon-sm"
                      onClick={() => moveModule(index, 'down')}
                      disabled={index === selectedModules.length - 1}
                      title="Move down"
                    >
                      <ChevronDown size={18} />
                    </button>
                    <button
                      className="btn-icon-sm expand-btn"
                      onClick={() => setExpandedModule(
                        expandedModule === module.instanceId ? null : module.instanceId
                      )}
                      title={expandedModule === module.instanceId ? 'Collapse' : 'Expand'}
                    >
                      {expandedModule === module.instanceId ? (
                        <ChevronUp size={18} />
                      ) : (
                        <ChevronDown size={18} />
                      )}
                    </button>
                    <button
                      className="btn-icon-sm delete-btn"
                      onClick={() => removeModule(module.instanceId)}
                      title={module.isMandatory ? 'Cannot remove mandatory module' : 'Remove module'}
                      disabled={module.isMandatory && selectedModules.filter(m => m.type === 'carousel-background').length <= 1}
                    >
                      <Trash2 size={18} />
                    </button>
                  </div>
                </div>

                {expandedModule === module.instanceId && (
                  <div className="module-content-full">
                    {renderModuleEditor(module)}
                  </div>
                )}
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  )
}

export default BrandStory

--- END OF FILE ---

--- FILE: src/pages/Dashboard.jsx ---
import { Link } from 'react-router-dom'
import {
  Image,
  Lightbulb,
  FileText,
  TrendingUp,
  Clock,
  Star,
  ArrowRight,
  Zap
} from 'lucide-react'

const tools = [
  {
    name: 'Main Image Generator',
    description: 'Generate professional Amazon product images with AI. Choose from 30+ templates.',
    href: '/tools/main-image-generator',
    icon: Image,
    color: '#3B82F6',
    features: ['30+ Templates', 'Multiple AI Models', 'Batch Generation']
  },
  {
    name: 'Creative Campaigns',
    description: 'Deep market intelligence and automated creative briefs based on customer insights.',
    href: '/tools/creative-campaigns',
    icon: Lightbulb,
    color: '#8B5CF6',
    features: ['Market Analysis', 'Customer Avatars', 'AI Briefs']
  },
  {
    name: 'Listing Copywriter',
    description: 'Generate optimized titles, bullets, and descriptions in 20+ languages.',
    href: '/tools/listing-copywriter',
    icon: FileText,
    color: '#10B981',
    features: ['20+ Languages', '14 Tones', 'SEO Optimized']
  }
]

const recentProjects = [
  { id: 1, name: 'Wireless Earbuds Pro', marketplace: 'US', status: 'complete', images: 5 },
  { id: 2, name: 'Yoga Mat Premium', marketplace: 'UK', status: 'processing', images: 3 },
  { id: 3, name: 'Kitchen Scale', marketplace: 'DE', status: 'draft', images: 0 },
]

const stats = [
  { label: 'Images Generated', value: '127', icon: Image, change: '+12%' },
  { label: 'Projects', value: '8', icon: TrendingUp, change: '+3' },
  { label: 'Credits Used', value: '45', icon: Zap, change: 'This month' },
  { label: 'Avg. Time Saved', value: '4.2h', icon: Clock, change: 'Per project' },
]

function Dashboard() {
  return (
    <div className="dashboard">
      <header className="dashboard-header">
        <div>
          <h1>Welcome Back!</h1>
          <p>Create stunning Amazon listings with AI-powered tools</p>
        </div>
        <div className="quick-actions">
          <Link to="/tools/main-image-generator" className="btn btn-primary">
            <Zap size={18} />
            Quick Generate
          </Link>
        </div>
      </header>

      {/* Stats Grid */}
      <section className="stats-section">
        <div className="stats-grid-4">
          {stats.map((stat) => {
            const Icon = stat.icon
            return (
              <div key={stat.label} className="stat-card">
                <div className="stat-icon">
                  <Icon size={24} />
                </div>
                <div className="stat-info">
                  <span className="stat-value">{stat.value}</span>
                  <span className="stat-label">{stat.label}</span>
                  <span className="stat-change">{stat.change}</span>
                </div>
              </div>
            )
          })}
        </div>
      </section>

      {/* Tools Section */}
      <section className="tools-section">
        <h2>AI Tools</h2>
        <div className="tools-grid">
          {tools.map((tool) => {
            const Icon = tool.icon
            return (
              <Link
                key={tool.name}
                to={tool.href}
                className="tool-card"
                style={{ '--tool-color': tool.color }}
              >
                <div className="tool-icon" style={{ background: tool.color }}>
                  <Icon size={28} color="white" />
                </div>
                <div className="tool-content">
                  <h3>{tool.name}</h3>
                  <p>{tool.description}</p>
                  <div className="tool-features">
                    {tool.features.map((feature) => (
                      <span key={feature} className="feature-tag">
                        {feature}
                      </span>
                    ))}
                  </div>
                </div>
                <ArrowRight size={20} className="tool-arrow" />
              </Link>
            )
          })}
        </div>
      </section>

      {/* Recent Projects */}
      <section className="projects-section">
        <div className="section-header">
          <h2>Recent Projects</h2>
          <Link to="/projects" className="view-all">View All</Link>
        </div>
        <div className="projects-table">
          <table>
            <thead>
              <tr>
                <th>Project Name</th>
                <th>Marketplace</th>
                <th>Status</th>
                <th>Images</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {recentProjects.map((project) => (
                <tr key={project.id}>
                  <td>
                    <div className="project-name">
                      <Star size={16} className="star-icon" />
                      {project.name}
                    </div>
                  </td>
                  <td>
                    <span className="marketplace-badge">
                      {project.marketplace === 'US' && '🇺🇸'}
                      {project.marketplace === 'UK' && '🇬🇧'}
                      {project.marketplace === 'DE' && '🇩🇪'}
                      {project.marketplace}
                    </span>
                  </td>
                  <td>
                    <span className={`status-badge status-${project.status}`}>
                      {project.status}
                    </span>
                  </td>
                  <td>{project.images}</td>
                  <td>
                    <button className="btn btn-sm">Open</button>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </section>
    </div>
  )
}

export default Dashboard

--- END OF FILE ---

--- FILE: src/pages/Login.jsx ---
import { useState } from 'react'
import { useNavigate } from 'react-router-dom'
import { useAuth } from '../hooks/useAuth.jsx'
import { Sparkles, Mail, Lock, User, Loader2, ArrowRight } from 'lucide-react'

function Login() {
  const [mode, setMode] = useState('login') // 'login' | 'register'
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [displayName, setDisplayName] = useState('')
  const [error, setError] = useState('')
  const [loading, setLoading] = useState(false)

  const { login, register } = useAuth()
  const navigate = useNavigate()

  const handleSubmit = async (e) => {
    e.preventDefault()
    setError('')
    setLoading(true)

    try {
      if (mode === 'login') {
        await login(email, password)
      } else {
        if (password.length < 8) {
          setError('Password must be at least 8 characters')
          setLoading(false)
          return
        }
        await register(email, password, displayName)
      }
      navigate('/')
    } catch (err) {
      setError(err.message)
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="login-page">
      <div className="login-container">
        <div className="login-header">
          <Sparkles size={32} className="login-logo" />
          <h1>Amazon Image Generator</h1>
          <p>AI-powered product listing optimization</p>
        </div>

        <div className="login-tabs">
          <button
            className={`login-tab ${mode === 'login' ? 'active' : ''}`}
            onClick={() => { setMode('login'); setError('') }}
          >
            Sign In
          </button>
          <button
            className={`login-tab ${mode === 'register' ? 'active' : ''}`}
            onClick={() => { setMode('register'); setError('') }}
          >
            Create Account
          </button>
        </div>

        <form onSubmit={handleSubmit} className="login-form">
          {mode === 'register' && (
            <div className="form-group">
              <label>
                <User size={16} />
                Display Name
              </label>
              <input
                type="text"
                value={displayName}
                onChange={(e) => setDisplayName(e.target.value)}
                placeholder="Your name"
              />
            </div>
          )}

          <div className="form-group">
            <label>
              <Mail size={16} />
              Email
            </label>
            <input
              type="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              placeholder="you@example.com"
              required
            />
          </div>

          <div className="form-group">
            <label>
              <Lock size={16} />
              Password
            </label>
            <input
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              placeholder={mode === 'register' ? 'Min 8 characters' : 'Your password'}
              required
              minLength={mode === 'register' ? 8 : undefined}
            />
          </div>

          {error && <div className="login-error">{error}</div>}

          <button type="submit" className="login-submit" disabled={loading}>
            {loading ? (
              <>
                <Loader2 size={18} className="spin" />
                {mode === 'login' ? 'Signing in...' : 'Creating account...'}
              </>
            ) : (
              <>
                {mode === 'login' ? 'Sign In' : 'Create Account'}
                <ArrowRight size={18} />
              </>
            )}
          </button>
        </form>
      </div>
    </div>
  )
}

export default Login

--- END OF FILE ---

--- FILE: src/pages/StorefrontDesigner.jsx ---
import { useState, useCallback } from 'react'
import { PRODUCT_CATEGORIES } from '../constants/productCategories'
import {
  Upload,
  Search,
  Image,
  Plus,
  Trash2,
  GripVertical,
  Eye,
  EyeOff,
  ChevronDown,
  ChevronUp,
  Check,
  X,
  Info,
  Loader2,
  Download,
  Save,
  Sparkles,
  Wand2,
  RefreshCw,
  FileText,
  Film,
  Type,
  ShoppingBag,
  Grid3X3,
  Layers,
  Star,
  Tag,
  MousePointer,
  Layout,
  Monitor,
  Smartphone,
  PlusCircle,
  Copy,
  Settings
} from 'lucide-react'

// ─── Widget/Tile Definitions ───
const STORE_WIDGETS = [
  {
    id: 'hero-header',
    name: 'Header / Hero Image',
    description: 'Full-width hero banner at the top of the page',
    dimensions: '3000 x 600 px',
    width: 3000,
    height: 600,
    category: 'header',
    preview: '🖼️',
    maxPerPage: 1,
    note: 'Safe zone: center 70%'
  },
  {
    id: 'brand-logo',
    name: 'Brand Logo',
    description: 'Brand logo displayed in header area',
    dimensions: '400 x 400 px',
    width: 400,
    height: 400,
    category: 'header',
    preview: '🏷️',
    maxPerPage: 1
  },
  {
    id: 'image-full',
    name: 'Image — Full Width',
    description: 'Full-width image banner',
    dimensions: '3000 x 600 px',
    width: 3000,
    height: 600,
    category: 'image',
    preview: '🌅'
  },
  {
    id: 'image-large',
    name: 'Image — Large',
    description: 'Large square image tile',
    dimensions: '1500 x 1500 px',
    width: 1500,
    height: 1500,
    category: 'image',
    preview: '🔲',
    note: '2:2 aspect ratio'
  },
  {
    id: 'image-medium',
    name: 'Image — Medium',
    description: 'Medium rectangular image tile',
    dimensions: '1500 x 750 px',
    width: 1500,
    height: 750,
    category: 'image',
    preview: '▬',
    note: '2:1 aspect ratio'
  },
  {
    id: 'image-small',
    name: 'Image — Small',
    description: 'Small square image tile',
    dimensions: '750 x 750 px',
    width: 750,
    height: 750,
    category: 'image',
    preview: '◻️',
    note: '1:1 aspect ratio'
  },
  {
    id: 'image-text',
    name: 'Image with Text',
    description: 'Image tile with headline and body text overlay',
    dimensions: '1500 x 750 px',
    width: 1500,
    height: 750,
    hasText: true,
    textFields: ['headline', 'body'],
    headlineLimit: 50,
    bodyLimit: 200,
    category: 'image',
    preview: '📰'
  },
  {
    id: 'shoppable-image',
    name: 'Shoppable Image',
    description: 'Image with up to 6 clickable product tags',
    dimensions: '3000 x 1500 px',
    width: 3000,
    height: 1500,
    hasText: false,
    category: 'interactive',
    preview: '🛒',
    isShoppable: true,
    maxTags: 6
  },
  {
    id: 'text-tile',
    name: 'Text',
    description: 'Text-only content block (max 20 lines)',
    dimensions: 'Text only',
    width: 0,
    height: 0,
    hasText: true,
    textOnly: true,
    textFields: ['headline', 'body'],
    headlineLimit: 100,
    bodyLimit: 1000,
    category: 'text',
    preview: '📝'
  },
  {
    id: 'video-tile',
    name: 'Video',
    description: 'Embedded video with cover image',
    dimensions: '1920 x 1080 px',
    width: 1920,
    height: 1080,
    hasText: true,
    textFields: ['headline'],
    headlineLimit: 100,
    category: 'media',
    preview: '🎬',
    isVideo: true,
    note: '<100MB, cover image required'
  },
  {
    id: 'bg-video',
    name: 'Background Video',
    description: 'Auto-playing looping background video (silent)',
    dimensions: '1280 x 640 px min',
    width: 1280,
    height: 640,
    category: 'media',
    preview: '🎥',
    isVideo: true,
    isBgVideo: true,
    maxPerPage: 4,
    note: '2-20 seconds, auto-loop, silent'
  },
  {
    id: 'gallery',
    name: 'Gallery',
    description: 'Image carousel with 3-8 images',
    dimensions: '1500 x 750 px per image',
    width: 1500,
    height: 750,
    imageCount: 8,
    minImages: 3,
    category: 'gallery',
    preview: '🎞️',
    maxPerPage: 1,
    isGallery: true
  },
  {
    id: 'product-grid',
    name: 'Product Grid',
    description: 'Grid of 4+ products with details',
    dimensions: 'Auto layout',
    width: 0,
    height: 0,
    hasText: false,
    category: 'product',
    preview: '🔳',
    isProductGrid: true,
    maxPerPage: 1,
    note: 'Standard or tall layout'
  }
]

const WIDGET_CATEGORIES = [
  { id: 'all', name: 'All' },
  { id: 'header', name: 'Header' },
  { id: 'image', name: 'Images' },
  { id: 'text', name: 'Text' },
  { id: 'media', name: 'Video' },
  { id: 'interactive', name: 'Interactive' },
  { id: 'gallery', name: 'Gallery' },
  { id: 'product', name: 'Products' }
]

const PAGE_TEMPLATES = [
  { id: 'blank', name: 'Blank', description: 'Start from scratch', icon: '📄' },
  { id: 'marquee', name: 'Marquee', description: 'Organized subcategories layout', icon: '🏪' },
  { id: 'product-highlight', name: 'Product Highlight', description: 'Promote bestsellers or new launches', icon: '⭐' },
  { id: 'product-collection', name: 'Product Collection', description: 'Showcase related product groups', icon: '📦' }
]

const STORE_GUIDELINES = [
  { icon: '✓', text: 'Use high-resolution images (min 72 DPI, recommended 300 PPI)' },
  { icon: '✓', text: 'Keep hero image safe zone in center 70% (15% cropped each side)' },
  { icon: '✓', text: 'Use consistent brand colors, fonts, and imagery' },
  { icon: '✓', text: 'Organize pages by category, product type, or use case' },
  { icon: '✓', text: 'Include a clear navigation hierarchy (3 subpages max)' },
  { icon: '✓', text: 'Add meta descriptions for SEO visibility' },
  { icon: '✓', text: 'Use 3-8 images per gallery widget' },
  { icon: '✓', text: 'Keep background videos 2-20 seconds, auto-loop, silent' },
  { icon: '✓', text: 'Use shoppable images to drive product discovery (up to 6 tags)' },
  { icon: '✗', text: 'No embedded text in images (accessibility issue)' },
  { icon: '✗', text: 'No random capitalization or all-caps text' },
  { icon: '✗', text: 'No pricing or time-sensitive promotional claims' },
  { icon: '✗', text: 'No external links or contact information' },
  { icon: '✗', text: 'No competitor references or comparisons' },
  { icon: '✗', text: 'No more than 20 sections per page' },
  { icon: '✗', text: 'Max 4 background videos, 1 gallery, 1 product grid per page' }
]

// Mock Campaign Data
const CREATIVE_CAMPAIGN_DATA = {
  productName: 'Premium Wireless Headphones',
  brandName: 'AudioPro',
  brandStory: 'Founded in 2018 by audio engineers passionate about perfect sound',
  brandMission: 'Making premium audio accessible to everyone',
  targetAudience: 'Tech-savvy professionals aged 25-45',
  keyBenefits: ['Active noise cancellation', '40-hour battery life', 'Premium comfort memory foam', 'Crystal clear audio quality'],
  topProducts: ['Pro X1 Over-Ear', 'Sport Buds Elite', 'Studio Monitor Pro', 'Travel Companion'],
  emotionalTriggers: ['Focus and productivity', 'Premium quality and status', 'Comfort and relaxation'],
  toneOfVoice: 'Professional, confident, premium',
  keywords: ['wireless', 'noise-cancelling', 'premium', 'comfort', 'professional']
}

const generateWidgetPrompt = (widgetType, campaignData = CREATIVE_CAMPAIGN_DATA) => {
  const prompts = {
    'hero-header': `Create a stunning storefront hero banner for ${campaignData.brandName}.
Brand: ${campaignData.brandName} — ${campaignData.brandMission}
Style: Cinematic, premium, brand-defining storefront header
Target: ${campaignData.targetAudience}
Include: Brand essence, flagship product, aspirational lifestyle
Safe zone: Keep key content in center 70% (sides may be cropped)
Tone: ${campaignData.toneOfVoice}
Dimensions: 3000x600 pixels (full-width hero)`,

    'brand-logo': `Create a professional storefront logo for ${campaignData.brandName}.
Style: Clean, recognizable, works on light and dark backgrounds
Format: Square, centered, with adequate padding
Dimensions: 400x400 pixels minimum`,

    'image-full': `Create a full-width storefront banner for ${campaignData.brandName}.
Purpose: Showcase brand lifestyle or product category
Style: Premium, consistent with brand identity
Key message: ${campaignData.keyBenefits[0]}
Target: ${campaignData.targetAudience}
Dimensions: 3000x600 pixels`,

    'image-large': `Create a large square storefront tile for ${campaignData.brandName}.
Purpose: Feature product or brand story element
Style: Premium product photography or lifestyle
Benefit: ${campaignData.keyBenefits[1] || campaignData.keyBenefits[0]}
Dimensions: 1500x1500 pixels (2:2 square)`,

    'image-medium': `Create a medium storefront tile for ${campaignData.brandName}.
Purpose: Highlight product category or feature
Style: Clean, professional, brand-consistent
Benefit: ${campaignData.keyBenefits[2] || campaignData.keyBenefits[0]}
Dimensions: 1500x750 pixels (2:1 landscape)`,

    'image-small': `Create a small square storefront tile for ${campaignData.brandName}.
Purpose: Thumbnail or category icon
Style: Simple, clear, recognizable
Dimensions: 750x750 pixels (1:1 square)`,

    'image-text': `Create an image with text overlay for ${campaignData.brandName} storefront.
Purpose: Communicate key benefit with visual support
Headline area: Top or center
Body text area: Below headline
Key message: ${campaignData.keyBenefits[0]}
Style: Professional, readable text contrast
Dimensions: 1500x750 pixels`,

    'shoppable-image': `Create a shoppable lifestyle image for ${campaignData.brandName}.
Purpose: Show multiple products in context, clickable discovery
Products to feature (up to 6 tags):
${campaignData.topProducts.map((p, i) => `${i + 1}. ${p}`).join('\n')}
Style: Natural lifestyle scene with products clearly visible
Dimensions: 3000x1500 pixels`,

    'text-tile': `Write storefront text content for ${campaignData.brandName}.
Brand: ${campaignData.brandName}
Tone: ${campaignData.toneOfVoice}
Key benefits: ${campaignData.keyBenefits.join(', ')}
Target: ${campaignData.targetAudience}
Max: 20 lines, concise and scannable
No: random caps, all-caps, pricing, or competitor mentions`,

    'video-tile': `Create a video cover image for ${campaignData.brandName} storefront.
Video concept: Product demo / brand story / feature showcase
Style: Cinematic thumbnail that encourages play
Brand: ${campaignData.brandName}
Cover image: 3000x1500 pixels
Video: 1920x1080 recommended, <100MB`,

    'bg-video': `Create a background video concept for ${campaignData.brandName} storefront.
Duration: 2-20 seconds, auto-loop
Style: Ambient, atmospheric, brand-defining
No sound — visual storytelling only
Show: Product in motion, lifestyle context, or brand elements
Dimensions: 1280x640 pixels minimum`,

    'gallery': `Create a gallery of 3-8 images for ${campaignData.brandName} storefront.
Theme: Product showcase / brand story progression
${campaignData.topProducts.map((p, i) => `Image ${i + 1}: ${p}`).join('\n')}
Style: Consistent, premium, swipeable carousel
Dimensions: 1500x750 pixels per image`,

    'product-grid': `Design a product grid layout for ${campaignData.brandName} storefront.
Products: ${campaignData.topProducts.join(', ')}
Layout: Standard or tall grid
Include: Product images, names, ratings, Prime badges
Style: Clean, shoppable, professional`
  }

  return prompts[widgetType] || `Create professional storefront content for ${campaignData.brandName}.
Brand: ${campaignData.brandName}
Target: ${campaignData.targetAudience}
Style: Premium, brand-consistent`
}

function StorefrontDesigner() {
  // Page management
  const [pages, setPages] = useState([
    { id: 'home', name: 'Homepage', template: 'blank', widgets: [], isHome: true }
  ])
  const [activePage, setActivePage] = useState('home')
  const [editingPageName, setEditingPageName] = useState(null)

  // Widget state for active page
  const [widgetData, setWidgetData] = useState({})
  const [expandedWidget, setExpandedWidget] = useState(null)
  const [categoryFilter, setCategoryFilter] = useState('all')
  const [draggedIndex, setDraggedIndex] = useState(null)

  // UI state
  const [productCategory, setProductCategory] = useState('')
  const [previewMode, setPreviewMode] = useState(false)
  const [previewDevice, setPreviewDevice] = useState('desktop') // 'desktop' | 'mobile'
  const [showGuidelines, setShowGuidelines] = useState(false)
  const [showTemplates, setShowTemplates] = useState(false)
  const [isGenerating, setIsGenerating] = useState(false)

  // Current page helper
  const currentPage = pages.find(p => p.id === activePage) || pages[0]
  const currentWidgets = currentPage.widgets || []

  // Limits
  const maxSections = 20
  const maxSubpages = 3
  const canAddWidget = currentWidgets.length < maxSections
  const canAddPage = pages.length < maxSubpages + 1 // +1 for homepage

  // Check per-page widget limits
  const getWidgetCount = (widgetId) => {
    return currentWidgets.filter(w => w.type === widgetId).length
  }

  const canAddWidgetType = (widget) => {
    if (!canAddWidget) return false
    if (widget.maxPerPage && getWidgetCount(widget.id) >= widget.maxPerPage) return false
    return true
  }

  // Filter widgets
  const filteredWidgets = categoryFilter === 'all'
    ? STORE_WIDGETS
    : STORE_WIDGETS.filter(w => w.category === categoryFilter)

  // ─── Page Management ───
  const addPage = (template = 'blank') => {
    if (!canAddPage) return
    const pageId = `page-${Date.now()}`
    const pageNum = pages.length
    setPages(prev => [...prev, {
      id: pageId,
      name: `Page ${pageNum}`,
      template,
      widgets: []
    }])
    setActivePage(pageId)
    setShowTemplates(false)
  }

  const removePage = (pageId) => {
    if (pages.find(p => p.id === pageId)?.isHome) return
    setPages(prev => prev.filter(p => p.id !== pageId))
    // Clean up widget data for removed page
    const removedPage = pages.find(p => p.id === pageId)
    if (removedPage) {
      setWidgetData(prev => {
        const updated = { ...prev }
        removedPage.widgets.forEach(w => delete updated[w.instanceId])
        return updated
      })
    }
    if (activePage === pageId) setActivePage('home')
  }

  const renamePage = (pageId, newName) => {
    setPages(prev => prev.map(p => p.id === pageId ? { ...p, name: newName } : p))
    setEditingPageName(null)
  }

  // ─── Widget Management ───
  const addWidget = (widgetType) => {
    const widgetDef = STORE_WIDGETS.find(w => w.id === widgetType)
    if (!widgetDef || !canAddWidgetType(widgetDef)) return

    const newWidget = {
      instanceId: `${widgetType}-${Date.now()}`,
      type: widgetType,
      ...widgetDef
    }

    setPages(prev => prev.map(p =>
      p.id === activePage
        ? { ...p, widgets: [...p.widgets, newWidget] }
        : p
    ))

    setWidgetData(prev => ({
      ...prev,
      [newWidget.instanceId]: {
        referenceImage: null,
        aiPrompt: generateWidgetPrompt(widgetType),
        images: [],
        headline: '',
        body: '',
        videoFile: null,
        coverImage: null,
        shoppableTags: [],
        productAsins: ['', '', '', '']
      }
    }))
    setExpandedWidget(newWidget.instanceId)
  }

  const removeWidget = (instanceId) => {
    setPages(prev => prev.map(p =>
      p.id === activePage
        ? { ...p, widgets: p.widgets.filter(w => w.instanceId !== instanceId) }
        : p
    ))
    setWidgetData(prev => {
      const updated = { ...prev }
      delete updated[instanceId]
      return updated
    })
    if (expandedWidget === instanceId) setExpandedWidget(null)
  }

  // Drag and drop
  const handleDragStart = (index) => setDraggedIndex(index)
  const handleDragOver = (e, index) => {
    e.preventDefault()
    if (draggedIndex === null || draggedIndex === index) return
    setPages(prev => prev.map(p => {
      if (p.id !== activePage) return p
      const newWidgets = [...p.widgets]
      const dragged = newWidgets[draggedIndex]
      newWidgets.splice(draggedIndex, 1)
      newWidgets.splice(index, 0, dragged)
      return { ...p, widgets: newWidgets }
    }))
    setDraggedIndex(index)
  }
  const handleDragEnd = () => setDraggedIndex(null)

  const moveWidget = (index, direction) => {
    const newIndex = direction === 'up' ? index - 1 : index + 1
    if (newIndex < 0 || newIndex >= currentWidgets.length) return
    setPages(prev => prev.map(p => {
      if (p.id !== activePage) return p
      const newWidgets = [...p.widgets]
      const temp = newWidgets[index]
      newWidgets[index] = newWidgets[newIndex]
      newWidgets[newIndex] = temp
      return { ...p, widgets: newWidgets }
    }))
  }

  // Update widget data
  const updateWidgetData = (instanceId, field, value) => {
    setWidgetData(prev => ({
      ...prev,
      [instanceId]: { ...prev[instanceId], [field]: value }
    }))
  }

  // File uploads
  const handleReferenceImageUpload = useCallback((instanceId, e) => {
    const file = e.target?.files?.[0]
    if (!file || !file.type.startsWith('image/')) return
    if (file.size > 10 * 1024 * 1024) { alert('Max 10MB'); return }
    const reader = new FileReader()
    reader.onload = (e) => {
      setWidgetData(prev => ({
        ...prev,
        [instanceId]: {
          ...prev[instanceId],
          referenceImage: { file, preview: e.target.result, name: file.name }
        }
      }))
    }
    reader.readAsDataURL(file)
  }, [])

  const handleWidgetImageUpload = useCallback((instanceId, imageIndex, e) => {
    const file = e.target?.files?.[0]
    if (!file || !file.type.startsWith('image/')) return
    if (file.size > 5 * 1024 * 1024) { alert('Max 5MB per image'); return }
    const reader = new FileReader()
    reader.onload = (e) => {
      setWidgetData(prev => {
        const currentImages = prev[instanceId]?.images || []
        const newImages = [...currentImages]
        newImages[imageIndex] = { file, preview: e.target.result, name: file.name }
        return { ...prev, [instanceId]: { ...prev[instanceId], images: newImages } }
      })
    }
    reader.readAsDataURL(file)
  }, [])

  // AI generation
  const generateWidgetContent = async (instanceId) => {
    setIsGenerating(true)
    await new Promise(resolve => setTimeout(resolve, 1500))
    const widget = currentWidgets.find(w => w.instanceId === instanceId)
    if (widget?.hasText) {
      updateWidgetData(instanceId, 'headline', `${CREATIVE_CAMPAIGN_DATA.brandName} — ${CREATIVE_CAMPAIGN_DATA.keyBenefits[0]}`)
      updateWidgetData(instanceId, 'body', CREATIVE_CAMPAIGN_DATA.brandStory)
    }
    setIsGenerating(false)
  }

  const regeneratePrompt = (instanceId, widgetType) => {
    updateWidgetData(instanceId, 'aiPrompt', generateWidgetPrompt(widgetType))
  }

  // ─── Render Widget Editor ───
  const renderWidgetEditor = (widget) => {
    const data = widgetData[widget.instanceId] || {}
    const imageCount = widget.isGallery ? (widget.imageCount || 8) : 1

    return (
      <div className="module-editor">
        {/* Reference Image */}
        <div className="reference-image-section">
          <label className="module-label">
            <Image size={16} /> Reference Image
            <span className="label-hint">(Your photo for AI to use)</span>
          </label>
          <div className="reference-image-upload-area">
            {data.referenceImage ? (
              <div className="reference-image-preview">
                <img src={data.referenceImage.preview} alt="Reference" />
                <div className="reference-image-info">
                  <span className="reference-image-name">{data.referenceImage.name}</span>
                  <button className="btn btn-sm btn-ghost" onClick={() => updateWidgetData(widget.instanceId, 'referenceImage', null)}>
                    <X size={14} /> Remove
                  </button>
                </div>
              </div>
            ) : (
              <label className="reference-image-dropzone">
                <input type="file" accept="image/*" onChange={(e) => handleReferenceImageUpload(widget.instanceId, e)} style={{ display: 'none' }} />
                <Upload size={24} />
                <span className="dropzone-title">Upload Reference Image</span>
                <span className="dropzone-hint">JPG, PNG, WebP (Max 10MB)</span>
              </label>
            )}
          </div>
        </div>

        {/* AI Prompt */}
        <div className="ai-prompt-section">
          <div className="ai-prompt-header">
            <label className="module-label">
              <Wand2 size={16} /> AI Generation Prompt
              <span className="label-hint">(Auto-generated from Creative Campaign)</span>
            </label>
            <button className="btn btn-sm btn-ghost" onClick={() => regeneratePrompt(widget.instanceId, widget.id)}>
              <RefreshCw size={14} /> Reset
            </button>
          </div>
          <div className="ai-prompt-textarea-wrapper">
            <textarea
              className="ai-prompt-textarea"
              value={data.aiPrompt || ''}
              onChange={(e) => updateWidgetData(widget.instanceId, 'aiPrompt', e.target.value)}
              placeholder="Enter your AI generation prompt..."
              rows={6}
            />
            <div className="ai-prompt-footer">
              <span className="char-count">{(data.aiPrompt || '').length} characters</span>
              <span className="prompt-tag"><FileText size={12} /> Campaign Data</span>
            </div>
          </div>
          <button
            className="btn btn-primary btn-generate-images"
            disabled={isGenerating || !data.referenceImage}
            onClick={() => generateWidgetContent(widget.instanceId)}
          >
            {isGenerating ? <><Loader2 size={16} className="spin" /> Generating...</> : <><Sparkles size={16} /> Generate with AI</>}
          </button>
          {!data.referenceImage && <p className="ai-prompt-hint">Upload a reference image first to enable AI generation</p>}
        </div>

        {/* Output Images */}
        {!widget.textOnly && !widget.isProductGrid && (
          <div className="module-images">
            <label className="module-label">
              Output Images <span className="dim">({widget.dimensions})</span>
              {widget.isGallery && <span className="label-hint">— Upload 3-8 images for carousel</span>}
              {widget.isShoppable && <span className="label-hint">— Up to 6 product tags</span>}
              {widget.note && <span className="label-hint">— {widget.note}</span>}
            </label>
            <div className={`module-image-grid images-${Math.min(imageCount, 4)}`}>
              {Array.from({ length: imageCount }).map((_, idx) => (
                <div key={idx} className="module-image-slot" style={{ aspectRatio: widget.width && widget.height ? `${widget.width}/${widget.height}` : '16/9' }}>
                  {data.images?.[idx] ? (
                    <div className="module-image-preview">
                      <img src={data.images[idx].preview} alt={`Image ${idx + 1}`} />
                      <button className="remove-image-btn" onClick={() => {
                        const newImages = [...(data.images || [])]
                        newImages[idx] = null
                        updateWidgetData(widget.instanceId, 'images', newImages)
                      }}>
                        <X size={14} />
                      </button>
                    </div>
                  ) : (
                    <label className="module-image-upload">
                      <input type="file" accept="image/*" onChange={(e) => handleWidgetImageUpload(widget.instanceId, idx, e)} style={{ display: 'none' }} />
                      <Upload size={20} />
                      <span>{widget.width ? `${widget.width}x${widget.height}` : 'Upload'}</span>
                    </label>
                  )}
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Video Upload (for video widgets) */}
        {widget.isVideo && (
          <div className="video-upload-section">
            <label className="module-label">
              <Film size={16} />
              {widget.isBgVideo ? 'Background Video' : 'Video File'}
              <span className="label-hint">
                {widget.isBgVideo ? '(2-20s, silent, auto-loop)' : '(<100MB, MP4/MOV/AVI)'}
              </span>
            </label>
            <div className="video-upload-area">
              {data.videoFile ? (
                <div className="video-file-info">
                  <Film size={20} />
                  <span>{data.videoFile.name}</span>
                  <button className="btn btn-sm btn-ghost" onClick={() => updateWidgetData(widget.instanceId, 'videoFile', null)}>
                    <X size={14} /> Remove
                  </button>
                </div>
              ) : (
                <label className="reference-image-dropzone">
                  <input
                    type="file"
                    accept="video/mp4,video/mov,video/avi,video/mpeg"
                    onChange={(e) => {
                      const file = e.target?.files?.[0]
                      if (file) updateWidgetData(widget.instanceId, 'videoFile', { name: file.name, size: file.size })
                    }}
                    style={{ display: 'none' }}
                  />
                  <Film size={24} />
                  <span className="dropzone-title">Upload Video</span>
                  <span className="dropzone-hint">{widget.isBgVideo ? '2-20s, MP4 (silent, auto-loop)' : 'MP4, MOV, AVI (<100MB)'}</span>
                </label>
              )}
            </div>
          </div>
        )}

        {/* Shoppable Tags */}
        {widget.isShoppable && (
          <div className="shoppable-tags-editor">
            <label className="module-label">
              <MousePointer size={16} /> Product Tags (up to 6)
            </label>
            <div className="shoppable-tags-list">
              {Array.from({ length: 6 }).map((_, idx) => (
                <div key={idx} className="shoppable-tag-row">
                  <span className="tag-number">{idx + 1}</span>
                  <input
                    type="text"
                    placeholder={`ASIN ${idx + 1} (e.g., B09XYZ1234)`}
                    value={data.shoppableTags?.[idx]?.asin || ''}
                    onChange={(e) => {
                      const tags = [...(data.shoppableTags || [])]
                      tags[idx] = { ...tags[idx], asin: e.target.value.toUpperCase() }
                      updateWidgetData(widget.instanceId, 'shoppableTags', tags)
                    }}
                    maxLength={10}
                    className="asin-input-field"
                  />
                  <input
                    type="text"
                    placeholder="Product label"
                    value={data.shoppableTags?.[idx]?.label || ''}
                    onChange={(e) => {
                      const tags = [...(data.shoppableTags || [])]
                      tags[idx] = { ...tags[idx], label: e.target.value }
                      updateWidgetData(widget.instanceId, 'shoppableTags', tags)
                    }}
                    maxLength={50}
                  />
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Product Grid ASINs */}
        {widget.isProductGrid && (
          <div className="product-grid-editor">
            <label className="module-label">
              <Grid3X3 size={16} /> Product ASINs (4 or more)
            </label>
            <textarea
              className="product-asin-textarea"
              placeholder="Enter ASINs separated by commas (e.g., B09XYZ1234, B08ABC5678, ...)"
              value={data.productAsins?.join?.(', ') || ''}
              onChange={(e) => {
                const asins = e.target.value.split(',').map(a => a.trim().toUpperCase())
                updateWidgetData(widget.instanceId, 'productAsins', asins)
              }}
              rows={3}
            />
            <div className="product-grid-options">
              <label className="module-label">Layout</label>
              <div className="grid-layout-options">
                <button
                  className={`layout-option ${(data.gridLayout || 'standard') === 'standard' ? 'active' : ''}`}
                  onClick={() => updateWidgetData(widget.instanceId, 'gridLayout', 'standard')}
                >
                  Standard
                </button>
                <button
                  className={`layout-option ${data.gridLayout === 'tall' ? 'active' : ''}`}
                  onClick={() => updateWidgetData(widget.instanceId, 'gridLayout', 'tall')}
                >
                  Tall
                </button>
              </div>
            </div>
          </div>
        )}

        {/* Text Fields */}
        {widget.hasText && (
          <div className="module-text-fields">
            {widget.textFields?.includes('headline') && (
              <div className="module-field">
                <label className="module-label">Headline</label>
                <input
                  type="text"
                  placeholder="Enter headline..."
                  value={data.headline || ''}
                  onChange={(e) => updateWidgetData(widget.instanceId, 'headline', e.target.value)}
                  maxLength={widget.headlineLimit || 100}
                />
                <span className="char-count">{(data.headline || '').length}/{widget.headlineLimit || 100}</span>
              </div>
            )}
            {widget.textFields?.includes('body') && (
              <div className="module-field">
                <label className="module-label">Body Text</label>
                <textarea
                  placeholder="Enter body text..."
                  value={data.body || ''}
                  onChange={(e) => updateWidgetData(widget.instanceId, 'body', e.target.value)}
                  maxLength={widget.bodyLimit || 1000}
                  rows={widget.bodyLimit > 500 ? 6 : 4}
                />
                <span className="char-count">{(data.body || '').length}/{widget.bodyLimit || 1000}</span>
              </div>
            )}
            <button className="btn btn-secondary btn-sm ai-generate-btn" onClick={() => generateWidgetContent(widget.instanceId)} disabled={isGenerating}>
              {isGenerating ? <Loader2 size={16} className="spin" /> : <Sparkles size={16} />}
              AI Generate Content
            </button>
          </div>
        )}
      </div>
    )
  }

  // ─── Render Widget Preview ───
  const renderWidgetPreview = (widget) => {
    const data = widgetData[widget.instanceId] || {}

    if (widget.textOnly) {
      return (
        <div className="sf-preview-text">
          {data.headline && <h3>{data.headline}</h3>}
          <p>{data.body || 'Text content...'}</p>
        </div>
      )
    }

    if (widget.isProductGrid) {
      return (
        <div className="sf-preview-grid">
          <Grid3X3 size={32} />
          <span>Product Grid ({(data.productAsins || []).filter(a => a).length} products)</span>
          <span className="dim">{data.gridLayout || 'standard'} layout</span>
        </div>
      )
    }

    return (
      <div className="sf-preview-image">
        {data.images?.[0] ? (
          <img src={data.images[0].preview} alt="Preview" />
        ) : (
          <div className="preview-placeholder">
            <Image size={24} />
            <span>{widget.dimensions}</span>
          </div>
        )}
        {widget.hasText && (data.headline || data.body) && (
          <div className="sf-preview-overlay">
            {data.headline && <h4>{data.headline}</h4>}
            {data.body && <p>{data.body}</p>}
          </div>
        )}
        {widget.isShoppable && <div className="sf-preview-shoppable-badge"><MousePointer size={14} /> Shoppable</div>}
        {widget.isVideo && <div className="sf-preview-video-badge"><Film size={14} /> {widget.isBgVideo ? 'BG Video' : 'Video'}</div>}
        {widget.isGallery && <div className="sf-preview-gallery-badge">Gallery ({(data.images || []).filter(Boolean).length} images)</div>}
      </div>
    )
  }

  return (
    <div className="aplus-content-page aplus-layout-vertical storefront-page">
      {/* Top Toolbar */}
      <div className="aplus-toolbar">
        <div className="toolbar-row toolbar-main">
          <div className="toolbar-left">
            <h1>Storefront Designer</h1>
            <span className="brand-story-badge">Amazon Store</span>
          </div>
          <div className="toolbar-center">
            <select
              className="category-dropdown"
              value={productCategory}
              onChange={(e) => setProductCategory(e.target.value)}
            >
              <option value="">Product Category</option>
              {PRODUCT_CATEGORIES.map(cat => (
                <option key={cat} value={cat}>{cat}</option>
              ))}
            </select>
            <span className="module-counter-badge">
              {currentWidgets.length}/{maxSections} sections
            </span>
            <span className="module-counter-badge">
              {pages.length}/{maxSubpages + 1} pages
            </span>
          </div>
          <div className="toolbar-right">
            <button className={`btn btn-sm ${previewMode ? 'btn-primary' : 'btn-secondary'}`} onClick={() => setPreviewMode(!previewMode)}>
              {previewMode ? <EyeOff size={16} /> : <Eye size={16} />}
              {previewMode ? 'Edit' : 'Preview'}
            </button>
            {previewMode && (
              <div className="device-toggle">
                <button
                  className={`device-btn ${previewDevice === 'desktop' ? 'active' : ''}`}
                  onClick={() => setPreviewDevice('desktop')}
                  title="Desktop view"
                >
                  <Monitor size={16} />
                </button>
                <button
                  className={`device-btn ${previewDevice === 'mobile' ? 'active' : ''}`}
                  onClick={() => setPreviewDevice('mobile')}
                  title="Mobile view"
                >
                  <Smartphone size={16} />
                </button>
              </div>
            )}
            <button className="btn btn-sm btn-secondary" disabled={currentWidgets.length === 0}>
              <Save size={16} /> Save
            </button>
            <button className="btn btn-sm btn-primary" disabled={currentWidgets.length === 0}>
              <Download size={16} /> Export
            </button>
            <div className="guidelines-dropdown">
              <button className={`btn-icon-circle ${showGuidelines ? 'active' : ''}`} onClick={() => setShowGuidelines(!showGuidelines)} title="Store Guidelines">
                <Info size={18} />
              </button>
              {showGuidelines && (
                <div className="guidelines-popup">
                  <div className="guidelines-popup-header">
                    <h4>Storefront Guidelines</h4>
                    <button className="popup-close" onClick={() => setShowGuidelines(false)}><X size={16} /></button>
                  </div>
                  <div className="guidelines-popup-content">
                    {STORE_GUIDELINES.map((g, idx) => (
                      <div key={idx} className={`guideline-row ${g.icon === '✓' ? 'do' : 'dont'}`}>
                        <span className="guideline-icon">{g.icon}</span>
                        <span>{g.text}</span>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>
          </div>
        </div>

        {/* Page Tabs */}
        <div className="toolbar-row sf-page-tabs-row">
          <div className="sf-page-tabs">
            {pages.map(page => (
              <div key={page.id} className={`sf-page-tab ${activePage === page.id ? 'active' : ''}`}>
                {editingPageName === page.id ? (
                  <input
                    className="sf-page-name-input"
                    value={page.name}
                    onChange={(e) => setPages(prev => prev.map(p => p.id === page.id ? { ...p, name: e.target.value } : p))}
                    onBlur={() => setEditingPageName(null)}
                    onKeyDown={(e) => e.key === 'Enter' && setEditingPageName(null)}
                    autoFocus
                    maxLength={30}
                  />
                ) : (
                  <button className="sf-page-tab-btn" onClick={() => setActivePage(page.id)} onDoubleClick={() => !page.isHome && setEditingPageName(page.id)}>
                    {page.isHome && <Monitor size={14} />}
                    {page.name}
                    <span className="sf-page-widget-count">{page.widgets.length}</span>
                  </button>
                )}
                {!page.isHome && activePage === page.id && (
                  <button className="sf-page-remove" onClick={() => removePage(page.id)} title="Remove page">
                    <X size={14} />
                  </button>
                )}
              </div>
            ))}
            {canAddPage && (
              <div className="sf-add-page-wrapper">
                <button className="sf-add-page-btn" onClick={() => setShowTemplates(!showTemplates)} title="Add subpage">
                  <PlusCircle size={16} /> Add Page
                </button>
                {showTemplates && (
                  <div className="sf-template-dropdown">
                    <div className="sf-template-dropdown-header">
                      <h4>Choose a Template</h4>
                      <button className="popup-close" onClick={() => setShowTemplates(false)}><X size={14} /></button>
                    </div>
                    {PAGE_TEMPLATES.map(tpl => (
                      <button key={tpl.id} className="sf-template-option" onClick={() => addPage(tpl.id)}>
                        <span className="sf-template-icon">{tpl.icon}</span>
                        <div className="sf-template-info">
                          <span className="sf-template-name">{tpl.name}</span>
                          <span className="sf-template-desc">{tpl.description}</span>
                        </div>
                      </button>
                    ))}
                  </div>
                )}
              </div>
            )}
          </div>
        </div>

        {/* Widget Library Row */}
        <div className="toolbar-row toolbar-modules">
          <div className="category-tabs">
            {WIDGET_CATEGORIES.map(cat => (
              <button
                key={cat.id}
                className={`category-tab ${categoryFilter === cat.id ? 'active' : ''}`}
                onClick={() => setCategoryFilter(cat.id)}
              >
                {cat.name}
              </button>
            ))}
          </div>
          <div className="modules-scroll">
            {filteredWidgets.map(widget => {
              const atLimit = widget.maxPerPage && getWidgetCount(widget.id) >= widget.maxPerPage
              return (
                <button
                  key={widget.id}
                  className={`module-chip ${!canAddWidget || atLimit ? 'disabled' : ''}`}
                  onClick={() => canAddWidgetType(widget) && addWidget(widget.id)}
                  disabled={!canAddWidget || atLimit}
                  title={`${widget.name} (${widget.dimensions})${atLimit ? ' — Limit reached' : ''}${widget.note ? ` — ${widget.note}` : ''}`}
                >
                  <span className="chip-icon">{widget.preview}</span>
                  <span className="chip-name">{widget.name}</span>
                  <span className="chip-size">{widget.dimensions}</span>
                  {atLimit ? <span className="chip-limit">MAX</span> : <Plus size={14} className="chip-add" />}
                </button>
              )
            })}
          </div>
        </div>
      </div>

      {/* Content Area */}
      <div className="aplus-content-area">
        {currentWidgets.length === 0 ? (
          <div className="builder-empty-full">
            <Layout size={56} />
            <h3>Design Your Storefront</h3>
            <p>Click widgets above to add sections to "{currentPage.name}"</p>
            <span className="hint">Max 20 sections per page • Use the page tabs to add subpages</span>
          </div>
        ) : previewMode ? (
          <div className={`preview-container-full sf-preview-container sf-device-${previewDevice}`}>
            <div className="sf-preview-frame">
              <div className="sf-preview-header-bar">
                {previewDevice === 'mobile' ? <Smartphone size={16} /> : <Monitor size={16} />}
                <span>{currentPage.name}</span>
                {pages.length > 1 && (
                  <div className="sf-preview-nav">
                    {pages.map(p => (
                      <span key={p.id} className={`sf-preview-nav-link ${p.id === activePage ? 'active' : ''}`}>{p.name}</span>
                    ))}
                  </div>
                )}
              </div>
              {currentWidgets.map(widget => (
                <div key={widget.instanceId} className={`sf-preview-section section-${widget.type}`}>
                  {renderWidgetPreview(widget)}
                </div>
              ))}
            </div>
          </div>
        ) : (
          <div className="modules-container-full">
            {currentWidgets.map((widget, index) => (
              <div
                key={widget.instanceId}
                className={`module-item-full ${draggedIndex === index ? 'dragging' : ''} ${expandedWidget === widget.instanceId ? 'expanded' : ''}`}
                draggable
                onDragStart={() => handleDragStart(index)}
                onDragOver={(e) => handleDragOver(e, index)}
                onDragEnd={handleDragEnd}
              >
                <div className="module-header-full">
                  <div className="module-drag-handle"><GripVertical size={18} /></div>
                  <span className="module-number">{index + 1}</span>
                  <span className="module-icon-lg">{widget.preview}</span>
                  <div className="module-title-info">
                    <span className="module-name-lg">{widget.name}</span>
                    <span className="module-dims">{widget.dimensions}{widget.note ? ` — ${widget.note}` : ''}</span>
                  </div>
                  <div className="module-actions-full">
                    <button className="btn-icon-sm" onClick={() => moveWidget(index, 'up')} disabled={index === 0}><ChevronUp size={18} /></button>
                    <button className="btn-icon-sm" onClick={() => moveWidget(index, 'down')} disabled={index === currentWidgets.length - 1}><ChevronDown size={18} /></button>
                    <button className="btn-icon-sm expand-btn" onClick={() => setExpandedWidget(expandedWidget === widget.instanceId ? null : widget.instanceId)}>
                      {expandedWidget === widget.instanceId ? <ChevronUp size={18} /> : <ChevronDown size={18} />}
                    </button>
                    <button className="btn-icon-sm delete-btn" onClick={() => removeWidget(widget.instanceId)}><Trash2 size={18} /></button>
                  </div>
                </div>
                {expandedWidget === widget.instanceId && (
                  <div className="module-content-full">
                    {renderWidgetEditor(widget)}
                  </div>
                )}
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  )
}

export default StorefrontDesigner

--- END OF FILE ---

--- FILE: src/pages/SecondaryImageGenerator.jsx ---
import { useState, useCallback } from 'react'
import {
  Upload,
  FileText,
  Image,
  Download,
  RefreshCw,
  Save,
  Check,
  X,
  Loader2,
  Sparkles,
  LayoutGrid,
  Users,
  BarChart3,
  Zap,
  Target,
  Heart,
  Shield,
  Award,
  TrendingUp,
  ChevronDown,
  ChevronRight,
  Copy,
  Edit3
} from 'lucide-react'
import { generateImage } from '../api/imageGen'
import { PRODUCT_CATEGORIES } from '../constants/productCategories'

// Secondary Image Types
const SECONDARY_IMAGE_TYPES = [
  {
    id: 'benefits',
    name: 'Benefits Infographic',
    icon: Heart,
    description: 'Highlight key product benefits',
    category: 'infographic',
    color: '#22C55E'
  },
  {
    id: 'features',
    name: 'Features Infographic',
    icon: Zap,
    description: 'Showcase product features',
    category: 'infographic',
    color: '#3B82F6'
  },
  {
    id: 'comparison',
    name: 'Comparison Infographic',
    icon: BarChart3,
    description: 'Compare with competitors or before/after',
    category: 'infographic',
    color: '#F59E0B'
  },
  {
    id: 'lifestyle',
    name: 'Lifestyle Image',
    icon: Users,
    description: 'Product in real-life context',
    category: 'lifestyle',
    color: '#EC4899'
  },
  {
    id: 'quality',
    name: 'Quality & Trust',
    icon: Shield,
    description: 'Certifications, materials, guarantees',
    category: 'infographic',
    color: '#8B5CF6'
  },
  {
    id: 'howto',
    name: 'How To Use',
    icon: Target,
    description: 'Step-by-step usage guide',
    category: 'infographic',
    color: '#06B6D4'
  }
]

// Aspect ratios for secondary images
const ASPECT_RATIOS = [
  { id: '1:1', name: 'Square', width: 2000, height: 2000, recommended: true },
  { id: '4:3', name: 'Portrait', width: 2000, height: 1500 },
  { id: '3:2', name: 'Rectangle', width: 2000, height: 1333 }
]

// Mock campaign summary data (would come from Creative Campaigns)
const MOCK_CAMPAIGN_SUMMARY = {
  productName: 'Premium Stainless Steel Water Bottle',
  category: 'Sports & Outdoors',
  asin: 'B08N5WRWNW',
  benefits: [
    'Keeps drinks cold for 24 hours',
    'Double-wall vacuum insulation',
    'BPA-free and eco-friendly',
    'Leak-proof lid design',
    'Fits standard cup holders'
  ],
  features: [
    '32oz capacity',
    'Food-grade stainless steel',
    'Wide mouth opening',
    'Powder-coated finish',
    'Built-in carrying loop'
  ],
  painPoints: [
    'Competitors have short insulation time',
    'Other bottles leak easily',
    'Plastic bottles harm environment'
  ],
  targetAudience: {
    primary: 'Busy professionals aged 28-42',
    lifestyle: 'Health-conscious, active, eco-aware',
    useCase: 'Gym, office, outdoor activities'
  },
  competitorWeaknesses: [
    'Poor insulation',
    'Flimsy construction',
    'No warranty'
  ],
  uniqueSellingPoints: [
    '24-hour cold retention (vs 6-hour competitors)',
    'Lifetime warranty',
    'Premium materials'
  ]
}

function SecondaryImageGenerator() {
  // Campaign data state
  const [campaignData, setCampaignData] = useState(MOCK_CAMPAIGN_SUMMARY)
  const [hasCampaignData, setHasCampaignData] = useState(true)

  // Configuration state
  const [productCategory, setProductCategory] = useState('')
  const [selectedType, setSelectedType] = useState('')
  const [aspectRatio, setAspectRatio] = useState('1:1')
  const [quantity, setQuantity] = useState(1)

  // Prompts for each image type (user can edit these)
  const [typePrompts, setTypePrompts] = useState({})

  // Generation state
  const [isGenerating, setIsGenerating] = useState(false)
  const [progress, setProgress] = useState(null)
  const [generatedImages, setGeneratedImages] = useState([])
  const [selectedImages, setSelectedImages] = useState([])
  const [error, setError] = useState(null)

  // Generate default prompt for a given type based on campaign data
  const getDefaultPrompt = (typeId) => {
    switch (typeId) {
      case 'benefits':
        return `Amazon product infographic for "${campaignData.productName}", benefits showcase layout, clean white background, professional design highlighting: ${campaignData.benefits.slice(0, 3).join(', ')}. Include icons and benefit callouts, modern minimalist style, easy to read text hierarchy, product image integrated, high quality commercial design`
      case 'features':
        return `Amazon product features infographic for "${campaignData.productName}", technical features layout showing: ${campaignData.features.slice(0, 4).join(', ')}. Clean diagram style with labeled arrows pointing to features, white background, professional product photography style, specifications highlighted, modern design`
      case 'comparison':
        return `Amazon comparison infographic for "${campaignData.productName}", side-by-side comparison layout, "Our Product vs Others" style, highlighting advantages: ${campaignData.uniqueSellingPoints.slice(0, 3).join(', ')}. Professional design with checkmarks and X marks, clean white background, trust-building visual hierarchy`
      case 'lifestyle':
        return `Lifestyle product photography for Amazon listing, "${campaignData.productName}" being used by ${campaignData.targetAudience.primary}, ${campaignData.targetAudience.useCase} setting, natural lighting, aspirational scene showing ${campaignData.targetAudience.lifestyle} lifestyle, high quality commercial photography, product clearly visible and in use`
      case 'quality':
        return `Amazon trust and quality infographic for "${campaignData.productName}", showcasing premium materials and certifications, quality badges, warranty information, "Why Choose Us" style layout, professional design with trust symbols, clean white background, premium feel`
      case 'howto':
        return `Amazon how-to-use infographic for "${campaignData.productName}", step-by-step usage guide with numbered steps, clean instructional layout, icons and simple illustrations, easy to follow visual guide, white background, professional design`
      default:
        return `Amazon product secondary image for "${campaignData.productName}", professional commercial photography, high quality`
    }
  }

  // Handle image type selection change
  const handleTypeChange = (typeId) => {
    setSelectedType(typeId)
    // Auto-generate prompt if not already set
    if (typeId && !typePrompts[typeId]) {
      setTypePrompts(prev => ({
        ...prev,
        [typeId]: getDefaultPrompt(typeId)
      }))
    }
  }

  // Update prompt for a specific type
  const updateTypePrompt = (typeId, newPrompt) => {
    setTypePrompts(prev => ({
      ...prev,
      [typeId]: newPrompt
    }))
  }

  // Reset prompt to auto-generated default
  const resetToDefault = (typeId) => {
    setTypePrompts(prev => ({
      ...prev,
      [typeId]: getDefaultPrompt(typeId)
    }))
  }

  // Copy prompt to clipboard
  const copyPrompt = (prompt) => {
    navigator.clipboard.writeText(prompt)
  }

  // Toggle image selection
  const toggleImageSelection = (imageId) => {
    setSelectedImages(prev =>
      prev.includes(imageId)
        ? prev.filter(id => id !== imageId)
        : [...prev, imageId]
    )
  }

  // Download image
  const downloadImage = async (img) => {
    try {
      const response = await fetch(img.url)
      const blob = await response.blob()
      const url = URL.createObjectURL(blob)
      const a = document.createElement('a')
      a.href = url
      a.download = `${img.typeName.replace(/\s+/g, '-').toLowerCase()}-${img.id}.png`
      document.body.appendChild(a)
      a.click()
      document.body.removeChild(a)
      URL.revokeObjectURL(url)
    } catch (err) {
      console.error('Download failed:', err)
    }
  }

  // Download selected images
  const downloadSelected = async () => {
    const imagesToDownload = generatedImages.filter(img => selectedImages.includes(img.id))
    for (const img of imagesToDownload) {
      await downloadImage(img)
      await new Promise(resolve => setTimeout(resolve, 500))
    }
  }

  // Generate images from prompts
  const handleGenerate = async () => {
    if (!selectedType || !typePrompts[selectedType]) {
      setError('Please select an image type and ensure prompt is ready')
      return
    }

    setIsGenerating(true)
    setError(null)
    setGeneratedImages([])
    setSelectedImages([])

    const imageType = SECONDARY_IMAGE_TYPES.find(t => t.id === selectedType)

    try {
      const results = []
      const totalImages = quantity

      for (let i = 0; i < totalImages; i++) {
        setProgress({
          current: i + 1,
          total: totalImages,
          percentage: Math.round(((i + 1) / totalImages) * 100),
          message: `Generating ${imageType.name} ${i + 1}/${totalImages}...`
        })

        const selectedRatio = ASPECT_RATIOS.find(r => r.id === aspectRatio)
        const result = await generateImage(typePrompts[selectedType], {
          width: selectedRatio?.width || 2000,
          height: selectedRatio?.height || 2000,
          aspectRatio: aspectRatio
        }, (p) => {
          setProgress(prev => ({ ...prev, ...p }))
        })

        const newImage = {
          id: Date.now() + i,
          url: result.url,
          typeName: imageType.name,
          typeId: selectedType,
          typeColor: imageType.color,
          prompt: typePrompts[selectedType],
          variation: i + 1,
          provider: result.provider,
          aspectRatio,
          timestamp: new Date().toISOString()
        }

        results.push(newImage)
        setGeneratedImages([...results])
      }

      setGeneratedImages(results)
    } catch (err) {
      setError(err.message || 'Failed to generate images')
    } finally {
      setIsGenerating(false)
      setProgress(null)
    }
  }

  const canGenerateImages = selectedType && typePrompts[selectedType] && !isGenerating

  return (
    <div className="secondary-image-generator">
      <header className="page-header">
        <div>
          <h1>Secondary Image Generator</h1>
          <p>Generate infographics and lifestyle images from your campaign data</p>
        </div>
      </header>

      <div className="generator-layout secondary-layout">
        {/* Left Panel - Configuration */}
        <div className="generator-sidebar">
          {/* Campaign Summary */}
          <div className="config-section campaign-summary">
            <h3>
              <FileText size={18} />
              Campaign Summary
            </h3>
            {hasCampaignData ? (
              <div className="summary-content">
                <div className="summary-item">
                  <label>Product</label>
                  <span>{campaignData.productName}</span>
                </div>
                <div className="summary-item">
                  <label>Category</label>
                  <span>{campaignData.category}</span>
                </div>
                <div className="summary-item">
                  <label>Target</label>
                  <span>{campaignData.targetAudience.primary}</span>
                </div>
                <div className="summary-item">
                  <label>Benefits</label>
                  <span>{campaignData.benefits.length} identified</span>
                </div>
                <div className="summary-item">
                  <label>Features</label>
                  <span>{campaignData.features.length} identified</span>
                </div>
              </div>
            ) : (
              <div className="no-campaign">
                <p>No campaign data loaded</p>
                <button className="btn btn-secondary btn-sm">
                  Load from Creative Campaign
                </button>
              </div>
            )}
          </div>

          {/* Product Category */}
          <div className="config-section">
            <h3>Product Category</h3>
            <div className="config-group">
              <select
                className="category-dropdown"
                value={productCategory}
                onChange={(e) => setProductCategory(e.target.value)}
              >
                <option value="">-- Select Category --</option>
                {PRODUCT_CATEGORIES.map((cat) => (
                  <option key={cat} value={cat}>{cat}</option>
                ))}
              </select>
            </div>
          </div>

          {/* Image Type Selection */}
          <div className="config-section">
            <h3>
              <LayoutGrid size={18} />
              Select Image Type
            </h3>
            <div className="config-group">
              <label>Image Type</label>
              <select
                className="config-select"
                value={selectedType}
                onChange={(e) => handleTypeChange(e.target.value)}
              >
                <option value="">-- Select an image type --</option>
                {SECONDARY_IMAGE_TYPES.map(type => (
                  <option key={type.id} value={type.id}>
                    {type.name}
                  </option>
                ))}
              </select>
            </div>
          </div>

          {/* Quantity & Aspect Ratio */}
          <div className="config-section">
            <h3>Configuration</h3>

            <div className="config-group">
              <label>
                <span>Quantity</span>
                <span className="config-value">{quantity}</span>
              </label>
              <input
                type="range"
                min="1"
                max="10"
                value={quantity}
                onChange={(e) => setQuantity(Number(e.target.value))}
              />
            </div>

            <div className="config-group">
              <label>Aspect Ratio</label>
              <select
                className="config-select"
                value={aspectRatio}
                onChange={(e) => setAspectRatio(e.target.value)}
              >
                {ASPECT_RATIOS.map(ratio => (
                  <option key={ratio.id} value={ratio.id}>
                    {ratio.id} {ratio.name} {ratio.recommended ? '(Recommended)' : ''}
                  </option>
                ))}
              </select>
            </div>

            {selectedType && (
              <div className="total-images">
                Total: <strong>{quantity}</strong> image{quantity > 1 ? 's' : ''} to generate
              </div>
            )}
          </div>

          {/* Generate Button */}
          <button
            className="btn btn-primary btn-large"
            onClick={handleGenerate}
            disabled={!canGenerateImages}
          >
            {isGenerating ? (
              <>
                <Loader2 size={18} className="spin" />
                Generating {progress?.current}/{progress?.total}...
              </>
            ) : (
              <>
                <Image size={18} />
                Generate {quantity} Image{quantity > 1 ? 's' : ''}
              </>
            )}
          </button>
        </div>

        {/* Center Panel - Prompt Editor */}
        <div className="prompts-section">
          <div className="prompts-header">
            <h3>
              <Edit3 size={18} />
              Prompt Editor
            </h3>
          </div>

          {!selectedType ? (
            <div className="prompts-empty">
              <Sparkles size={48} />
              <p>Select an image type to see the auto-generated prompt</p>
              <span>You can edit the prompt before generating</span>
            </div>
          ) : (
            <div className="prompt-editor-container">
              {(() => {
                const imageType = SECONDARY_IMAGE_TYPES.find(t => t.id === selectedType)
                return (
                  <div className="prompt-card active-prompt">
                    <div className="prompt-header">
                      <span
                        className="prompt-type-badge"
                        style={{ backgroundColor: imageType?.color }}
                      >
                        {imageType?.name}
                      </span>
                      <div className="prompt-actions">
                        <button
                          className="action-btn"
                          onClick={() => copyPrompt(typePrompts[selectedType] || '')}
                          title="Copy prompt"
                        >
                          <Copy size={14} />
                        </button>
                        <button
                          className="action-btn"
                          onClick={() => resetToDefault(selectedType)}
                          title="Reset to auto-generated prompt"
                        >
                          <RefreshCw size={14} />
                        </button>
                      </div>
                    </div>

                    <div className="prompt-edit-area">
                      <label className="prompt-label">
                        Auto-generated prompt from campaign data (editable):
                      </label>
                      <textarea
                        className="prompt-textarea"
                        value={typePrompts[selectedType] || ''}
                        onChange={(e) => updateTypePrompt(selectedType, e.target.value)}
                        rows={8}
                        placeholder="Enter your custom prompt or let it auto-generate from campaign data..."
                      />
                      <div className="prompt-char-count">
                        {(typePrompts[selectedType] || '').length} characters
                      </div>
                    </div>
                  </div>
                )
              })()}

              {error && <div className="error-message">{error}</div>}
            </div>
          )}

          {/* Progress Bar */}
          {isGenerating && progress && (
            <div className="generation-progress">
              <div className="progress-bar">
                <div
                  className="progress-fill"
                  style={{ width: `${progress.percentage || 0}%` }}
                />
              </div>
              <div className="progress-info">
                <span className="progress-text">{progress.message}</span>
                <span className="progress-count">{progress.current} / {progress.total}</span>
              </div>
            </div>
          )}
        </div>

        {/* Right Panel - Results */}
        <div className="results-section">
          <div className="results-header">
            <h3>
              Generated Images
              {generatedImages.length > 0 && (
                <span className="results-count">({generatedImages.length})</span>
              )}
            </h3>
            {generatedImages.length > 0 && (
              <div className="results-actions">
                <button
                  className="btn btn-sm btn-ghost"
                  onClick={() => {
                    if (selectedImages.length === generatedImages.length) {
                      setSelectedImages([])
                    } else {
                      setSelectedImages(generatedImages.map(img => img.id))
                    }
                  }}
                >
                  <Check size={16} />
                  {selectedImages.length === generatedImages.length ? 'Deselect All' : 'Select All'}
                </button>
                <button
                  className="btn btn-primary btn-sm"
                  onClick={downloadSelected}
                  disabled={selectedImages.length === 0}
                >
                  <Download size={16} />
                  Download ({selectedImages.length})
                </button>
              </div>
            )}
          </div>

          {/* Progress Bar */}
          {isGenerating && progress && (
            <div className="generation-progress">
              <div className="progress-bar">
                <div
                  className="progress-fill"
                  style={{ width: `${progress.percentage || 0}%` }}
                />
              </div>
              <div className="progress-info">
                <span className="progress-text">{progress.message}</span>
                <span className="progress-count">{progress.current} / {progress.total}</span>
              </div>
            </div>
          )}

          {generatedImages.length === 0 && !isGenerating ? (
            <div className="results-empty">
              <Image size={48} />
              <p>Your generated images will appear here</p>
              <span>Generate prompts first, then click Generate Images</span>
            </div>
          ) : (
            <div className="results-grid">
              {generatedImages.map((img) => (
                <div
                  key={img.id}
                  className={`result-card ${selectedImages.includes(img.id) ? 'selected' : ''}`}
                  onClick={() => toggleImageSelection(img.id)}
                >
                  <div className="result-checkbox">
                    <input
                      type="checkbox"
                      checked={selectedImages.includes(img.id)}
                      onChange={() => toggleImageSelection(img.id)}
                      onClick={(e) => e.stopPropagation()}
                    />
                  </div>
                  <img src={img.url} alt={img.typeName} />
                  <div className="result-info">
                    <span
                      className="result-type-badge"
                      style={{ backgroundColor: img.typeColor }}
                    >
                      {img.typeName}
                    </span>
                    <span className="result-model">{img.provider}</span>
                  </div>
                  <div className="result-actions">
                    <button
                      className="action-btn"
                      title="Download"
                      onClick={(e) => { e.stopPropagation(); downloadImage(img) }}
                    >
                      <Download size={16} />
                    </button>
                    <button className="action-btn" title="Regenerate" onClick={(e) => e.stopPropagation()}>
                      <RefreshCw size={16} />
                    </button>
                    <button className="action-btn" title="Save" onClick={(e) => e.stopPropagation()}>
                      <Save size={16} />
                    </button>
                  </div>
                </div>
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  )
}

export default SecondaryImageGenerator

--- END OF FILE ---

--- FILE: src/services/database.js ---
/**
 * IndexedDB Database Service
 * Provides persistent storage for sessions, images, projects, and style presets
 */

const DB_NAME = 'amazon-listing-generator'
const DB_VERSION = 2 // Upgraded for style presets

let db = null

export async function initDatabase() {
  return new Promise((resolve, reject) => {
    const request = indexedDB.open(DB_NAME, DB_VERSION)

    request.onerror = () => reject(request.error)
    request.onsuccess = () => {
      db = request.result
      resolve(db)
    }

    request.onupgradeneeded = (event) => {
      const database = event.target.result

      // Sessions store - tracks work sessions
      if (!database.objectStoreNames.contains('sessions')) {
        const sessionsStore = database.createObjectStore('sessions', { keyPath: 'id' })
        sessionsStore.createIndex('startTime', 'startTime', { unique: false })
        sessionsStore.createIndex('projectId', 'projectId', { unique: false })
        sessionsStore.createIndex('status', 'status', { unique: false })
      }

      // Images store - generated images
      if (!database.objectStoreNames.contains('images')) {
        const imagesStore = database.createObjectStore('images', { keyPath: 'id' })
        imagesStore.createIndex('timestamp', 'timestamp', { unique: false })
        imagesStore.createIndex('sessionId', 'sessionId', { unique: false })
        imagesStore.createIndex('imageType', 'imageType', { unique: false })
        imagesStore.createIndex('isFavorite', 'isFavorite', { unique: false })
      }

      // Projects store - group images by product/project
      if (!database.objectStoreNames.contains('projects')) {
        const projectsStore = database.createObjectStore('projects', { keyPath: 'id' })
        projectsStore.createIndex('name', 'name', { unique: false })
        projectsStore.createIndex('createdAt', 'createdAt', { unique: false })
      }

      // Calendar events store - synced calendar entries
      if (!database.objectStoreNames.contains('calendarEvents')) {
        const eventsStore = database.createObjectStore('calendarEvents', { keyPath: 'id' })
        eventsStore.createIndex('sessionId', 'sessionId', { unique: false })
        eventsStore.createIndex('googleEventId', 'googleEventId', { unique: false })
      }

      // Style presets store - saved reference image combinations (v2)
      if (!database.objectStoreNames.contains('stylePresets')) {
        const presetsStore = database.createObjectStore('stylePresets', { keyPath: 'id' })
        presetsStore.createIndex('name', 'name', { unique: false })
        presetsStore.createIndex('createdAt', 'createdAt', { unique: false })
        presetsStore.createIndex('projectId', 'projectId', { unique: false })
      }
    }
  })
}

function getStore(storeName, mode = 'readonly') {
  const transaction = db.transaction(storeName, mode)
  return transaction.objectStore(storeName)
}

// Generic CRUD operations
export async function add(storeName, data) {
  return new Promise((resolve, reject) => {
    const store = getStore(storeName, 'readwrite')
    const request = store.add(data)
    request.onsuccess = () => resolve(request.result)
    request.onerror = () => reject(request.error)
  })
}

export async function put(storeName, data) {
  return new Promise((resolve, reject) => {
    const store = getStore(storeName, 'readwrite')
    const request = store.put(data)
    request.onsuccess = () => resolve(request.result)
    request.onerror = () => reject(request.error)
  })
}

export async function get(storeName, id) {
  return new Promise((resolve, reject) => {
    const store = getStore(storeName)
    const request = store.get(id)
    request.onsuccess = () => resolve(request.result)
    request.onerror = () => reject(request.error)
  })
}

export async function getAll(storeName) {
  return new Promise((resolve, reject) => {
    const store = getStore(storeName)
    const request = store.getAll()
    request.onsuccess = () => resolve(request.result)
    request.onerror = () => reject(request.error)
  })
}

export async function remove(storeName, id) {
  return new Promise((resolve, reject) => {
    const store = getStore(storeName, 'readwrite')
    const request = store.delete(id)
    request.onsuccess = () => resolve()
    request.onerror = () => reject(request.error)
  })
}

export async function getByIndex(storeName, indexName, value) {
  return new Promise((resolve, reject) => {
    const store = getStore(storeName)
    const index = store.index(indexName)
    const request = index.getAll(value)
    request.onsuccess = () => resolve(request.result)
    request.onerror = () => reject(request.error)
  })
}

export async function clear(storeName) {
  return new Promise((resolve, reject) => {
    const store = getStore(storeName, 'readwrite')
    const request = store.clear()
    request.onsuccess = () => resolve()
    request.onerror = () => reject(request.error)
  })
}

// Session-specific helpers
export async function getAllSessions() {
  return getAll('sessions')
}

export async function getActiveSession() {
  const sessions = await getByIndex('sessions', 'status', 'active')
  return sessions[0] || null
}

export async function saveSession(session) {
  return put('sessions', session)
}

// Image-specific helpers
export async function getAllImages() {
  return getAll('images')
}

export async function getFavoriteImages() {
  return getByIndex('images', 'isFavorite', true)
}

export async function saveImage(image) {
  return put('images', image)
}

export async function getSessionImages(sessionId) {
  return getByIndex('images', 'sessionId', sessionId)
}

// Project helpers
export async function getAllProjects() {
  return getAll('projects')
}

export async function saveProject(project) {
  return put('projects', project)
}

// Style preset helpers
export async function getAllPresets() {
  return getAll('stylePresets')
}

export async function savePreset(preset) {
  return put('stylePresets', preset)
}

export async function deletePreset(presetId) {
  return remove('stylePresets', presetId)
}

export async function getPresetsByProject(projectId) {
  return getByIndex('stylePresets', 'projectId', projectId)
}

export { db }

--- END OF FILE ---

--- FILE: src/services/sessionTracker.js ---
/**
 * Session Tracking Service
 * Tracks work sessions, time spent, and generation counts
 */

import { saveSession, getActiveSession, getAllSessions, getSessionImages } from './database'

export function createSession(projectId = null, projectName = null) {
  return {
    id: `session-${Date.now()}`,
    projectId,
    projectName,
    status: 'active',
    startTime: new Date().toISOString(),
    endTime: null,
    duration: 0, // in seconds
    generationCount: 0,
    imageTypes: {},
    notes: '',
    calendarEventId: null,
    createdAt: new Date().toISOString()
  }
}

export async function startSession(projectId = null, projectName = null) {
  // Check for existing active session
  const existing = await getActiveSession()
  if (existing) {
    return existing
  }

  const session = createSession(projectId, projectName)
  await saveSession(session)
  return session
}

export async function endSession(sessionId) {
  const sessions = await getAllSessions()
  const session = sessions.find(s => s.id === sessionId)

  if (!session) return null

  const endTime = new Date()
  const startTime = new Date(session.startTime)
  const duration = Math.round((endTime - startTime) / 1000)

  const updatedSession = {
    ...session,
    status: 'completed',
    endTime: endTime.toISOString(),
    duration
  }

  await saveSession(updatedSession)
  return updatedSession
}

export async function updateSessionStats(sessionId, imageType) {
  const sessions = await getAllSessions()
  const session = sessions.find(s => s.id === sessionId)

  if (!session) return null

  const imageTypes = { ...session.imageTypes }
  imageTypes[imageType] = (imageTypes[imageType] || 0) + 1

  const updatedSession = {
    ...session,
    generationCount: session.generationCount + 1,
    imageTypes
  }

  await saveSession(updatedSession)
  return updatedSession
}

export async function addSessionNote(sessionId, note) {
  const sessions = await getAllSessions()
  const session = sessions.find(s => s.id === sessionId)

  if (!session) return null

  const updatedSession = {
    ...session,
    notes: session.notes ? `${session.notes}\n${note}` : note
  }

  await saveSession(updatedSession)
  return updatedSession
}

export async function getSessionSummary(sessionId) {
  const sessions = await getAllSessions()
  const session = sessions.find(s => s.id === sessionId)

  if (!session) return null

  const images = await getSessionImages(sessionId)

  return {
    ...session,
    images,
    imageCount: images.length,
    favoriteCount: images.filter(img => img.isFavorite).length,
    formattedDuration: formatDuration(session.duration)
  }
}

export async function getSessionStats(days = 30) {
  const sessions = await getAllSessions()
  const cutoff = new Date()
  cutoff.setDate(cutoff.getDate() - days)

  const recentSessions = sessions.filter(s =>
    new Date(s.startTime) >= cutoff && s.status === 'completed'
  )

  const totalTime = recentSessions.reduce((sum, s) => sum + s.duration, 0)
  const totalGenerations = recentSessions.reduce((sum, s) => sum + s.generationCount, 0)

  const imageTypeStats = {}
  recentSessions.forEach(s => {
    Object.entries(s.imageTypes || {}).forEach(([type, count]) => {
      imageTypeStats[type] = (imageTypeStats[type] || 0) + count
    })
  })

  return {
    sessionCount: recentSessions.length,
    totalTime,
    totalGenerations,
    averageSessionTime: recentSessions.length > 0 ? Math.round(totalTime / recentSessions.length) : 0,
    imageTypeStats,
    formattedTotalTime: formatDuration(totalTime)
  }
}

export function formatDuration(seconds) {
  if (!seconds) return '0m'

  const hours = Math.floor(seconds / 3600)
  const minutes = Math.floor((seconds % 3600) / 60)

  if (hours > 0) {
    return `${hours}h ${minutes}m`
  }
  return `${minutes}m`
}

export function calculateLiveDuration(startTime) {
  const start = new Date(startTime)
  const now = new Date()
  return Math.round((now - start) / 1000)
}

--- END OF FILE ---

--- FILE: src/services/calendar.js ---
/**
 * Calendar Integration Service
 * Integrates with Google Calendar API (compatible with Clockwise)
 *
 * Clockwise uses Google Calendar under the hood, so we integrate directly
 * with Google Calendar API for maximum compatibility.
 *
 * Features:
 * - Create focus time blocks when starting sessions
 * - Track time spent on image generation
 * - Sync session data to calendar events
 */

const GOOGLE_CLIENT_ID = import.meta.env.VITE_GOOGLE_CLIENT_ID
const GOOGLE_API_KEY = import.meta.env.VITE_GOOGLE_API_KEY
const SCOPES = 'https://www.googleapis.com/auth/calendar.events'

let gapiLoaded = false
let gisLoaded = false
let tokenClient = null

// Load the Google API scripts
export async function loadGoogleAPIs() {
  if (typeof window === 'undefined') return false

  // Load GAPI
  if (!window.gapi) {
    await new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = 'https://apis.google.com/js/api.js'
      script.onload = resolve
      script.onerror = reject
      document.body.appendChild(script)
    })
  }

  // Load GIS (Google Identity Services)
  if (!window.google?.accounts) {
    await new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = 'https://accounts.google.com/gsi/client'
      script.onload = resolve
      script.onerror = reject
      document.body.appendChild(script)
    })
  }

  return true
}

export async function initGoogleCalendar() {
  if (!GOOGLE_CLIENT_ID || !GOOGLE_API_KEY) {
    console.warn('Google Calendar API credentials not configured')
    return false
  }

  try {
    await loadGoogleAPIs()

    // Initialize GAPI client
    await new Promise((resolve) => {
      window.gapi.load('client', resolve)
    })

    await window.gapi.client.init({
      apiKey: GOOGLE_API_KEY,
      discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest']
    })
    gapiLoaded = true

    // Initialize token client
    tokenClient = window.google.accounts.oauth2.initTokenClient({
      client_id: GOOGLE_CLIENT_ID,
      scope: SCOPES,
      callback: '' // Set later
    })
    gisLoaded = true

    return true
  } catch (error) {
    console.error('Failed to initialize Google Calendar:', error)
    return false
  }
}

export async function signIn() {
  if (!gisLoaded) {
    throw new Error('Google Identity Services not loaded')
  }

  return new Promise((resolve, reject) => {
    tokenClient.callback = (response) => {
      if (response.error) {
        reject(response.error)
      } else {
        resolve(response)
      }
    }
    tokenClient.requestAccessToken({ prompt: 'consent' })
  })
}

export function signOut() {
  const token = window.gapi.client.getToken()
  if (token) {
    window.google.accounts.oauth2.revoke(token.access_token)
    window.gapi.client.setToken(null)
  }
}

export function isSignedIn() {
  return window.gapi?.client?.getToken() !== null
}

/**
 * Create a focus time event for an image generation session
 */
export async function createFocusTimeEvent(session, options = {}) {
  if (!gapiLoaded || !isSignedIn()) {
    throw new Error('Not authenticated with Google Calendar')
  }

  const {
    title = `Image Generation: ${session.projectName || 'Amazon Listings'}`,
    description = 'Focus time for Amazon listing image generation',
    colorId = '9', // Blue - good for focus time
    duration = 60 // Default 60 minutes
  } = options

  const startTime = new Date(session.startTime)
  const endTime = new Date(startTime.getTime() + duration * 60000)

  const event = {
    summary: title,
    description: `${description}\n\nSession ID: ${session.id}\nProject: ${session.projectName || 'N/A'}`,
    start: {
      dateTime: startTime.toISOString(),
      timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone
    },
    end: {
      dateTime: endTime.toISOString(),
      timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone
    },
    colorId,
    // Mark as focus time for Clockwise compatibility
    extendedProperties: {
      private: {
        focusTime: 'true',
        sessionId: session.id,
        appName: 'amazon-listing-generator'
      }
    }
  }

  try {
    const response = await window.gapi.client.calendar.events.insert({
      calendarId: 'primary',
      resource: event
    })
    return response.result
  } catch (error) {
    console.error('Failed to create calendar event:', error)
    throw error
  }
}

/**
 * Update the event when session ends with actual duration
 */
export async function updateSessionEvent(eventId, session) {
  if (!gapiLoaded || !isSignedIn()) {
    throw new Error('Not authenticated with Google Calendar')
  }

  const startTime = new Date(session.startTime)
  const endTime = session.endTime ? new Date(session.endTime) : new Date()

  const description = `Amazon Listing Image Generation Session

Duration: ${formatDurationForCalendar(session.duration)}
Images Generated: ${session.generationCount}
Image Types: ${Object.entries(session.imageTypes || {}).map(([type, count]) => `${type}: ${count}`).join(', ') || 'N/A'}

Session ID: ${session.id}
Project: ${session.projectName || 'N/A'}`

  try {
    const response = await window.gapi.client.calendar.events.patch({
      calendarId: 'primary',
      eventId,
      resource: {
        end: {
          dateTime: endTime.toISOString(),
          timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone
        },
        description,
        colorId: '10' // Green for completed
      }
    })
    return response.result
  } catch (error) {
    console.error('Failed to update calendar event:', error)
    throw error
  }
}

/**
 * Delete a calendar event
 */
export async function deleteCalendarEvent(eventId) {
  if (!gapiLoaded || !isSignedIn()) {
    throw new Error('Not authenticated with Google Calendar')
  }

  try {
    await window.gapi.client.calendar.events.delete({
      calendarId: 'primary',
      eventId
    })
    return true
  } catch (error) {
    console.error('Failed to delete calendar event:', error)
    throw error
  }
}

/**
 * Get all session events from the calendar
 */
export async function getSessionEvents(days = 30) {
  if (!gapiLoaded || !isSignedIn()) {
    throw new Error('Not authenticated with Google Calendar')
  }

  const now = new Date()
  const past = new Date()
  past.setDate(past.getDate() - days)

  try {
    const response = await window.gapi.client.calendar.events.list({
      calendarId: 'primary',
      timeMin: past.toISOString(),
      timeMax: now.toISOString(),
      privateExtendedProperty: 'appName=amazon-listing-generator',
      singleEvents: true,
      orderBy: 'startTime'
    })
    return response.result.items || []
  } catch (error) {
    console.error('Failed to fetch calendar events:', error)
    throw error
  }
}

function formatDurationForCalendar(seconds) {
  if (!seconds) return '0 minutes'
  const hours = Math.floor(seconds / 3600)
  const minutes = Math.floor((seconds % 3600) / 60)
  if (hours > 0) {
    return `${hours} hour${hours > 1 ? 's' : ''} ${minutes} minute${minutes !== 1 ? 's' : ''}`
  }
  return `${minutes} minute${minutes !== 1 ? 's' : ''}`
}

// Check if calendar is configured
export function isCalendarConfigured() {
  return !!(GOOGLE_CLIENT_ID && GOOGLE_API_KEY)
}

--- END OF FILE ---
